var NPGridTRClass="TR-NPGrid",NPGridStopSort=0;function n(){var e=new Date;return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+"."+e.getMilliseconds()}ko.extenders.GrdModeSwitch=function(e,t){return e.subscribe((function(e){t.grid.SetMode(e.toString())})),e},$.widget("ui.resizable2",$.ui.resizable,{_destroy:function(){this._super()}}),function(e){ko.bindingHandlers.npresizable={init:function(t,i,o,r,n){e("th",t).resizable2({handles:"w",start:function(e,t){NPGridStopSort=1},resize:function(e,t){var i=t.element.attr("npIndex");i&&"1"==t.element.attr("colspan")&&n.$root.Cols()[i].Width(t.size.width),t.element.css({left:"auto",width:"auto"})},stop:function(t,i){i.element.css({left:"auto",width:"auto"});var o=e(e(this).closest(".np-grid-header")).next();o[0].scrollWidth-4<=o[0].clientWidth?o.css("overflow-x","hidden"):o.css("overflow-x","auto"),np.noNg((()=>setTimeout((function(){NPGridStopSort=0}),0)))}})}},ko.bindingHandlers.npdraggable={init:function(t,i,o,r,n){var a,l,d,s=null,p=n.$root.ColSeqs();e("th",t).draggable({cursor:"crosshair",start:function(t,i){var o=parseInt(e(this).attr("npIndex")),r=parseInt(e(this).attr("colspan"));s=o,a=o+r-1},stop:function(t,i){s=null,a=null,e(this).css({left:"auto",top:"auto"})}}),e("th",t).droppable({accept:function(){return null!==s},hoverClass:"ui-state-active",drop:function(t,i){var o=parseInt(e(this).attr("npIndex")),r=parseInt(e(this).attr("colspan"));l=o,d=o+r-1;var c=p[s],v=p[l],g=p[a],h=p[d];if(v>c){for(var u=0;u<p.length;u++)p[u]>g&&p[u]<=h&&(p[u]-=g-c+1);for(u=s;u<=a;u++)p[u]+=h-g}else{for(u=0;u<p.length;u++)p[u]>=v&&p[u]<c&&(p[u]+=g-c+1);for(u=s;u<=a;u++)p[u]-=c-v}var m=[];for(u=0;u<p.length;u++)m[u]=p[u];n.$root.ColSeqs(m)}})}},ko.bindingHandlers.NpRepGrid={init:function(t,i,o,r,n){var a=o().NpGridWidth,l=o().XMLColGrid,d=o().ColAttr,s=ko.unwrap(i()),p=o().NpGridInstance,c=o().NpForPrint;try{a=parseFloat(a)}catch(t){w=e(window).width()/2}var v=e('<n ColPrefix="C"  >'),g={Printable:c,ColPrefix:"C",npform:self,DefaultNoRadif:!0,RowNodeName:"row",ColFirstNo:1,InXML:s,width:a,Radif:d.Radif,ColAttr:d,RadifWidth:d.RadifWidth,ShowRadifTitle:d.ShowRadifTitle,HiddenAllColsFirst:d.HiddenAllColsFirst,height:300,FullScreenable:"1",Responsive:0,HideFooter:!0,GridInReport:1,ActiveRowClass:null,NoRowColor1:1,NoRowColor2:1,NoRowColor3:1,OddRowClass:null,EvenRowClass:null,NewDesign:1};v.append(l),g.ColAttr=g.ColAttr||{},d=g.ColAttr;var h=[];e("col",v).each((function(t,i){var o=t+1,r=e(i);h[t]={Data:r.attr("Dat"),Hide:r.attr("Hide"),Name:r.attr("Nam")},r.attr("COLTYPE")&&(d["COLTYPE"+o]=d["COLTYPE"+o]||r.attr("COLTYPE")),r.attr("SHOWTAG")&&(d["SHOWTAG"+o]=d["SHOWTAG"+o]||r.attr("SHOWTAG")),r.attr("DIR")&&(d["DIR"+o]=d["DIR"+o]||r.attr("DIR")),r.attr("ALIGN")&&(d["ALIGN"+o]=d["ALIGN"+o]||r.attr("ALIGN")),r.attr("MULTILINE")&&(d["MULTILINE"+o]=d["MULTILINE"+o]||r.attr("MULTILINE")),r.attr("SHOWLABEL")&&(d["SHOWLABEL"+o]=d["SHOWLABEL"+o]||r.attr("SHOWLABEL"))})),h&&(g.Cols=h),e(t).npgrid(g),ko.isObservable(p)&&p(e(t).npgrid("instance"))},update:function(e,t){}},ko.bindingHandlers.jqButton={init:function(t,i){e(t).addClass("btn btn-outline-secondary").css({"padding-top":"0px","padding-bottom":"0px","margin-bottom":"2px",height:"18px"})},update:function(t,i){i().enable?e(t).attr("disabled",!1):e(t).attr("disabled",!0)}},e.widget("np.npgrid",{options:{width:"auto",height:"auto",GridCover:null,RowHeight:null,RowMaxHeight:null,InXML:"<Root />",ColPrefix:"F",ColFirstNo:0,LinePerPage:20,Cols:[],_Cols:[],RId:null,RIdCol:null,RowNodeName:"N",ParVM:null,GridCursor:"",MinHeight:150,Radif:null,RadifWidth:30,ShowRadifTitle:!0,OddRowClass:"np-grid-odd",EvenRowClass:"np-grid-even",RowList:[10,20,30,40,50,100],ActiveRowClass:"npgrid-active-row",ActNo:null,ColAttr:{},ColDraggable:!1,Paging:!0,NoPaging:void 0,MaxRowId:null,NoRowColor1:!1,NoRowColor2:!1,NoRowColor3:!1,NoTdPadding:!1,NoShowHeader:!1,Printable:!1,MaximizeIcon:1,MinimizeIcon:0,npform:null,FullScreenable:0,NewDesign:0,Responsive:0,MaxRow:null,HideHeader:null,HideFooter:null,HideGrid:null,UpDat:null,Modes:null,ColHeight:null,GetRowDataInternal:null,GetRowData:null,AftSwitch:null,AftFilRowInternal:null,AftFilRow:null,InitOnRowClick:null,OnRowClick:null,InitAfterRowClick:null,AfterRowClick:null,OnGridTextBlur:null,AfterGridTextBlur:null,AfterGridDrawCompleted:null,ByDropDown:!0,FilterComboChangeVal:null,StopSort:0},NewRowData:null,widget:function(){return this.$Container},Container:function(){return this.$Container},_MakeGrid:function(){var t=this,i=t.options,o=t.element;if(o.hide(),o.before(t.$Container),"1"!=i.Responsive||i.Responsivable||(i.NoShowHeader=1,i.NoRowColor2=1),(i.Responsive||i.Responsivable)&&(t.ToolTip=e("<div style='position:absolute;background-color:#e3e7ee;display:none;z-index:10001;line-height:25px;border-radius:10px;padding:10px' />").appendTo(t.$Container)),!i.NoShowHeader){var r={width:"100%",overflow:"hidden",border:"0px"};i.GridInReport&&(r.position="sticky",r.top="0"),t.$Headerview=e('<div class="np-grid-header" data-bind="visible:!Responsive()" />').css(r).appendTo(t.$Container),t.UpDat=e('<div data-bind="UniHtml:UpDat(),NoCheckHtml:1" />').appendTo(t.$Headerview),"1"==i.NewDesign?t.$Header=e("<div style=\"max-width:calc(100% - CalcScrollWidth()+'px')\" />"):t.$Header=e("<div data-bind=\"style:{'width':GridWidth()-CalcScrollWidth()+'px'}\" />"),t.$Header.css({height:"100%",overflow:"hidden"}).appendTo(t.$Headerview),t.ScrollDiv=e("<div />").css({float:"right",height:"10px"}).attr("data-bind","style:{'width':CalcScrollWidth()+'px'}"),t.$Header.append(e("<div></div>")).css("float","right"),e("div",t.$Header).attr("data-bind","style:{'width':(CalcWidth()+1)+'px'}")}i.HideGrid&&t.$Header.hide(),i.HideHeader&&(t.$Container.css("height","auto"),t.$Header.parent().hide()),i.NoShowHeader&&!i.Printable||e('<table class="npgrid-table-header ui-state-default" data-bind="style:{\'width\':CalcWidth()+\'px\'}"  cellspacing="0" cellpadding="0" ><colgroup data-bind="template:{name:TColsNPGridScript}"></colgroup><tbody data-bind="template:{name:THeadNPGridScript, foreach:TrOfTHead()}"></tbody></table>').appendTo(i.Printable?t.$Container:e("div",t.$Header)),i.Printable?e("<table/>").attr("data-bind","style:{'width':CalcWidth()+'px'}").attr("cellspacing",0).attr("cellpadding",0).addClass("npgrid-table-body").append(e('<colgroup data-bind="template:{name:TColsNPGridScript}" ></colgroup>')).append("<tbody data-bind=\"template:{name:'TBodyNPGrid',foreach: CurrTrOfTBody(), afterRender: AfterRender, afterMove:AfterMove }\" ></tbody>").appendTo(i.Printable?t.$Container:e("div",t.$GridBody)):(t.$GridBody=e('<div class="npgrid-body"/>').css({"overflow-y":"auto","overflow-x":i.NewDesign&&i.GridInReport?"hidden":"auto","min-height":"100px"}),i.HideGrid&&t.$GridBody.hide(),t.$GridBody.append(e("<div data-bind=\"template:{name:TFullNPGridScript},style:{'width':Responsive()?null:(CalcWidth()+'px')}\" />")),t.$TBody=e("div",t.$GridBody),t.$GridBody.appendTo(t.$Container)),t.$Footerview=e('<div data-bind="visibility:!Responsive()||Paging()"/>').css({width:"100%",overflow:"hidden"}).appendTo(t.$Container),(i.HideGrid||i.HideFooter)&&t.$Footerview.hide();var n=e('<div aria-label="..." class="footerBox" data-bin_d="visible:Paging()" style="display:flex"><div  role="group" style="padding-left:2px;display:inline;vertical-align:middle"></div><div  role="group" style="padding-left:2px;display:inline;vertical-align:middle"></div><div  role="group" style="flex-shrink: 0;padding-left:2px;display:inline;vertical-align:middle"></div><div  role="group" style="padding-left:2px;display:inline;vertical-align:middle"></div><div  role="group" style="padding-left:2px;display:inline;vertical-align:middle"></div><div  role="group" style="padding-left:2px;display:inline;vertical-align:middle"></div><div  role="group" style="flex-shrink: 0;padding-left:2px;display:inline;vertical-align:middle"></div></div>');t.$Footer=e("<div />").css({width:"100%","overflow-x":"auto","overflow-y":"hidden"}).addClass("np-grid-header").appendTo(t.$Footerview).append(n),i.FullScreenable&&(e("<button></button>").attr("data-bind",'visible:MaximizeIcon(),jqButton:{enable: MaximizeIcon(),op:{icons:{primary:"ui-icon-seek-first"},text:false}},click:FullScreenClickFunc').append('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="svg-dark" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 32 32" style="vertical-align: middle;padding-bottom: 3px;"><path d="M5.365 0.234h9.388q0.555 0 0.948 0.393t0.393 0.948-0.393 0.948-0.948 0.393h-9.388q-0.555 0-0.948 0.393t-0.393 0.948v21.459q0 0.555 0.393 0.948t0.948 0.393h21.459q0.555 0 0.948-0.393t0.393-0.948v-9.388q0-0.555 0.393-0.948t0.948-0.393 0.948 0.393 0.393 0.948v9.388q0 1.666-1.179 2.845t-2.845 1.179h-21.459q-1.666 0-2.845-1.179t-1.179-2.845v-21.459q0-1.666 1.179-2.845t2.845-1.179zM21.459 0.234h8.047q0.555 0 0.948 0.393t0.393 0.948v8.047q0 0.555-0.393 0.948t-0.948 0.393-0.948-0.393-0.393-0.948v-4.809l-11.128 11.128q-0.388 0.388-0.943 0.388-0.576 0-0.959-0.382t-0.382-0.959q0-0.555 0.388-0.943l11.128-11.128h-4.809q-0.555 0-0.948-0.393t-0.393-0.948 0.393-0.948 0.948-0.393z"></path></svg>').appendTo(e("div:eq(0)",n)),e("<button></button>").attr("data-bind",'visible:MinimizeIcon(),jqButton:{enable: MinimizeIcon(),op:{icons:{primary:"ui-icon-seek-first"},text:false}},click:CloseFullScreenClickFunc').append('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="svg-dark" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 32 32" style="vertical-align: middle;padding-bottom: 3px;"><path d="M5.375-0.579c-1.113 0-2.063 0.394-2.85 1.181s-1.181 1.737-1.181 2.85v21.501c0 1.113 0.394 2.063 1.181 2.85s1.738 1.181 2.85 1.181h21.501c1.113-0 2.063-0.394 2.85-1.181s1.181-1.737 1.181-2.85v-9.407c0-0.371-0.131-0.688-0.394-0.95s-0.579-0.394-0.95-0.394c-0.371-0-0.688 0.131-0.95 0.394s-0.394 0.579-0.394 0.95v9.407c0 0.371-0.131 0.688-0.394 0.95s-0.579 0.394-0.95 0.394h-21.501c-0.371 0-0.688-0.131-0.95-0.394s-0.394-0.579-0.394-0.95v-21.501c-0-0.371 0.131-0.688 0.394-0.95s0.579-0.394 0.95-0.394h9.407c0.209 0 0.4-0.042 0.574-0.125 0.022-0.113 0.047-0.226 0.075-0.34 0.639-2.081-0.002-0.026 0.002 0.099 0.002 0.066 0.004 0.131 0.006 0.197 0.094-0.054 0.182-0.12 0.265-0.199 0.014-0.023 0.027-0.047 0.041-0.071 0.118-0.237 0.235-0.457 0.368-0.716 0.008-0.061 0.012-0.124 0.012-0.189 0-0.371-0.131-0.688-0.394-0.95s-0.579-0.394-0.95-0.394l-9.407-0zM23.623 16.379c0.371-0.006 0.686-0.143 0.943-0.409s0.384-0.586 0.378-0.957c-0.006-0.371-0.143-0.685-0.409-0.943s-0.586-0.384-0.957-0.378l-4.818 0.081 10.962-11.334c0.255-0.263 0.379-0.58 0.373-0.951-0.006-0.385-0.14-0.703-0.399-0.954s-0.582-0.374-0.967-0.367c-0.371 0.006-0.684 0.141-0.938 0.404l-10.962 11.334-0.081-4.818c-0.006-0.371-0.143-0.686-0.409-0.943s-0.586-0.384-0.957-0.378c-0.371 0.006-0.685 0.143-0.944 0.409s-0.384 0.586-0.378 0.957l0.135 8.062c0.006 0.371 0.143 0.685 0.409 0.943s0.586 0.384 0.957 0.378l8.062-0.135z"></path></svg>').appendTo(e("div:eq(0)",n))),t.$Toolbar[0]=e("<button></button>").attr("data-bind",'visible:Paging,jqButton:{enable: currpage() > 1,op:{icons:{primary:"ui-icon-seek-end"},text:false}},click:gofirst').append('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="svg-dark" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 32 32" style="vertical-align: middle;padding-bottom: 3px;"><path d="M2.551 15.145v-10.649l0.175 0.093c0.096 0.051 3.981 2.114 8.633 4.583l8.458 4.49 0.007-9.065h2.779v0.661l-0.044-0.037c-0.024-0.020-0.050-0.037-0.057-0.037s-0.013 1.933-0.013 4.948v4.948l0.12 0.061-0.12 0.071v10.496h-2.664v-4.54c0-2.497-0.002-4.54-0.005-4.54-0.004 0-16.837 8.934-17.165 9.11l-0.104 0.056v-10.649zM11.254 18.345c3.312-1.758 6.017-3.201 6.011-3.207-0.017-0.015-12.009-6.38-12.031-6.385-0.016-0.004-0.019 1.104-0.019 6.392 0 3.518 0.004 6.396 0.009 6.396s2.719-1.439 6.030-3.197z"></path></svg>').appendTo(e("div:eq(0)",n)),t.$Toolbar[1]=e("<button></button>").attr("data-bind",'visible:Paging,jqButton:{enable: currpage() > 1,op:{icons:{primary:"ui-icon-seek-next"},text:false}},click:goprev').append('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="svg-dark" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 32 32" style="vertical-align: middle;padding-bottom: 3px;"><path d="M2.552 15.146v-10.651l0.118 0.064c0.065 0.035 4.572 2.428 10.015 5.317s9.902 5.257 9.908 5.263c0.006 0.005-4.48 2.394-9.968 5.307s-10 5.309-10.026 5.324l-0.046 0.028v-10.651zM11.254 18.344c3.312-1.758 6.016-3.201 6.010-3.206-0.017-0.015-12.008-6.379-12.030-6.385-0.016-0.004-0.019 1.103-0.019 6.391 0 3.518 0.004 6.396 0.009 6.396s2.718-1.438 6.030-3.196z"></path></svg>').appendTo(e("div:eq(1)",n)),e('<span   data-bind="visible:Paging" style="width:30px;height:17px;text-align:right;margin-left:3px;margin-right:3px"/>').text("صفحه").appendTo(e("div:eq(2)",n)),e('<input data-bind="visible:Paging,value:currpage" style="min-height: 20px;width:25px;height:19px;text-align:center;margin-left:3px;margin-right:3px;padding:0px" class="form-control">').css("paddig","0px").appendTo(e("div:eq(2)",n)),e('<span  data-bind="visible:Paging" style="width:9px;height:17px;text-align:left;margin-left:3px;margin-right:3px"/>').text("از").appendTo(e("div:eq(2)",n)),e("tr>td:eq(2)",n).wrapInner(e("<span/>")),e('<span autofocus  data-bind="visible:Paging,UniText:pagecount()" style="width:10px;height:17px;text-align:center;margin-left:3px;margin-right:3px"/>').appendTo(e("div:eq(2)",n)),t.$Toolbar[2]=e("<button></button>").attr("data-bind",'visible:Paging,jqButton:{enable: currpage() < pagecount(),op:{icons:{primary:"ui-icon-seek-prev"},text:false}},click:gonext').append('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="svg-dark" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 32 32" style="vertical-align: middle;padding-bottom: 3px;"><path d="M23.167 15.146v-10.651l-0.118 0.064c-0.065 0.035-4.572 2.428-10.015 5.317s-9.902 5.257-9.908 5.263c-0.006 0.005 4.48 2.394 9.968 5.307s10 5.309 10.026 5.324l0.046 0.028v-10.651zM14.465 18.344c-3.312-1.758-6.016-3.201-6.010-3.206 0.017-0.015 12.008-6.379 12.030-6.385 0.015-0.004 0.019 1.103 0.019 6.391 0 3.518-0.004 6.396-0.009 6.396s-2.718-1.438-6.030-3.196z"></path></svg>').appendTo(e("div:eq(3)",n)),t.$Toolbar[3]=e("<button></button>").attr("data-bind",'visible:Paging,jqButton:{enable: currpage() < pagecount(),op:{icons:{primary:"ui-icon-seek-first"},text:false}},click:golast').append('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="svg-dark" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 32 32" style="vertical-align: middle;padding-bottom: 3px;"><path d="M23.168 15.145v-10.649l-0.175 0.093c-0.096 0.051-3.981 2.114-8.633 4.583l-8.458 4.49-0.007-9.065h-2.779v0.661l0.044-0.037c0.024-0.020 0.050-0.037 0.057-0.037s0.013 1.933 0.013 4.948v4.948l-0.12 0.061 0.12 0.071v10.496h2.664v-4.54c0-2.497 0.002-4.54 0.005-4.54 0.004 0 16.837 8.934 17.165 9.11l0.104 0.056v-10.649zM14.465 18.345c-3.312-1.758-6.017-3.201-6.011-3.207 0.017-0.015 12.009-6.38 12.031-6.385 0.015-0.004 0.019 1.104 0.019 6.392 0 3.518-0.004 6.396-0.009 6.396s-2.718-1.439-6.030-3.197z"></path></svg>').appendTo(e("div:eq(4)",n)),e('<select class="form-control" style="min-height: 20px;padding-top:0px;padding-bottom:0px;height:18px;width:inherit"  data-bind="visible:Paging,options:RowList(), selectedOptions:RowListSelected">').appendTo(e("div:eq(5)",n)),e('<span  data-bind="UniText:printtedad()"  style="width:200px;height:17px;text-align:center;margin-left:3px;margin-right:3px"/>').wrap(e("<span/>")).parent().appendTo(e("div:eq(6)",n)),t.FooterPaging=e('<span  data-bind="UniText:printtedad(),visible:false&&!Paging()"  style="width:200px;height:17px;text-align:center;margin-left:3px;margin-right:3px"/>'),n.before(t.FooterPaging),e('<input  data-bind="visible:ShowMaxRow(),value:MaxRow" style="width:40px;height:19px;text-align:center;padding:0px" class="form-control">').css("paddig","0px").appendTo(e("div:eq(6)",n)),e("<button></button>").css("margin-right","5px").attr("data-bind",'visible:ShowMaxRow(),jqButton:{enable: true,op:{icons:{primary:"ui-icon-refresh"},text:false}},click:RefreshMaxRow').append('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="svg-dark" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 32 32" style="vertical-align: middle;padding-bottom: 3px;"><path d="M1.341 16.328h8.047q0.555 0 0.948 0.393t0.393 0.948-0.393 0.948-0.948 0.393h-4.526l3.646 3.562q1.551 1.561 3.552 2.358 1.918 0.786 4.034 0.786t4.034-0.786q1.048-0.43 1.965-1.053t1.561-1.278 1.174-1.404 0.849-1.378 0.54-1.257q0.189-0.524 0.692-0.76t1.016-0.058q0.524 0.189 0.76 0.686t0.058 1.011q-0.44 1.341-1.278 2.661t-1.886 2.368q-1.928 1.928-4.432 2.944-2.431 0.985-5.050 0.985-2.609 0-5.050-0.985-2.504-1.016-4.432-2.944l-3.929-3.845v5.092q0 0.555-0.393 0.948t-0.948 0.393-0.948-0.393-0.393-0.948v-8.047q0-0.555 0.393-0.948t0.948-0.393zM16.094 1.575q2.609 0 5.050 0.985 2.504 1.016 4.432 2.944l0.021 0.021 3.908 3.824v-5.092q0-0.555 0.393-0.948t0.948-0.393 0.948 0.393 0.393 0.948v8.047q0 0.555-0.393 0.948t-0.948 0.393h-8.047q-0.555 0-0.948-0.393t-0.393-0.948 0.393-0.948 0.948-0.393h4.526l-3.646-3.562q-1.53-1.53-3.484-2.337t-4.102-0.807q-2.117 0-4.034 0.786-2.001 0.796-3.552 2.358-0.629 0.555-1.378 1.692t-1.158 2.321q-0.189 0.524-0.692 0.76t-1.016 0.058q-0.524-0.189-0.76-0.686t-0.058-1.011q0.44-1.341 1.278-2.661t1.886-2.368q1.928-1.928 4.432-2.944 2.441-0.985 5.050-0.985z"></path></svg>').appendTo(e("div:eq(6)",n)),n=null,t._on(t.$Container,{"mouseenter td.npgrid-body-cell":function(t){if(!i.GridInReport){var o=e(t.currentTarget);if(o.attr("title")||o.attr("lastnptitle","*"),"*"==o.attr("lastnptitle"))if(o[0].offsetWidth>o[0].scrollWidth)o.removeAttr("title").removeAttr("data-original-title");else{var r=o.html().replace(/<br>|<tr>/g,"\n");r=e("<span>"+r+"</span>"),o[0].align&&"left"==o[0].align.toLowerCase()?o.attr("data-html","true").attr("data-toggle","tooltip").attr("data-original-title","<div style='text-align:left'>"+e(r).text()+"</div>").removeAttr("title"):o.attr("data-toggle","tooltip").attr("data-original-title",e(r).text()).removeAttr("title")}}},click:function(i){0==e(i.target).closest("div[isdivtoggle]").length&&e("div[isdivtoggle]",t.$Footerview).hide()}}),i.NoShowHeader||t.$GridBody.scroll((function(o){i.Responsive||t.$Header.scrollLeft(e(o.target).scrollLeft())})),e(t.$Footerview).on("click","div[TogglePages=1]",(function(){var t=e(this).parent(),i=e("div[IsDivToggle='1']",t),o=e(this).position().left-i.width(),r=e(this).position().top-i.height()-10+(e(this).closest(".ui-dialog").length>0?e(this).closest(".ui-dialog").scrollTop():0)+"px";return o=(o<0?e(this).position().left:o)+"px",e("div[IsDivToggle='1']",t).css({left:o,top:r}).toggle(),!1}))},ReCalcDim:function(t,i,o){var r=this;if(!r||!r._vm||!r._vm.CalcWidth)return;var n=r.options,a=r.$Container,l=n.GridCover;let d=!1;if(n?.npform?.W_?.$dvfrmCenter?.hasClass("np-d-none")&&(n?.npform?.W_?.$dvfrmCenter?.removeClass("np-d-none"),d=!0),l=l||e(window),r.$Container.is(":np-npUiDialog")&&r.$Container.npUiDialog("isOpen"))d&&n?.npform?.W_?.$dvfrmCenter?.addClass("np-d-none");else{if(t||(t=n.width),"auto"==t){var s=a.outerWidth(!0)-a.width(),p=l.width();0==p&&(p=l[0].clientWidth),(t=p-r._ScrollWidth-r._Right)>r._vm.CalcWidth()+s&&(t=r._vm.CalcWidth()+s)}n.HelpDialog&&(t+=r._ScrollWidth),n.Responsivable&&(t>500&&n.Responsive&&(n.Responsive=0,r._vm.Responsive(n.Responsive),r.RebuildGrid()),t<=500&&!n.Responsive&&(n.Responsive=1,r._vm.Responsive(n.Responsive),r.RebuildGrid())),r.$Container.parent().width()-4>t+r._ScrollWidth?r._vm.GridWidth(t+r._ScrollWidth):r._vm.GridWidth(t),n.HelpDialog&&r.$GridBody[0].scrollWidth-4<=r.$GridBody[0].clientWidth&&r.$GridBody.css("overflow-x","hidden"),r._vm.GridHeight(i);var c=a.parent();if(c&&c.width()<t+r._ScrollWidth){var v=c.width()-(a.outerWidth(!0)-a.width());v>t&&((!(t=v)||t<1)&&(t=400),r._vm.GridWidth(t))}d&&n?.npform?.W_?.$dvfrmCenter?.addClass("np-d-none"),r.FixHeader(),np.noNg((()=>setTimeout((function(){r.FixFooter()}),100)))}},FixFooter:function(){var t=this;t.options;if(t.$Footerview){t.$Footerview.find(e("div[IsDivToggle='1']")).hide(),1==e("div[TogglePages=1]:visible",t.$Footerview).length&&t.$Footerview.find(e("div[IsDivToggle='1']")).find("div[role='group']:hidden").each((function(i,o){e("div[TogglePages=1]:visible",t.$Footerview).before(e(o).css("display","inline"))}));t.$Footerview.height();var i=e("div[IsDivToggle=1]",t.$Footerview).parent(),o=e("div[IsDivToggle='1']",i);0==e("div",o).length&&e("div[role='group']:hidden",i).each((function(t,o){e("div[IsDivToggle='1']",i).append(e(o).css("display","block").show())}))}},FixHeader:function(){var e=this,t=e.options;t.NoShowHeader||t.Responsive||e._vm.TrOfTBody().length&&e.$Header.scrollLeft(e.$GridBody.scrollLeft())},CreateTBodyNPGridScript:function(){var t=this,i=t.options,o="",r="",n="",a=i.Responsive?"div":"tr",l=i.Responsive?"row grd-row":"";o="<"+a+" class='"+l+" "+NPGridTRClass+(i.NoTdPadding?" TR-NoTdPadding":"")+"' style='border:currentColor;font-weight:normal;"+(i.NoRowColor2||i.Responsive?"":"cursor: pointer;")+'\'    data-bind="css: $root.RowClassName($data,$context)      ,visible:DisplayTr       ,style:{height:$root.GridRowHeight()}      ,click:function($data,ev){return $parent.RowClick(ev,$data)}       ,event: { mouseover: $parent.mov, mouseout: $parent.mou,focusout:function($data,ev){return $root.RowBlur(ev,$data)}}      ,attr:{radifindex:RadifId}   " >';var d=t._vm.TrOfTHead().length;e.each(t._vm.TrOfTHead(),(function(o,n){r+="\x3c!-- ko if:(Index=='"+n.Index+"') --\x3e"+String.fromCharCode(10),i.GridInReport?r+="<tr  >"+String.fromCharCode(10):r+="<tr data-bind=\"npresizable: { animate: true  },npdraggable: { cursor: 'crosshair' }\" >"+String.fromCharCode(10),e.each(t._vm.ThTdNoHide(n,"Th"),(function(e,t){if(void 0!==t.CheckBox)r+='<th class=\'npgrid-header np-border-left-right\' > <input type="checkbox" data-bind="click:function($data,ev){return $root.NpAllCheckedClick(ev,$data)}, checked:$root.IsNpAllChecked() " /></th>';else{var i=t.Html().replace(/'/g,"\\'").replace(/"/g,"\\'").replace(/\n/g,"");r+="<th  class='npgrid-header np-border-left-right' "+(t.Index||0==t.Index?"npIndex='"+t.Index+"' ":"")+(t.RowSpan?"rowspan='"+t.RowSpan+"' ":"")+(t.ColSpanTemp()?"colspan='"+t.ColSpanTemp()+"' ":"")+(t.HDir?"dir='"+t.HDir+"' ":"")+(t.HAlign?"align='"+t.HAlign+"' ":"")+'data-bind="'+(t.Index||0==t.Index?"attr:{npTitle:'"+i+"'},click:function($data,ev){return $root.HeaderRowClickIndex(ev,"+t.Index+")}":"")+'">'+String.fromCharCode(10)+"<span data-bind=\"UniHtml:'"+(i||"")+"'\"></span>"+String.fromCharCode(10)+(!t.FilterType||1!=d&&1!=n.Index&&2!=t.RowSpan?"":"TXT"==t.FilterType?"<input type='text' class='FilterTextbox' data-bind='value:$root.Cols()["+t.Index+'].FilterTextbox,valueUpdate:"afterkeydown",click: function() { return true; }, clickBubble: false,attr:{width:($root.ColsNoHide()['+e+'].Width()+"px")}\' />':'<select data-bind=\'optionsCaption:"همه", optionsAfterRender:$root.SetOptionsAfterRender, options:$root.CalcFilterComboOptions('+t.Index+"), value:$root.Cols()["+t.Index+"].FilterComboSelected, click:function(){return true;}, clickBubble:false, attr:{width:(($root.ColsNoHide()["+e+'].Width()-6)+"px")}\'></select>')+"<span class='npgrid-sort nobr'>"+(t.Index||0==t.Index?'<span data-bind="css:$root.ClassNameByIndex('+t.Index+')"></span>':"")+"</span>"+String.fromCharCode(10)+"</th>"+String.fromCharCode(10)}})),r+="</tr>",r+="\x3c!-- /ko --\x3e"+String.fromCharCode(10)})),e.each(t._vm.ColsNoHide(),(function(r,a){var l=i.Responsive?"div":"td",d=i.Responsive?"height:"+i.ColHeight+"px;max-height:"+i.ColHeight+"px;t_ext-align: right;vertical-align:top !important;white-space:pre-wrap":a.CheckBox?"text-align: center":"vertical-align:top !important";i.GridInReport&&(d+=";position:inherit");var s=i.Responsive?"grd-col col-md-"+a.ColMdWidth+" col-"+a.ColXsWidth:"npgrid-body-cell np-border-left-right";n+='<col data-bind="attr:{width:ColsNoHide()['+r+"].Width()+'px'}\"  ></col>",o+=" <"+l+" data-container='body' np-col-name='"+a.Name+"'  style='"+d+"' class='"+s+(void 0===a.Index?" npgrid-header alert-info":"")+(void 0===a.Dir||"ltr"!=a.Dir.toLowerCase()||i.GridInReport||"1"==a.NoLatin?"":" IsLatin")+(void 0!==a.MultiLine&&"1"==a.MultiLine?"":" nobr")+"' "+(!a.Dir||i.Responsive&&a.NoLatin?"":"dir='"+a.Dir+"' ")+(void 0!==a.CheckBox||void 0===a.Index?"align='center'":void 0!==a.Align?"align='"+a.Align+"' ":"");var p=a.Index&&i.Cols[a.Index]&&i.Cols[a.Index].Enable,c="";if(p){var v=t.GetColId(p);v>-1&&(c=",enable:$data.Td()["+v+"].Html()")}if(void 0!==a.ShowTag&&"4"==a.ShowTag){var g,h="";e.each(i.RelField,(function(e,t){t.col-1==a.Index&&(h=t.id)})),a.NexCol&&isNaN(a.NexCol)?(g=t.GetColId(a.NexCol))<0&&(g=""):g=a.NexCol-1;var u="1"==a.NexRow?1:0;o+=">"+String.fromCharCode(10)+"<input type='"+(a.CB?"checkbox":"text")+"' autocomplete='off' Np-Col-Id='"+a.Index+"' "+(a.inputmode?"inputmode='"+a.inputmode+"' ":"")+(h?"GrdObjorgid='"+h+"' ":"")+"GridId='"+t._vm.GridId+"' "+(t._vm.OrgGridId?"OrgGridId='"+t._vm.OrgGridId+"' ":"")+'data-bind="'+(a.CB?"npcb:$data.Td()["+a.Index+"].Html":"value:$data.Td()["+a.Index+"].Html")+("1"==a.NOY?",noy:1":"")+c+",attr:{id:$root.GridId+'_"+a.Index+"_'+$data.Index"+(isNaN(g)?"":",GrdNexObjid:$root.GridId+'_"+g+"_'+($data.Index"+(u?"+1":"")+")")+'}"/>'+String.fromCharCode(10)}else if(void 0===a.CheckBox){var m="",C="",f="";void 0!==a.Index&&i.Responsive&&"1"==t._vm.Cols()[a.Index].ShowLabel&&(m="'"+np.GrdColCaptionElem1.replace(/'/g,"\\'")+t._vm.FullHeaderCaption[a.Index]+np.GrdColCaptionElem2+"'+"),"0"==a.ShowTag&&(C=i.Responsive?a.NoLatin?"'<span style=\\'display:inline-block;\\' dir=\\'"+a.Dir+"\\'>'+":"1"==a.MultiLine?"'<span style=\\'display:inline;white-space:pre-wrap;\\' dir=\\'"+a.Dir+"\\'>'+":"'<span style=\\'display:inline;\\' dir=\\'"+a.Dir+"\\'>'+":"'<span style=\\'width:100%;display:inline-block\\'>'+",f="+'</span>'"),o+=' data-bind="'+(void 0!==a.Index?"GridUniHtml:"+m+C+"$data.Td()["+a.Index+"].Html()"+f:"")+(void 0===a.Index?"UniText:RadifId":"")+",ShowTagGrid:'"+(void 0!==a.ShowTag&&"1"!=a.ShowTag&&"3"!=a.ShowTag||void 0===a.Index?"":"1")+(void 0!==a.ShowTag&&"1"!==a.ShowTag&&"3"!==a.ShowTag&&void 0!==a.Index?"0":"")+"',event: { mouseover: $parent.mov2, mouseout:$parent.mou2}"+(a.HideIfEmpty&&a.HideIfEmpty()?",visible:$data.Td()["+a.Index+"].Html()":"")+'">'+String.fromCharCode(10)}else o+=">"+String.fromCharCode(10)+'<input type="checkbox" data-bind="checked:$root.IsNpCheck($data,$context)"/>'+String.fromCharCode(10);o+="</"+l+">"+String.fromCharCode(10)}));a=i.Responsive?"div":"tr";o+="</"+a+">";var s="";s=i.Responsive?"<div 'cellspacing'=0 'cellpadding'=0 class='npgrid-table-body'><div data-bind=\"template:{name:TBodyNPGridScript,foreach: CurrTrOfTBody(), afterRender: AfterRender, afterMove:AfterMove }\" ></div></div>":"<table data-bind=\"style:{'width':CalcWidth()+'px'}\" 'cellspacing'=0 'cellpadding'=0 class='npgrid-table-body'><colgroup data-bind=\"template:{name:TColsNPGridScript}\" ></colgroup><tbody data-bind=\"template:{name:TBodyNPGridScript,foreach: CurrTrOfTBody(), afterRender: AfterRender, afterMove:AfterMove }\" ></tbody></table>",t.TFullNPGridScript.text(s),t.TBodyNPGridScript.text(o),t.THeadNPGridScript.text(r),t.TColsNPGridScript.text(n)},RebuildGrid:function(){var e=this;e.CreateTBodyNPGridScript(),e._vm.TFullNPGridScript(e.TFullNPGridScriptName),e._vm.TBodyNPGridScript(e.TBodyNPGridScriptName),e._vm.THeadNPGridScript(e.THeadNPGridScriptName),e._vm.TColsNPGridScript(e.TColsNPGridScriptName)},_create:function(){var t=this,i=t.options,o=t.element;t.$Toolbar=[],"0"==i.Responsive&&(i.Responsive=0),"0"==i.Responsivable&&(i.Responsivable=0),t.$Container=e("<div/>").attr("data-bind","style:{'width':Responsive()?null:(GridWidth()+'px')"+(i.Printable||i.HideGrid||i.HideHeader?"}":",'h_eight':GridHeight()+'px'}")).addClass("ui-npgrid bg-lig__ht").css("overflow",i.GridInReport?"":"hidden"),"1"==i.NewDesign&&t.$Container.css("max-width","100%"),t._Right=0,t._Top=0,t._ScrollWidth=0,i.LinePerPage=parseInt(i.LinePerPage,10);var r=o.attr("id");if(r)var n=i.npform.MakeOrgId(r);else r=o.uniqueId().attr("id");t._vm_subscriptions=[],i.NoPaging&&(i.Paging=!1),t._vm={GridId:r,OrgGridId:n,Responsive:ko.observable(i.Responsive),currpage:ko.observable(1),MaximizeIcon:ko.observable(i.MaximizeIcon),MinimizeIcon:ko.observable(i.MinimizeIcon),LinePerPage:ko.observable(i.LinePerPage),RowList:ko.observableArray(i.RowList),RowListSelected:ko.observableArray([parseInt(i.LinePerPage)]),pagecount:ko.observable(1),GridWidget:t,ShowMaxRow:ko.observable(!!i.MaxRow),MaxRow:ko.observable(i.MaxRow),UpDat:ko.observable(i.UpDat),_npform:i.npform},t.DontRunSetScaleInFirstTime=0;var a=[],l=[],d=0;t._HasFilter=!1,e("colgroup>col",e(o)).each((function(o,r){var n={},s=e(r).attr("width"),p=i.ColFirstNo+o;a[o]=o,s=s&&s.indexOf("px")>0?s.substr(0,s.indexOf("px")):s,n.Width=ko.observable(isNaN(s)?0:parseInt(s)),n.ColMdWidth=i.Cols[o]&&i.Cols[o].ColMdWidth||i.ColAttr["ColMdWidth"+p],n.ColXsWidth=i.Cols[o]&&i.Cols[o].ColXsWidth||i.ColAttr["ColXsWidth"+p],n.ColMdWidth>-1&&n.ColMdWidth<13||100==n.ColMdWidth||(n.ColMdWidth="12"),n.ColXsWidth>-1&&n.ColXsWidth<13||100==n.ColXsWidth||(n.ColXsWidth="12"),d+=n.Width();var c=i.HiddenAllColsFirst&&i.Cols[o]?1:i.Cols[o]&&i.Cols[o].Hide?i.Cols[o].Hide:0;i.Responsive&&!i.Responsivable||"1"!=i.ColAttr["Hide"+p]&&0!=s||(c=1),i.Responsive&&"1"==i.ColAttr["Hide"+p]&&(c=1);var v=i.Responsive&&"1"==i.ColAttr["HideIfEmpty"+p]?1:0;i.Cols[o]&&"1"==i.Cols[o].HideIfEmpty&&(v=1),n.Index=o,n.Hide=ko.observable(c),n.HideIfEmpty=ko.observable(v),n.OHtml=r.outerHTML,n.Name=i.Cols[o]&&i.Cols[o].Nam||i.ColAttr["NAME"+p]||i.ColPrefix+p,n.Data=i.Cols[o]?i.Cols[o].Dat||i.Cols[o].Data:p.toString(),n.NoLatin=i.Cols[o]&&i.Cols[o].NOLATIN||i.ColAttr["NOLATIN"+p],n.Dir=i.Cols[o]&&i.Cols[o].DIR||i.ColAttr["DIR"+p],n.Dir&&"ltr-farnum"==n.Dir.toLowerCase()&&(n.Dir="ltr",n.NoLatin="1"),n.Align=i.Cols[o]&&i.Cols[o].ALIGN||i.ColAttr["ALIGN"+p],n.NoLatin=i.GridInReport&&"right"==n.Align&&"ltr"==n.Dir?1:n.NoLatin,n.ColType=i.Cols[o]&&i.Cols[o].COLTYPE||i.ColAttr["COLTYPE"+p],n.MultiLine=i.Cols[o]&&i.Cols[o].MULTILINE||i.ColAttr["MULTILINE"+p],n.ShowTag=i.Cols[o]&&i.Cols[o].SHOWTAG||i.ColAttr["SHOWTAG"+p],n.CheckBox=i.Cols[o]&&i.Cols[o].CheckBox||i.ColAttr["CheckBox"+p],n.FilterType=i.Cols[o]&&i.Cols[o].FilterType||i.ColAttr["FilterType"+p],n.GridOutput=i.Cols[o]&&i.Cols[o].GridOutput||i.ColAttr["GridOutput"+p],n.ShowLabel=i.Cols[o]&&i.Cols[o].SHOWLABEL||i.ColAttr["SHOWLABEL"+p],n.NexCol=i.Cols[o]&&i.Cols[o].NexCol||i.ColAttr["NexCol"+p],n.NexRow=i.Cols[o]&&i.Cols[o].NexRow||i.ColAttr["NexRow"+p],n.CB=i.Cols[o]&&i.Cols[o].CB||i.ColAttr["CB"+p],n.NOY=i.Cols[o]&&i.Cols[o].NOY||i.ColAttr["NOY"+p],n.Typ=i.Cols[o]&&i.Cols[o].Typ||i.ColAttr["Typ"+p],n.CurLang=i.Cols[o]&&i.Cols[o].CurLang||i.ColAttr["CurLang"+p],n.Fro=i.Cols[o]&&i.Cols[o].Fro||i.ColAttr["Fro"+p],n.To=i.Cols[o]&&i.Cols[o].To||i.ColAttr["To"+p],n.Max=i.Cols[o]&&i.Cols[o].Max||i.ColAttr["Max"+p],n.Min=i.Cols[o]&&i.Cols[o].Min||i.ColAttr["Min"+p],n.Lan=i.Cols[o]&&i.Cols[o].Lan||i.ColAttr["Lan"+p],n.Fil=i.Cols[o]&&i.Cols[o].Fil||i.ColAttr["Fil"+p],n.Jus=i.Cols[o]&&i.Cols[o].Jus||i.ColAttr["Jus"+p],n.inputmode=i.Cols[o]&&i.Cols[o].inputmode||i.ColAttr["inputmode"+p],n.FilterType&&(t._HasFilter=!0),n.ColNo=o,n.FilterComboOptions=ko.observableArray([]),n.FilterComboHasNull=ko.observable(!1),n.FilterComboSelected=ko.observable(),n.FilterTextbox=ko.observable(),l.push(n),t._vm_subscriptions.push(n.FilterComboSelected.subscribe((function(){t._trigger("FilterComboChangeVal",null,{ColNo:o})})))})),t._vm.ColSeqs=ko.observableArray(a),t._vm.Sort=ko.observableArray([]),t._vm.Cols=ko.observableArray(l),t._vm.CalcFilterComboOptions=function(e){var i=t._vm.Cols()[e];return i.FilterComboHasNull()?[null].concat(i.FilterComboOptions()):i.FilterComboOptions()},t._vm.SetOptionsAfterRender=function(e,t){t||(e.style.fontStyle="italic")},t._vm.PauseApplyColsNoHide=ko.observable(!1),t._vm.Radif=ko.observable(i.Radif?i.Radif:0);var s=i.RadifWidth;try{s&&(i.RadifWidth=parseFloat(s))}catch(o){i.RadifWidth=30}t._vm.RadifCols=ko.observable({Width:ko.observable(i.RadifWidth?i.RadifWidth:30),Dir:i.ColAttr.DIRR,Align:i.ColAttr.ALIGNR,ColType:"NUMBER",Hide:t._vm.Radif()?0:1,Name:"Radif",Data:"R",Html:i.ShowRadifTitle?"ردیف":""}),d>10&&d<400&&void 0===i.NoPaging&&(i.NoPaging=!0,i.Paging=!1),t._vm.Paging=ko.observable(i.Paging),d+=t._vm.Radif()?t._vm.RadifCols().Width()+2:0,i.width>d&&(i.width=d);for(var p=[],c=[],v=0;v<t._vm.Cols().length;v++)p[v]=0,c[v]="";var g=[];e("thead>tr",e(o)).each((function(t,i){var o={},r=e(i);o.Index=t;var n=[],a=0;e("th",r).each((function(t,i){var o,r,l,d,s=e(i),v={};for(v.Html=ko.observable(s.html()),v.OHtml=i.outerHTML,s.attr("align")&&(v.HAlign=s.attr("align")),s.attr("dir")&&(v.HDir=s.attr("dir")),v.RowSpan=(o=s.attr("rowSpan"))&&!isNaN(o)?parseInt(o):1,v.ColSpan=(r=s.attr("colSpan"))&&!isNaN(r)?parseInt(r):1,v.ColSpanTemp=ko.observable(v.ColSpan),l=a;l<p.length&&0!=p[l];l++)p[l]--;for(v.Index=l,n.push(v),d=l;d<l+v.ColSpan;d++)p[d]+=v.RowSpan-1,c[d]?c[d]=v.Html()+" ("+c[d]+")":c[d]=v.Html();a=l+v.ColSpan})),o.Th=ko.observableArray(n),g.push(o)})),t._vm.TrOfTHead=ko.observableArray(g),t._vm.FullHeaderCaption=c,t._vm.GridWidth=ko.observable("auto"==i.width?50:i.width),t._vm.GridHeight=ko.observable("auto"==i.height?50:i.height),t._vm.RadifTh=ko.observable({Html:ko.observable(),RowSpan:t._vm.TrOfTHead().length,ColSpan:1,ColSpanTemp:ko.observable(1)}),t._vm.RadifTd=ko.observable({Html:ko.observable(),RowSpan:1,ColSpan:1,ColSpanTemp:ko.observable(1),id:"R"}),t._vm.TrOfTBody=ko.observableArray(),t._vm.CalcScrollWidth=ko.observable(t._ScrollWidth),t._vm.CalcWidth=ko.computed((function(){var e=0;return ko.utils.arrayFilter(this.Cols(),(function(t){return e+=0==t.Hide()?t.Width():0,!1})),e+=t._vm.Radif()?t._vm.RadifCols().Width()+2:0,t._OrgGridWidth&&t._OrgGridWidth<=t._vm.GridWidth()&&delete t._OrgGridWidth,e<t._vm.GridWidth()-t._vm.CalcScrollWidth()?(t._OrgGridWidth||(t._OrgGridWidth=t._vm.GridWidth()),t._vm.GridWidth(e+t._vm.CalcScrollWidth()-1)):t._OrgGridWidth&&t._vm.GridWidth(e+t._vm.CalcScrollWidth()-1),e}),t._vm),t._vm.CalcWidthWS=ko.computed((function(){return this.CalcWidth()+t._ScrollWidth}),t._vm),t._vm.ColsNoHide=ko.computed((function(){var e=null;this.PauseApplyColsNoHide()&&(e=ko.utils.arrayFilter(this.ColsNoHide(),(function(e,t){return!0})));var i=this.ColSeqs(),o=ko.utils.arrayFilter(this.Cols(),(function(e,t){return e.Seq=i[t],0==e.Hide()})).sort((function(e,t){var i=e.Seq,o=t.Seq;return i==o?0:i<o?-1:1}));return o=t._vm.Radif()?[t._vm.RadifCols()].concat(o):o,e||o}),t._vm),t._vm.SortPriority=function(e,t){t.$parent;var i=t.$root.Sort();for(v=0;v<i.length;v++)if(e.Index==i[v].ColId)return(++v).toString();return null},t._vm.SortAsc=function(e,t){t.$parent;var i=t.$root.Sort();for(v=0;v<i.length;v++)if(e.Index==i[v].ColId)return i[v].Asc?"2":"1";return null},t._vm.RowClassName=function(e,t){return i.NoRowColor1?"":t.$index()%2==0?i.EvenRowClass:i.OddRowClass},t._vm.ClassName=function(e){t._vm.ClassNameByIndex(e.Index)},t._vm.ClassNameByIndex=function(e){var i=t._vm.Sort();for(v=0;v<i.length&&v<10;v++)if(e==i[v].ColId){var o="ui-icon np-icon";return o+=" np-icon-sort",o+=i[v].Asc?"a":"d",o+=i.length>1?(++v).toString():""}return""},t._vm.ThTdNoHide=function(e,i,o){var r,n=t._vm,a=this.ColSeqs(),l=ko.utils.arrayFilter("Th"==i?e.Th():e.Td(),(function(e,t){var o=0;e.Seq=a[e.Index],e.ColSpan-1;for(var r=e.Index;r<e.Index+e.ColSpan;r++)0==n.Cols()[r].Hide()&&o++;e.ColSpanTemp(o),e.Dir=n.Cols()[e.Index].Dir,e.Align=n.Cols()[e.Index].Align,e.MultiLine=n.Cols()[e.Index].MultiLine,e.ShowTag=n.Cols()[e.Index].ShowTag,e.FilterType=n.Cols()[e.Index].FilterType;var l=n.Cols()[e.Index].CheckBox;return("Td"==i||l&&"1"==l)&&(e.CheckBox=l),void 0!==e.CheckBox?(e.TempName=i+"NPGrid_Check",e.Align="center"):void 0===e.ShowTag||"0"==e.ShowTag||"2"==e.ShowTag?e.TempName=i+"NPGrid_Html":void 0!==e.ShowTag&&"0"!==e.ShowTag&&"2"!==e.ShowTag&&(e.TempName=i+"NPGrid_Text"),o>0})).sort((function(e,t){var i=e.Seq,o=t.Seq;return i==o?0:i<o?-1:1}));return(r="Th"==i?t._vm.Radif()&&0==e.Index?t._vm.RadifTh():null:t._vm.Radif()?t._vm.RadifTd():null)&&(r.Dir=n.RadifCols().Dir,r.Align=n.RadifCols().Align,r.Html(n.RadifCols().Html)),r?[r].concat(l):l};var h=parseInt(1e11*Math.random());t.TFullNPGridScriptName="TemplateF"+h,t.TBodyNPGridScriptName="TemplateB"+h,t.THeadNPGridScriptName="TemplateH"+h,t.TColsNPGridScriptName="TemplateC"+h,t._vm.OneRowData=ko.observableArray(["1"]);var u,m="";m+="<script type='text/html' id='"+t.TFullNPGridScriptName+"'><\/script>",m+="<script type='text/html' id='"+t.TBodyNPGridScriptName+"'><\/script>",m+="<script type='text/html' id='"+t.THeadNPGridScriptName+"'><\/script>",m+="<script type='text/html' id='"+t.TColsNPGridScriptName+"'><\/script>",e("body").append(e(m)),t.TFullNPGridScript=e("#"+t.TFullNPGridScriptName),t.TBodyNPGridScript=e("#"+t.TBodyNPGridScriptName),t.THeadNPGridScript=e("#"+t.THeadNPGridScriptName),t.TColsNPGridScript=e("#"+t.TColsNPGridScriptName),t.CreateTBodyNPGridScript(),t._vm.TFullNPGridScript=ko.observable(t.TFullNPGridScriptName).extend({notify:"always"}),t._vm.TBodyNPGridScript=ko.observable(t.TBodyNPGridScriptName).extend({notify:"always"}),t._vm.THeadNPGridScript=ko.observable(t.THeadNPGridScriptName).extend({notify:"always"}),t._vm.TColsNPGridScript=ko.observable(t.TColsNPGridScriptName).extend({notify:"always"}),t._vm_subscriptions.push(t._vm.ColsNoHide.subscribe((function(){t._vm.PauseApplyColsNoHide()||t.RebuildGrid()}))),t._MakeGrid(),np.noNg((()=>setTimeout((function(){t.ReCalcDim(null,null,1)}),1))),t._vm_subscriptions.push(t._vm.RowListSelected.subscribe((function(){if(t.HideDivToggle(),!isNaN(t._vm.RowListSelected.peek()[0])){t._vm.LinePerPage(t._vm.RowListSelected.peek()[0]);var e=t._vm.TrOfTBody().length?parseInt((t._vm.TrOfTBody().length-1)/t._vm.LinePerPage())+1:1;t._vm.pagecount.peek()!==e&&t._vm.pagecount(e),t._vm.pagecount()<t._vm.currpage()&&t._vm.currpage(t._vm.pagecount())}}))),t._vm_subscriptions.push(t._vm.currpage.subscribe((function(){isNaN(t._vm.currpage.peek())||t._vm.currpage.peek()<1?t._vm.currpage(1..toString()):t._vm.currpage.peek()>t._vm.pagecount()?t._vm.currpage(t._vm.pagecount().toString()):t.ShowFirstRow()}))),t._vm.TrSortedOfTBody=ko.computed((function(){var i=this,o=i.Sort(),r=i.TrOfTBody();return t._HasFilter&&(r=ko.utils.arrayFilter(r,(function(t,o){var r=!0;return e(t.Td()).each((function(e,t){if("COM"==t.FilterType){if(i.Cols()[t.Index].FilterComboSelected()&&t.Html()!=i.Cols()[t.Index].FilterComboSelected())return r=!1,!1;if(null===i.Cols()[t.Index].FilterComboSelected()&&""!=t.Html())return r=!1,!1}if("TXT"==t.FilterType&&""!=i.Cols()[t.Index].FilterTextbox())try{if(!new RegExp(i.Cols()[t.Index].FilterTextbox(),"i").test(t.Html()))return r=!1,!1}catch(e){}})),r}))),i.pagecount(r.length?parseInt((r.length-1)/i.LinePerPage())+1:1),i.pagecount()<i.currpage()&&i.currpage(i.pagecount()),o.length?r.sort((function(t,r){for(var n,a,l,d,s=0;s<o.length;){a=o[s].ColId,l=t.Td()[a].Val,d=r.Td()[a].Val;try{function p(t){return t.indexOf("<")>-1?e("<A>"+t+"</A>").text():t}l=p(l),d=p(d)}catch(e){}if(i.Cols()[a].ColType&&"NUMBER"==i.Cols()[a].ColType.toUpperCase()?(l=l.replace(/\//gi,"."),d=d.replace(/\//gi,"."),l=parseFloat(l),d=parseFloat(d)):(l=np.utils.NPTrim(l),d=np.utils.NPTrim(d)),n=isNaN(l)||""==l?isNaN(d)||""==d?d.toString().localeCompare(l.toString()):-1:isNaN(d)||""==d?1:l==d?0:l<d?-1:1,o[s].Asc||(n=-n),0!==n)return n;s++}return 0})):r}),t._vm),t._vm.CurrTrOfTBody=ko.observableArray([]),t._vm.CurrTrOfTBodyNew=ko.computed((function(){var e,t=this;return!t.Paging.peek()||i.Printable?t.TrSortedOfTBody():(e=(t.currpage.peek()-1)*t.LinePerPage(),t.TrSortedOfTBody().slice(e,e+t.LinePerPage()))}),t._vm),t._vm_subscriptions.push(t._vm.CurrTrOfTBodyNew.subscribe((function(o){t.AppendTimeout2&&(np.noNg((()=>clearTimeout(t.AppendTimeout2))),t.AppendTimeout2=null);var r=i.Responsive?e("div.npgrid-table-body",t.$GridBody):e("table",t.$GridBody);e("."+i.ActiveRowClass,r).removeClass(i.ActiveRowClass);var n,a,l=t._vm.Paging.peek()?(t._vm.currpage()-1)*t._vm.LinePerPage()+1:1,d=t._vm.CurrTrOfTBody(),s=d.length,p=o.length,c=p?o[0].Td().length:0;function v(i){for(d[i].DisplayTr(!0),d[i].RadifId(l+i),d[i].Index=o[i].Index,d[i].RIdIndex=o[i].RIdIndex,d[i].ServerData=o[i].ServerData,d[i].SrcData=o[i],a=0;a<c;a++)d[i].Td()[a].Html(o[i].Td()[a].Html()),d[i].Td()[a].Val=o[i].Td()[a].Val,d[i].Td()[a].Index=o[i].Td()[a].Index,d[i].Td()[a].id=o[i].Td()[a].id;if(!d[i].Elem){var r=e('.TR-NPGrid[radifindex="'+d[i].RadifId()+'"]',t.$TBody);r.length?d[i].Elem=[r[0]]:d[i].Elem=[]}t._vm.AfterRender(d[i].Elem,d[i])}for(n=0;n<s||n<p;n++)n<p&&n<s?v(n):n<s&&(d[n].DisplayTr(!1),d[n].Index=null);if(p>s){for(n=s;n<p;n++)for(d[n]={Index:o[n].Index,RadifId:ko.observable(l+n),RIdIndex:o[n].RIdIndex,DisplayTr:ko.observable(!0),Td:ko.observableArray([]),ServerData:o[n].ServerData,SrcData:o[n]},a=0;a<c;a++)d[n].Td()[a]={},d[n].Td()[a].Html=ko.observable(o[n].Td()[a].Html()),d[n].Td()[a].Val=o[n].Td()[a].Val,d[n].Td()[a].Index=o[n].Td()[a].Index,d[n].Td()[a].id=o[n].Td()[a].id;t._vm.CurrTrOfTBody(d)}i.CheckBox_MS&&i.CheckBox_MS(i.CheckBox_MS()),t.AfterComplete()}))),t._vm.printtedad=ko.computed((function(){var e,t,i=this;return i.Paging()?(t=(t=(e=i.TrSortedOfTBody().length?(i.currpage()-1)*i.LinePerPage()+1:0)+i.LinePerPage()-1)>i.TrSortedOfTBody().length.toString()?i.TrSortedOfTBody().length.toString():t,i.ShowMaxRow()?"نمایش "+e.toString()+" - "+t.toString()+" از تعداد رکورد دریافتی ":"نمایش "+e.toString()+" - "+t.toString()+" از "+i.TrSortedOfTBody().length.toString()):i.ShowMaxRow()?"تعداد ":"تعداد:  "+i.TrSortedOfTBody().length.toString()}),t._vm),t._vm.HeaderRowClick=function(e,i){void 0!==i.Index&&t._vm.HeaderRowClickIndex(e,i.Index)},t._vm.HeaderRowClickIndex=function(e,o){if(!NPGridStopSort&&!i.StopSort){var r,n=t._vm.Sort(),a=[],l=!1;if(e.ctrlKey)for(r=0;r<n.length;r++)n[r].ColId!==o&&a.push({ColId:n[r].ColId,Asc:n[r].Asc});for(r=0;r<n.length;r++)n[r].ColId==o&&(a.push({ColId:n[r].ColId,Asc:!n[r].Asc}),l=!0);l||a.push({ColId:o,Asc:!0}),t._vm.Sort(a)}},t._vm.IsNpAllChecked=function(o){var r=t._vm.TrOfTBody(),n=!0;return e.each(r,(function(t,o){if(!i.CheckBox_MS()||!e('row[VAL="'+o.Td()[i.CheckBox_Index_VAL].Val+'"]',i.CheckBox_MS()).length)return n=!1,!1})),n},t._vm.IsNpCheck=function(t,o){o.$parent;return!(!i.CheckBox_MS()||!e('row[VAL="'+t.Td()[i.CheckBox_Index_VAL].Val+'"]',i.CheckBox_MS()).length)},t._vm.NpAllCheckedClick=function(o,r){var n=t._vm.TrOfTBody();if(t._vm.IsNpAllChecked()){var a=e("r",e.parseXML(i.CheckBox_MS()||"<r/>"));e.each(n,(function(t,o){e('row[VAL="'+o.Td()[i.CheckBox_Index_VAL].Val+'"]',a).remove()})),i.CheckBox_MS(a.parent().xml2())}else{a=e("r",e.parseXML(i.CheckBox_MS()||"<r/>"));e.each(n,(function(t,o){e('row[VAL="'+o.Td()[i.CheckBox_Index_VAL].Val+'"]',a).length||a.append(e("row",e.parseXML("<row/>")).attr("DSC",o.Td()[i.CheckBox_Index_DSC].Val).attr("VAL",o.Td()[i.CheckBox_Index_VAL].Val).attr("TIP",o.Td()[i.CheckBox_Index_TIP].Val))})),i.CheckBox_MS(a.parent().xml2())}return!0},t._vm.RowBlur=function(i,o){var r={};r.Data=o;var n,a=e(i.target),l=-1,d=-1,s=null,p=a,c=p.attr("Np-Col-Id");if(!c)return!0;for(;p.length;){if(("TD"==p[0].tagName||"DIV"==p[0].tagName&&p.hasClass("grd-col"))&&(d=p.index(),n=p.attr("np-col-name")),("TR"==p[0].tagName&&p.hasClass("TR-NPGrid")||"DIV"==p[0].tagName&&p.hasClass("grd-row"))&&p.hasClass(NPGridTRClass)){s=p,l=p.index()+1+(t._vm.currpage()-1)*t._vm.LinePerPage();break}p=p.parent()}return-1==l||-1==d||(r.ClickEvent=i,r.iRow=l,r.iCol=d,r.ColName=n,r.LastVal=o.SrcData.Td()[c].Html(),r.NewVal=o.Td()[c].Html(),r.Grd=t,r.ElemTR=s,r.Element=s,r.AcceptChange=!0,r.HasError="1"==a.data("nphaserror"),this.GridWidget._trigger("OnGridTextBlur",null,r),r.AcceptChange?o.SrcData.Td()[c].Html()!=r.NewVal&&(o.SrcData.Td()[c].Html(r.NewVal),o.SrcData.Td()[c].Val=np.utils.escapeXml(r.NewVal),o.Td()[c].Val=np.utils.escapeXml(r.NewVal),o.ServerData.attr(t.options.ColPrefix+t._vm.Cols()[c].Data,r.NewVal),o.ServerData.attr("change","1")):o.Td()[c].Html(o.SrcData.Td()[c].Html()),this.GridWidget._trigger("AfterGridTextBlur",null,r)),!0},t._vm.RowClick=function(o,r){var n={};n.Data=r;for(var a,l=e(o.target),d=-1,s=-1,p="",c=null;l.length;){if(("TD"==l[0].tagName||"DIV"==l[0].tagName&&l.hasClass("grd-col"))&&(s=l.index(),a=l.attr("np-col-name"),p=l.html()),("TR"==l[0].tagName&&l.hasClass("TR-NPGrid")||"DIV"==l[0].tagName&&l.hasClass("grd-row"))&&l.hasClass(NPGridTRClass)){c=l,d=l.index()+1+(t._vm.currpage()-1)*t._vm.LinePerPage();break}l=l.parent()}var v=e(o.target);if(v.is("span")&&v.hasClass(np.GrdColCaptionClass)){var g=t.GetColId(a);g>-1&&t._vm.HeaderRowClickIndex(o,g)}if(n.ClickEvent=o,n.iRow=d,n.iCol=s,n.ColName=a,n.CellContent=p,n.Grd=t,n.ElemTR=c,n.Element=c,i.CheckBox_MS){var h=e("r",e.parseXML(i.CheckBox_MS()||"<r/>"));"1"==i.CheckBox_SS&&e("row",h).remove();var u=e('row[VAL="'+r.Td()[i.CheckBox_Index_VAL].Val+'"]',h);if(u.length)u.remove();else{var m=i.npform.ViewModel,C=!1;e.each(r.ServerData[0].attributes,(function(e,t){0==t.name.indexOf("ref")&&(m["_"+t.name]&&m[m["_"+t.name]](t.value),m["_"+t.name]&&(C=!0))})),C&&e("row",h).remove(),u=e("row",e.parseXML("<row/>")).attr("DSC",r.Td()[i.CheckBox_Index_DSC].Val).attr("TIP",r.Td()[i.CheckBox_Index_TIP].Val).attr("VAL",r.Td()[i.CheckBox_Index_VAL].Val),h.append(u)}i.CheckBox_MS(h.parent().xml2())}c&&!i.NoRowColor3&&((i.Responsive?e("div>div.grd-row",t.$GridBody):e("tr.TR-NPGrid",t.$GridBody)).removeClass(i.ActiveRowClass),c.addClass(i.ActiveRowClass));function f(t){var o=null;return!(!i.Modes||!i.Modes.All)&&(e(i.Modes.All).each((function(e,i){if(i.Mode===t)return o=i,!1})),!!o)}return i.npform&&i.Modes&&i.Modes.Switch&&(f("4")?i.npform.Val(i.Modes.Switch,"4"):f("3")?i.npform.Val(i.Modes.Switch,"3"):f("2")&&i.npform.Val(i.Modes.Switch,"2")),t.GridOnRowClickParams=n,this.GridWidget._trigger("InitOnRowClick",null,n),this.GridWidget._trigger("OnRowClick",null,n),this.GridWidget._trigger("InitAfterRowClick",null,n),this.GridWidget._trigger("AfterRowClick",null,n),!0},t._vm.gonext=function(i,o){t.HideDivToggle(),e(o.currentTarget).blur(),this.currpage()<this.pagecount()&&this.currpage(parseInt(t._vm.currpage())+1)},t._vm.goprev=function(i,o){t.HideDivToggle(),e(o.currentTarget).blur(),this.currpage()>1&&this.currpage(this.currpage()-1)},t._vm.gofirst=function(i,o){t.HideDivToggle(),e(o.currentTarget).blur(),this.currpage(1)},t._vm.golast=function(i,o){t.HideDivToggle(),e(o.currentTarget).blur(),this.currpage(this.pagecount())},t._vm.FullScreenClickFunc=function(e,i){t.OpenFullScreen()},t._vm.CloseFullScreenClickFunc=function(e,i){t.$Container.npUiDialog("close")},t._vm.RefreshMaxRow=function(){var o=this.MaxRow();if(!isNaN(o)&&o>0&&(o=parseInt(o))){var r;t.options.MaxRowId?t.options.npform.Val(t.options.MaxRowId,o):r={IsHelp:!0,MaxHlp:o};var n=i.AdvSearchParams;n&&e.each(n,(function(e,i){t.options.npform.Val(e,i)})),t.options.npform.DoAct(t.options.ActNo,null,r),n&&e.each(n,(function(e,i){t.options.npform.Val(e,"")}))}},t._vm.mov=function(t,o){i.NoRowColor2||i.Responsive||e(o.currentTarget).addClass("ui-state-hover").css("font-weight","normal")},t._vm.mou=function(t,o){i.NoRowColor2||i.Responsive||e(o.currentTarget).removeClass("ui-state-hover")},t._vm.mov2=function(o,r){if(i.Responsive){var n=r.currentTarget;if(n.scrollWidth>n.clientWidth){var a=n.innerText,l=n.offsetLeft-20,d=n.offsetTop+55-t.$GridBody[0].scrollTop;e(window).width()-n.offsetWidth<l&&(l=0),e(window).height()-n.offsetHeight<d&&(d=0),t.ToolTip.css({top:d,left:l}).show().text(a)}}},t._vm.mou2=function(e,o){i.Responsive&&t.ToolTip.hide()},t._vm.AfterMove=function(e,t,i){},t._vm.AfterRender=function(o,r){t._trigger("AftFilRowInternal",null,{Element:o,Grd:t,Data:r}),t._trigger("AftFilRow",null,{Element:o,Grd:t,Data:r}),i.RowMaxHeight&&e(o).height()>i.RowMaxHeight&&e(o).height(i.RowMaxHeight)},t._vm.GridRowHeight=ko.observable("auto"),ko.applyBindings(t._vm,t.$Container[0]),u="string"==typeof i.InXML?e.parseXML(i.InXML):i.InXML,t.refresh(u),i.Printable||t._setOption("npform",i.npform)},LastSelectedRow:function(){return this.GridOnRowClickParams},OpenFullScreen:function(){var t=this;t.options;t.TempWidth=t._vm.GridWidth(),t.TempHeight=t._vm.GridHeight();var i=parseInt(e("body").width()-5),o=parseInt(e("body").height()-100);t._vm.MaximizeIcon(0),t._vm.MinimizeIcon(1);var r=t._vm.CalcWidth()+t._vm.CalcScrollWidth();r<i?t.ReCalcDim(r,o):t.ReCalcDim("auto",o),t.$Container.npUiDialog({appendTo:t.$Container.closest(".np-fitdivtoparent"),width:parseInt(e("body").width()),height:parseInt(e("body").height()),StopDraggable:!0,modal:!0,npDialog:!0,open:function(t,i){e(t.target).parent().addClass("ui-dialog-grid")},close:function(e,i){t._vm.MaximizeIcon(1),t._vm.MinimizeIcon(0),t.$Container.npUiDialog("destroy"),t.ReCalcDim("auto",t.TempHeight)}})},AfterComplete:function(){var t=this,i=t.options.Responsive?e("div.npgrid-table-body",t.$GridBody):e("table",t.$GridBody);t.CompleteCnt=t.CompleteCnt||0,++t.CompleteCnt,t._trigger("AfterGridDrawCompleted",null,{Data:t._vm.TrOfTBody.peek(),Grd:t,Elem:i})},GetGridData:function(t){var i=this,o=i.options,r=t&&t.xml,n=[];if(e.each(i._vm.Cols(),(function(e,t){"1"==t.GridOutput&&n.push({Data:o.ColPrefix+t.Data,Name:t.Name||o.ColPrefix+t.Data})})),!o.RIdCol&&!n.length)return"";if(e.each(i._vm.Cols(),(function(e,t){"4"==t.ShowTag&&"1"!=t.GridOutput&&n.push({Data:o.ColPrefix+t.Data,Name:t.Name||o.ColPrefix+t.Data})})),!n.length)return"";var a="<r><dat>",l=i._vm.TrOfTBody();return e.each(l,(function(t,i){var r=i.ServerData;if("1"==r.attr("change")){if(a+="<N ",o.RIdCol){var l=np.utils.escapeXml(r.attr(o.ColPrefix+o.RIdCol)||0);a+='RId="'+l+'" '}e.each(n,(function(e,t){a+=t.Name+'="'+np.utils.escapeXml(r.attr(t.Data)||"")+'" '})),a+="></N>"}})),a+="</dat></r>",a=e("dat",e.parseXML(a)),r?a:a.parent().xml2()},refresh:function(t,i,o){var r,n,a=this,l=a.options;if(t&&(r=!0),i)l.RId&&(e(l.RowNodeName+"["+l.ColPrefix+l.RIdCol+'="'+i+'"]',e(t)).length||a._vm.TrOfTBody.remove((function(e){return!(!e.RIdIndex||e.Td()[e.RIdIndex-1].Val!=i)})),n=a._vm.TrOfTBody(),e(l.RowNodeName,e(t)).each((function(t,i){var o=e(i),r=o.attr(l.ColPrefix+l.RIdCol);r&&(o.attr("IsAdded",0),e.each(a._vm.TrOfTBody(),(function(t,i){if(i.RIdIndex&&i.Td()[this.RIdIndex-1].Val==r){for(var n,d=a._vm.CurrTrOfTBody(),s=d.length,p=0;p<s;p++)d[p].DisplayTr()&&d[p].Index==i.Index&&((n=d[p]).ServerData=o);if(e.each(a._vm.Cols(),(function(t,r){var n,a=this.Data?l.ColPrefix+this.Data:"";i.Td()[t].Val=a&&(n=o.attr(a))?n:"",void 0===r.ShowTag&&(0!=i.Td()[t].Val.indexOf('<NOBR dir="ltr">')&&0!=i.Td()[t].Val.indexOf('<nobr dir="ltr">')||(i.Td()[t].Val=e(i.Td()[t].Val).html())),i.Td()[t].Html(i.Td()[t].Val),i.Td()[t].Val=np.utils.escapeXml(i.Td()[t].Val),r.FilterType&&"COM"==r.FilterType&&-1==r.FilterComboOptions().indexOf(i.Td()[t].Html())&&(i.Td()[t].Html()?r.FilterComboOptions.push(i.Td()[t].Html()):r.FilterComboHasNull(!0))})),i.ServerData=o,a._trigger("GetRowDataInternal",null,{Grd:a,Data:i,Edit:!0}),a._trigger("GetRowData",null,{Grd:a,Data:i,Edit:!0}),n){e.each(a._vm.Cols(),(function(e,t){n.Td()[e].Val=i.Td()[e].Val,n.Td()[e].Html(i.Td()[e].Html())}));var c=l.Responsive?e('div[radifindex="'+n.RadifId()+'"]',a.$TBody):e('tr[radifindex="'+n.RadifId()+'"]',a.$TBody);c=c.length?[c[0]]:[],a._vm.AfterRender(c,n)}o.attr("IsAdded",1)}})))})),e(l.RowNodeName+'[IsAdded="0"]',e(t)).each((function(e,t){})));else{n=[];for(var d=0;d<a._vm.Cols().length;d++)a._vm.Cols()[d].FilterComboOptions([]),a._vm.Cols()[d].FilterComboHasNull(!1);var s=[];if(t.documentElement)s=e("dat",t).children();else e(t).length&&"dat"==e(t)[0].tagName?s=e(t)[0].children:console.error("bug in npgrid data");e.each(s,((t,i)=>{var o={},r=e(i);o.Index=t;var d=[],s=0;e.each(a._vm.Cols(),(function(t,i){var n,a={};a.id=this.Data?l.ColPrefix+this.Data:"",a.Val=a.id&&(n=r.attr(a.id))?n:"",void 0===i.ShowTag&&(0!=a.Val.indexOf('<NOBR dir="ltr">')&&0!=a.Val.indexOf('<nobr dir="ltr">')&&0!=a.Val.indexOf('<div class="dirltr nobr">')||(a.Val=e(a.Val).html())),a.Html=ko.observable(a.Val),a.Val=np.utils.escapeXml(a.Val),a.FilterType=i.FilterType,i.FilterType&&"COM"==i.FilterType&&-1==i.FilterComboOptions().indexOf(a.Html())&&(a.Html()?i.FilterComboOptions.push(a.Html()):i.FilterComboHasNull(!0)),a.Index=s++,d.push(a),l.RIdCol==this.Data&&(o.RIdIndex=s)})),o.Td=ko.observableArray(d),o.ServerData=r,a._trigger("GetRowDataInternal",null,{Grd:a,Data:o}),a._trigger("GetRowData",null,{Grd:a,Data:o}),n.push(o)})),l.NoPaging||a._vm.Paging(!0),a._vm.TrOfTBody(n),n.length<a._vm.LinePerPage()&&!l.FullScreenable?a._vm.Paging(!1):l.FullScreenable||l.NoPaging||a._vm.Paging(!0)}l.Printable||(a._vm.pagecount(a._vm.TrSortedOfTBody().length?parseInt((a._vm.TrSortedOfTBody().length-1)/a._vm.LinePerPage())+1:1),a._vm.pagecount()<a._vm.currpage()&&a._vm.currpage(a._vm.pagecount()),r&&!o?a.ReCalcDim():a.FixHeader(),"1"!=l.NewDesign||l.NoShowHeader||l.Responsive||a.$Header.css("max-width","calc(100% - "+a._ScrollWidth+"px)"))},FireTrigger:function(e,t){this._trigger(e,null,t)},Hyper:function(t,i){e(t.element).children().eq(i).wrapInner("<div/>").find("div").addClass("np-hypertext")},_SetMode:function(t){var i,o=this.options,r=null;if(o.Modes){if(t=""+t,e(o.Modes.All).each((function(e,o){if(o.Mode===t)return i=o,!1})),!i)return alert("this mode is undefined"),!1;o.Modes.Dlg&&(r=i.ModeXml.tit)&&(e(o.Modes.Dlg.Obj).is(":np-npUiDialog")?e(o.Modes.Dlg.Obj).npUiDialog("option","title",r):e(o.Modes.Dlg.Obj).npDialog("option","title",r)),o.npform.InitFrm(!0),this._trigger("AftSwitch",null,{Switch:t})}else alert("the grid have not Modes")},SetMode:function(t){var i=this.options;i.npform.Val(i.Modes.Switch,t),i.Modes.Dlg&&(e(i.Modes.Dlg.Obj).is(":visible")||(e(i.Modes.Dlg.Obj).is(":np-npUiDialog")?e(i.Modes.Dlg.Obj).npUiDialog("open"):e(i.Modes.Dlg.Obj).npDialog("open")))},HideDlg:function(){var t=this.options;t.Modes.Dlg&&(e(t.Modes.Dlg.Obj).is(":np-npUiDialog")?e(t.Modes.Dlg.Obj).npUiDialog("close"):e(t.Modes.Dlg.Obj).npDialog("close"))},SetDlg:function(t,i,o){var r=this,n=r.options;if(n.Modes=n.Modes||{},t&&(n.Modes.Dlg=n.Modes.Dlg||{},n.Modes.Dlg.Obj=e(t),o&&(r.CreateDlg=!0)),i){n.Modes.Dlg=n.Modes.Dlg||{};var a=n.Modes.Dlg.options=n.Modes.Dlg.options||{};e(i).each((function(e,t){a[e]=t})),r.CreateDlg&&(e(n.Modes.Dlg.Obj).is(":np-npUiDialog")?e(n.Modes.Dlg.Obj).npUiDialog("option",a):e(n.Modes.Dlg.Obj).npDialog("option",a))}r._setOption("npform",n.npform)},_setOption:function(t,i){var o=this,r=o.options;o._super(t,i),"MaxRow"===t&&(o._vm.MaxRow(i),o._vm.ShowMaxRow(!!i)),"LinePerPage"===t&&o._vm.RowListSelected([i]),"Paging"===t&&o._vm.Paging(i),"UpDat"===t&&o._vm.UpDat(i),("Modes"===t&&i&&r.npform||"npform"===t&&i&&r.Modes)&&(r.Modes.Switch&&!o.extendGrdModeSwitch&&(o._vm_subscriptions.push(r.npform.ViewModel[r.Modes.Switch].extend({notify:"always"}).subscribe((function(e){o._SetMode(e.toString())}))),o.extendGrdModeSwitch=!0),r.Modes.Dlg&&r.Modes.Dlg.Obj&&!o.CreateDlg&&(e(r.Modes.Dlg.Obj).is(":np-npUiDialog")?(r.ModeDlg=e(r.Modes.Dlg.Obj).npUiDialog({minWidth:e(r.Modes.Dlg.Obj).width(),autoOpen:!1,appendTo:r.npform.$np("#bod"),position:{my:"center",at:"center",of:window,collision:"flip",using:null}}),r.Modes.Dlg.Options&&e(r.Modes.Dlg.Obj).npUiDialog("option",r.Modes.Dlg.Options)):(r.ModeDlg=e(r.Modes.Dlg.Obj).npDialog({minWidth:e(r.Modes.Dlg.Obj).width(),autoOpen:!1,appendTo:r.npform.$np("#bod"),position:{my:"center",at:"center",of:window,collision:"flip",using:null}}),r.Modes.Dlg.Options&&e(r.Modes.Dlg.Obj).npDialog("option",r.Modes.Dlg.Options)),o.CreateDlg=!0)),"HideFooter"===t&&i&&o.$Footerview.hide()},GetTdByName:function(t,i){var o=null,r=this.options;if(t.Td&&ko.isObservable(t.Td))e.each(this._vm.Cols(),(function(e,r){if(r.Name==i)return o=t.Td()[e],!1}));else{var n=r.Responsive?"div":"td";o=e(n+'[np-col-name="'+i+'"]',t)}return o},ShowHideColById:function(t,i){var o=this;Array.isArray(t)||(t=[t]),o._vm.PauseApplyColsNoHide(!0),e.each(t,(function(e,t){o._vm.Cols()[t].Hide(i)})),o._vm.PauseApplyColsNoHide(!1)},ShowHideAllCols:function(t,i){var o=this;o._vm.PauseApplyColsNoHide(!0),e.each(o._vm.Cols(),(function(e,i){(1==t&&0==o._vm.Cols()[e].Hide()||0==t&&1==o._vm.Cols()[e].Hide())&&o._vm.Cols()[e].Hide(t)})),o._vm.GridWidth(0),i||o._vm.PauseApplyColsNoHide(!1)},HideAllCols:function(e){this.ShowHideAllCols(1,e)},ShowAllCols:function(e){this.ShowHideAllCols(0,e)},HideColById:function(e){this.ShowHideColById(e,1)},ShowColById:function(e){this.ShowHideColById(e,0)},SetFilteredTrOfTBody:function(e){this._vm.TrOfTBody(e)},SetShowTageById:function(e,t){var i=this;i._vm.PauseApplyColsNoHide(!0),i._vm.Cols()[e].ShowTag(t),i._vm.PauseApplyColsNoHide(!1)},GetColId:function(t){var i=-1;return e.each(this._vm.Cols(),(function(e,o){if(o.Name==t)return i=e,!1})),i},GetiColByName:function(t){var i=-1;return e.each(this._vm.ColsNoHide(),(function(e,o){if(o.Name==t)return i=e,!1})),i},SetFilterByColName:function(t,i){var o=!1;return e.each(this._vm.Cols(),(function(e,r){if(r.Name==t&&r.FilterTextbox)return o=!0,r.FilterTextbox(i),!1})),o},ShowHideColByName:function(t,i){var o,r=this,n=[];Array.isArray(t)||(t=[t]),e.each(t,(function(e,t){(o=r.GetColId(t))>-1&&n.push(o)})),r.ShowHideColById(n,i)},HideColByName:function(e){this.ShowHideColByName(e,1)},ShowColByName:function(e){this.ShowHideColByName(e,0)},ChangeDlgTitle:function(t,i){var o,r=this.options;if(r.Modes)return t=""+t,e(r.Modes.All).each((function(e,i){if(i.Mode===t)return o=i,!1})),o?(i&&(o.ModeXml.tit=i),o.DlgTitle):(alert("this mode is undefined"),!1);alert("the grid have not Modes")},ChangeDisableF:function(t,i,o){var r,n,a=this.options;if(a.Modes){if(t=""+t,e(a.Modes.All).each((function(e,i){if(i.Mode===t)return r=i,!1})),!r)return alert("this mode is undefined"),!1;Array.isArray(i)||(i=[i]),(n=r.ModeXml.DisableF)||(n=""),"Replace"===o&&(n=""),"Remove"===o?e(i).each((function(e,t){var i=n.indexOf(t);if(i>-1){var o=t.length;n=n.substr(0,i)+n.substr(i+o+1,n.length)}})):e(i).each((function(e,t){-1==n.indexOf(t)&&(n+=n.length?",":"",n+=t)})),r.ModeXml.DisableF=n}else alert("the grid have not Modes")},AddDisableF:function(e,t){this.ChangeDisableF(e,t,"Add")},RemDisableF:function(e,t){this.ChangeDisableF(e,t,"Remove")},RepDisableF:function(e,t){this.ChangeDisableF(e,t,"Replace")},ShowFirstRow:function(){},ShowLastRow:function(){var t=this;if(t.options.Responsive)e("div>div>div>div:last",t.$GridBody);else e("table>tbody>tr:last",t.$GridBody)},SaveScrollTop:function(){this.ScrollTop=this.$GridBody[0].scrollTop},LoadScrollTop:function(){var e=this.ScrollTop;void 0!==e&&(this.$GridBody[0].scrollTop=e)},HideDivToggle:function(){this.options;e("div[isdivtoggle]",this.$Footerview).hide()},_destroy:function(){var t=this,i=t.options;t.AppendTimeout2&&(np.noNg((()=>clearTimeout(t.AppendTimeout2))),t.AppendTimeout2=null),e.each(t._vm_subscriptions,(function(e,t){t.dispose()})),t._vm_subscriptions=[],t._vm.CalcWidth.dispose(),t._vm.CalcWidthWS.dispose(),t._vm.ColsNoHide.dispose(),t._vm.TrSortedOfTBody.dispose(),t._vm.CurrTrOfTBodyNew.dispose(),t._vm.printtedad.dispose(),i.ModeDlg&&(e(i.Modes.Dlg.Obj).is(":np-npUiDialog")?i.ModeDlg.npUiDialog("destroy"):i.ModeDlg.npDialog("destroy")),ko.cleanNode(t.$Container[0]),t.$Toolbar=[],t._vm.gonext=null,t._vm.goprev=null,t._vm.gofirst=null,t._vm.golast=null,t._vm.FullScreenClickFunc=null,t._vm.CloseFullScreenClickFunc=null,t._vm.AfterRender=null,t._vm.currPageData=null,delete t._vm,i.NoShowHeader||(t.$Header.remove(),t.$Headerview.remove(),t.$Footer.remove(),t.$Footerview.remove()),t.$GridBody.remove(),t.$Container.remove(),t.TFullNPGridScript.remove(),t.TBodyNPGridScript.remove(),t.THeadNPGridScript.remove(),t.TColsNPGridScript.remove()}})}(jQuery);
