var selfAntiUgly,ParamsAntiUgly,GlobViewModel={};NowPardaz=np={ng:!!window.NowPardaz_Ng,noNg:e=>e(),byNg:e=>e(),CmpSvcVar:{},ExtraDataCache:{},GrdColCaptionElem1:"<span class='text-Grdinfo'>",GrdColCaptionElem2:"</span>: ",GrdColCaptionClass:"text-Grdinfo",DomainUrl:"",tit:"",NPVars:{},CloseAllFaci:!0,DefaultMenuCmpId:11130,ExitMsg:!0,OPTOPT:"_OPT",ACDesc:"_desc",ACTip:"_tip",VMCmpXml:"_xml",VMCmpXmlUppercase:"_XML",JSFolder:"",tabTemplate:"<li id='#{liid}' title='#{label}' style='float:right'  ><a href='#{href}' class='nav-link' data-toggle='tab' style='box-sizing:content-box;max-width: "+parseInt($(window).width()/6)+"px; text-overflow: ellipsis; white-space: nowrap; overflow: hidden;'><i style='margin-left: 5px' class='glyphicon glyphicon-remove' ></i><i class='np-icon np-icon-loader'   style='display:none;margin-left: 5px;' ></i><span>#{label}</span></a></li>",P_IDIDID:"P_IDIDID",rtl:"undefined"!=typeof npIsLatin&&npIsLatin?"ltr":"rtl",npuuid:0,ValidChars:{Email:"~!~#$%&~~~*+~-./0123456789~~~=~?@ABCDEFGHIJKLMNOPQRSTUVWXYZ~~~^_~abcdefghijklmnopqrstuvwxyz{|}~",AlLatin:" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ABCDEFGHIJKLMNOPQRSTUVWXYZ~~~~~~abcdefghijklmnopqrstuvwxyz~~~~",AlFarsi:" ~~~~~~گ~~~~و~~~~~~~~~~~~~~ك~~~~~شذژيثبلآهتنمءدخحضقس،عرصطغظجپچ~~ژشذزيثبلاهتنمئدخحضقسفعرصطغظ~~~ّ",Al2Latin:" ~~~~%~~~~~~~~~~~~~~~~~~~~~~~~~~~ABCDEFGHIJKLMNOPQRSTUVWXYZ~~~~~~abcdefghijklmnopqrstuvwxyz~~~~",Al2Farsi:" ~~~~%~گ)(~~و~~~~~~~~~~~~~~ك~~~~~شذژيثبلآهتنمءدخحضقس،عرصطغظجپچ~~ژشذزيثبلاهتنمئدخحضقسفعرصطغظ~~~ّ",ANumFarsi:" ~~~~~~گ~~~~و~~~0123456789~ك~~~~~شذژيثبلآهتنمءدخحضقس،عرصطغظجپچ~~ژشذزيثبلاهتنمئدخحضقسفعرصطغظ~~~ّ",ANumLatin:" ~~~~~~~~~~~~~~~0123456789~~~~~~~ABCDEFGHIJKLMNOPQRSTUVWXYZ~~~~~~abcdefghijklmnopqrstuvwxyz~~~~",ANum2Farsi:" ~~~~%~گ)(~~و~~~0123456789~ك~~~~@شذژيثبلآهتنمءدخحضقس،عرصطغظجپچ~~ژشذزيثبلاهتنمئدخحضقسفعرصطغظ~~~ّ",ANum2Latin:" ~~~~%~~~~~~~~~~0123456789~~~~~~~ABCDEFGHIJKLMNOPQRSTUVWXYZ~~~~~~abcdefghijklmnopqrstuvwxyz~~~~",HtmFarsi:' !"#$%،گ)(×+و-./0123456789:ك،=.؟@شذژيثبلآهتنمءدخحضقس،عؤصطغظجپچ^_ژشذزيثبلاهتنمئدخحضقسفعرصطغظ<|>ّ'},IscalendarLoaded:0,FarsiNumbers:["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"]},SetJSFolder=function(){var e="";$("script[src]").each((function(t,n){var a=$(n).attr("src");if(e=a.substr(0,a.indexOf("forms.js")))return!1})),np.JSFolder=e}(),$(document).ready((function(){var e=$.fn.button.noConflict();$.fn.bootstrapBtn=e,$.fn.modal.Constructor.prototype.enforceFocus=function(){},$.fn.tooltip.Constructor.Default.trigger="hover";var t=!1;np.utils.ControlChangeLastModified(np.JSFolder+"forms.js",(function(e){var n=np.utils.NPLocalStorage(0,1,"FORMSJS");if(e||(t=!0),void 0===n?np.utils.NPLocalStorage(0,1,"FORMSJS",e):n&&n===e||(t=!0),t&&0!==np.JSFolder.indexOf("https:")){var a=[];return $("head>link[href]",document).each((function(e,t){a.push($(t).attr("href"))})),$("head>script[src]",document).each((function(e,t){a.push($(t).attr("src"))})),void function t(){if(!a.length)return np.utils.NPLocalStorage(0,1,"FORMSJS",e),void np.noNg((()=>setTimeout((function(){location.reload()}),2e3)));var n=a.pop();np.noNg((()=>$.ajax({url:n,cache:!0,async:!0,dataType:"text",beforeSend:function(e){$.browser.chrome||e.setRequestHeader("If-Modified-Since","Mon, 26 Jul 1997 05:00:00 GMT"),e.setRequestHeader("Cache-Control","no-cache")},success:function(e,t){},error:function(){}}).done((function(){t()}))))}()}}));$('<div np5ht7 id="LangShow" style="position:absolute;display:none;z-index:10000"><div class="ui-state-highlight">Fa</div></div>').prependTo("body"),GlobViewModel.LangShow=$("#LangShow"),GlobViewModel.vm_Time=function(e){},$("body").on("scroll",(function(){GlobViewModel.LangShow.hide()})),$("body").on("mouseenter",'[data-toggle="tooltip"]',(function(e){var t=e.currentTarget,n=$(t);t.offsetWidth>t.scrollWidth?n.removeAttr("title"):n.tooltip("show")}))})),np.fillCmpNames=function(e,t,n){var a=0!==t.indexOf("/frmc/")?n:n+"/"+n,i=0!==t.indexOf("/frmc/")?"controlchange":n+"/controlchange";e.CC_Filename=t+i+".htm",np.loc&&"fa"!==np.loc&&(t=t.replace("/frm/","/frmloc/"+np.loc+"/")),e.Js_FileName=t+a+".js",e.Html_FileName=t+a+".htm",e.Xml_FileName=t+a+".json",e.H_FileName=t+"usrhlp.json"},np.showRep=function(e){np.loadnpform($("#repViewer"),{CmpId:110015,AddrPath:"/frm/BAS0237_CMP_ViewReport/",FName:"BAS0237_CMP_ViewReport"},(t=>{setTimeout((()=>{var t=$.data($("#repViewer")[0])["np-BAS0237_CMP_ViewReport"];t.Resp=JSON.parse(e),t.ActNo="08",t.Get_Data(null,{MethodType:"1",ActNo:"08",ErLen:0,WarLen:0,UserLvl:"268435457",Usrfrm:"1"}),setTimeout((()=>{t.getHtml()}),2e3)}),2e3)}))},np.loadnpform=function(e,t,n){var a;function i(){var i=$(e).uniqueId(),o=i.prop("id"),r=np.utils.NPLocalStorage(a.CmpType,a.CmpId,"HTML");t.IsMakedFullId=!!r.match(np.P_IDIDID),t.IsMakedFullId&&(r=r.replace(new RegExp("#"+np.P_IDIDID+"#*","g"),o)),i.html(r),$("#"+o+"bod",i).css("height","inherit").css("overflow",""),$("#"+o+"dvfrmFooter",i).css({position:"sticky",bottom:"0px"}),$.NPCreateWidget(i,t.FName,t);var l=np.utils.GetWidgetSelf(i,t.FName);t.Itself=l,n&&n(l)}a={CmpId:t.CmpId,CmpType:t.CmpType||0},np.fillCmpNames(a,t.AddrPath,t.FName),a.CmpId&&a.Html_FileName?np.utils.NPLocalStorage(a.CmpType,a.CmpId,"HTML")?i():np.utils.GetComponent(a,i):alert("Wrong CmpId")},np.ManageNpCustom=function(e,t,n){switch($("npCustom",e).attr("type")){case"showpic":var a=(l=$("npCustom",e)).attr("param");a=JSON.parse(a);var i="";$.each(a.attr,(function(e,t){i+=e+"="+t+" "}));try{var o="<img "+i+" src='/frm/showpic/showpic.ashx?src="+a.src+"&a="+t._npform.GetAut()+"&t="+a.t+"&s="+a.s+"&C="+a.C+"&ttt"+parseInt(1e6*Math.random())+"="+Math.random()+"' />"}catch(e){var r=np.utils.GetWidgetSelf($(n.closest(".np-fitdivtoparent.tab-pane")));o="<img "+i+" src='/frm/showpic/showpic.ashx?src="+a.src+"&a="+r.GetAut()+"&t="+a.t+"&s="+a.s+"&C="+a.C+"&ttt"+parseInt(1e6*Math.random())+"="+Math.random()+"' />"}e=t?e.replace(/<\s*npCustom[^>]*>(.*?)<\s*\/\s*npCustom>/g,o):e.replace(/<\s*npcustom[^>]*>(.*?)<\s*\/\s*npcustom>/g,o);break;case"button":for(var l=$("npCustom",e),s=0;s<l.length;s++){a=$(l[s]).attr("param");var d=$(l[s]).attr("caption"),p="";p=void 0===(a=JSON.parse(a)).enable||"1"==a.enable?"<button class='btn btn-outline-primary' type='button' style='margin-left: 5px; margin-right: 5px;' click='"+a.onclick+"'>"+d+"</button>":"<button class='btn btn-outline-info np-npButton-disabled' disabled type='button' style='margin-left: 5px; margin-right: 5px;' click='"+a.onclick+"'>"+d+"</button>",e=e.replace(/<\s*npCustom[^>]*>(.*?)<\s*\/\s*npCustom>/m,p)}break;case"help":for(l=$("npCustom",e),s=0;s<l.length;s++){a=$(l[s]).attr("param");var c="<a class='np-icon-only' click='"+(a=JSON.parse(a)).onclick+"' style='cursor:pointer;padding-right:0px;'><svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='20' style='fill:#337ab7;vertical-align: middle;' height='20' viewBox='0 0 32 32'><path d='M11.772 20.164v2.871q0 0.251 0.162 0.413t0.413 0.162h2.871q0.251 0 0.413-0.162t0.162-0.413v-2.871q0-0.251-0.162-0.413t-0.413-0.162h-2.871q-0.251 0-0.413 0.162t-0.162 0.413zM7.178 11.264q0 0.897 0.269 1.615t0.816 1.238 0.933 0.79 1.068 0.646q0.574 0.323 0.834 0.502t0.467 0.431 0.206 0.52v0.574q0 0.251 0.162 0.413t0.413 0.162h2.871q0.251 0 0.413-0.162t0.162-0.413v-1.22q0-0.628-0.188-1.157t-0.431-0.852-0.7-0.637-0.736-0.458-0.799-0.377q-0.951-0.449-1.346-0.772t-0.395-0.879q0-0.754 0.781-1.283t1.714-0.529q1.005 0 1.705 0.485 0.52 0.359 1.436 1.489 0.162 0.215 0.449 0.215 0.197 0 0.341-0.108l1.938-1.471q0.18-0.126 0.215-0.359t-0.090-0.413q-2.189-3.445-6.263-3.445-2.315 0-4.28 1.606t-1.965 3.849zM13.781 3.225q2.333 0 4.459 0.915t3.661 2.449 2.449 3.661 0.915 4.459-0.915 4.459-2.449 3.661-3.661 2.449-4.459 0.915-4.459-0.915-3.661-2.449-2.449-3.661-0.915-4.459 0.915-4.459 2.449-3.661 3.661-2.449 4.459-0.915zM0 14.709q0 3.75 1.848 6.918t5.016 5.015 6.918 1.848 6.918-1.848 5.015-5.015 1.848-6.918-1.848-6.918-5.015-5.016-6.918-1.848-6.918 1.848-5.016 5.016-1.848 6.918z'></path></svg></a>";e=e.replace(/<\s*npCustom[^>]*>(.*?)<\s*\/\s*npCustom>/m,c)}}return e},np.npUniqueId=function(){return"np-id-"+ ++np.npuuid},np.NPPkgs={epay:{js:[{f:np.JSFolder+"epay.js"}],css:[]},charts:{js:[{f:np.JSFolder+"Chart.bundle.js"},{f:np.JSFolder+"Chart.utils.js"},{f:"/pkg/highchart/highcharts.js"},{f:"/pkg/highchart/highstock.js"},{f:"/pkg/highchart/highcharts-3d.js"},{f:"/pkg/highchart/full-screen.js"},{f:"/pkg/highchart/exporting.js"},{f:"/pkg/highchart/export-data.js"},{f:"/pkg/highchart/modules/drilldown.src.js"},{f:"/pkg/highchart/npHighcharts.js"}],css:[]},npmenudrag:{js:[{f:np.JSFolder+"npmenu.js"},{f:np.JSFolder+"npmenudrag.js"}],css:[]},npmenuTemp:{js:[{f:np.JSFolder+"npmenuTemp.js"}],css:[]},npmenu:{js:[{f:np.JSFolder+"npmenu.js"},{f:np.JSFolder+"npmenuMobile.js"},{f:np.JSFolder+"npmenuicon.js"}],css:[]},npviewer:{js:[{f:np.JSFolder+"npviewer.js"}],css:[]},autocomplete:{js:[{f:np.JSFolder+"autocomplete.js"}],css:[]},calendar:{js:[{f:np.JSFolder+"jqui.date.js"},{f:np.JSFolder+"jqui.date.persianDatepicker.js"},{f:np.JSFolder+"jqui.date-fa.js"}],css:[]},cleditor:{js:[{f:"/pkg/cleditor/jquery.cleditor.js"}],css:[{f:"/pkg/cleditor/jquery.cleditor.css"}]},dynatree:{js:[{f:"/pkg/dynatree/jquery.dynatree.js"},{f:"/pkg/dynatree/contextMenu/jquery.contextMenu-custom.js"}],css:[{f:"/pkg/dynatree/skin/ui.dynatree.css"},{f:"/pkg/dynatree/contextMenu/jquery.contextMenu.css"}]},codemirror:{js:[{f:"/pkg/codemirror/lib/codemirror.js"},{f:"/pkg/codemirror/mode/xml/xml.js"},{f:"/pkg/codemirror/addon/dialog/dialog.js"},{f:"/pkg/codemirror/addon/search/searchcursor.js"},{f:"/pkg/codemirror/addon/search/search.js"},{f:"/pkg/codemirror/addon/scroll/annotatescrollbar.js"},{f:"/pkg/codemirror/addon/search/matchesonscrollbar.js"},{f:"/pkg/codemirror/addon/fold/foldcode.js"},{f:"/pkg/codemirror/addon/fold/foldgutter.js"},{f:"/pkg/codemirror/addon/fold/brace-fold.js"},{f:"/pkg/codemirror/addon/fold/xml-fold.js"},{f:"/pkg/codemirror/addon/fold/markdown-fold.js"},{f:"/pkg/codemirror/addon/fold/comment-fold.js"},{f:"/pkg/codemirror/mode/markdown/markdown.js"},{f:"/pkg/codemirror/addon/hint/show-hint.js"},{f:"/pkg/codemirror/addon/hint/javascript-hint.js"},{f:"/pkg/codemirror/addon/hint/sql-hint.js"},{f:"/pkg/codemirror/mode/javascript/javascript.js"},{f:"/pkg/codemirror/mode/css/css.js"},{f:"/pkg/codemirror/mode/vb/vb.js"},{f:"/pkg/codemirror/mode/htmlmixed/htmlmixed.js"},{f:"/pkg/codemirror/mode/sql/sql.js"},{f:"/pkg/codemirror/formatting.js"},{f:"/pkg/codemirror/addon/fullscreen/fullscreen.js"}],css:[{f:"/pkg/codemirror/lib/codemirror.css"},{f:"/css/npcodemirror.css"},{f:"/pkg/codemirror/addon/dialog/dialog.css"},{f:"/pkg/codemirror/addon/search/matchesonscrollbar.css"},{f:"/pkg/codemirror/addon/fold/foldgutter.css"},{f:"/pkg/codemirror/addon/hint/show-hint.css"}]}},np.utils=function(){var SetDefaultExpr=new RegExp("#P_[^#]+#","g"),NPResponseCache={},NPComponentsHtml={},NPComponentsXml={},NPComponentsHelp={},NPComponentsJsCode={},NPComponentsJsRun={},NPComponentState={};function replaceZone(e){return e=e||""}return{SetDefaultExpr:SetDefaultExpr,NPClearLocalStorage:function(){NPResponseCache={},NPComponentsHtml={},NPComponentsXml={},NPComponentsHelp={},NPComponentsJsCode={},NPComponentsJsRun={},NPComponentState={}},eval:function(x){return eval(replaceZone(x))},globalEval:function(e){$.globalEval(replaceZone(e))},ResponseCache:function(e,t){return t&&(NPResponseCache[e]=t),NPResponseCache[e]},GetNPComponentState:function(){return NPComponentState},NPLocalStorage:function(e,t,n,a){if(!1,t="0_"+t,"HTML"!=n&&"XML"!=n&&"JS"!=n&&"H"!=n)return a&&(localStorage[n+"_"+t]=a),localStorage[n+"_"+t];switch(n){case"HTML":if(""===a)NPComponentsHtml[t]=a;else if(a){var i=a.substring(a.indexOf("<body"),a.indexOf("</body>"))||"";i=i.substring(i.indexOf(">")+1,i.length)||"",NPComponentsHtml[t]=i}return NPComponentsHtml[t];case"XML":return a&&(NPComponentsXml[t]=a),NPComponentsXml[t];case"H":return a&&(NPComponentsHelp[t]=a),NPComponentsHelp[t]}},escapeXml:function(e){return e.replace(/[<>&'"]/g,(function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}}))},unescapeXml:function(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},GetWidgetSelf:function(e,t){return t||(t=e.data("NPWidget")),t?e[t]("instance"):null},ControlChangeLastModified:function(e,t){var n;window.XMLHttpRequest&&(n=new XMLHttpRequest),n.open("HEAD",e+"?t="+Math.random(),!0);var a=!0;n.onreadystatechange=function(){4===n.readyState&&a&&(a=!1,200===n.status?t(n.getResponseHeader("Last-Modified"),n.getResponseHeader("ETag")):t(!1))},np.noNg((()=>n.send()))},StandardHtml:function(e){var t={flag:"",Str:""};return null==e.match(/(<[^>]*\son\w*=[^>]*>)|(<[^>]*\w*=\W\s*javascript\s*:[^>]*>)|(<\s*\/?\s*(script|source|embed|body|head|html|iframe|audio|object|frameset|meta)\s*.*?>)/gi)?(t.Str=e,t.flag=!0):(t.flag=!1,t.Str=$("<A>"+e+"</A>").text()),t},NPTrim:function(e){return null==e||null==e?"":"object"==typeof e?e:e.toString().replace(/(^\s*)|(\s*$)/g,"")},GetComponent:function(e,t){var n,a,i,o,r=e.CmpId,l=e.CmpType,s=e.H_FileName,d={CmpId:r,status:!0,description:""};if(!e||!((n=e.Js_FileName)&&(a=e.Html_FileName)&&(i=e.Xml_FileName)&&(o=e.CC_Filename)))return d.status=!1,d.description="no valid component",void t.call(this,d);var p=np.utils.GetNPComponentState()[r]=np.utils.GetNPComponentState()[r]||{};if(p.Loaded)return d.description="This Cmp is Loaded Before",void setTimeout((function(){t.call(this,d)}),0);p.CallBacks?p.CallBacks.push(t):(p.CallBacks=[],p.CallBacks.push(t),np.utils.ControlChangeLastModified(o,(function(e,t){var c=np.utils.NPLocalStorage(l,r,"CC"),u=!1;c&&c===e||(u=!0,c="Mon, 26 Jul 1997 05:00:00 GMT");var m,f,h,g,C,v=0;if(!1===e)return np.utils.NPLocalStorage(l,r,"HTML",""),np.utils.NPLocalStorage(l,r,"XML",""),np.utils.NPLocalStorage(l,r,"CC",Math.random()),p.Loaded=!1,d.status=!1,d.description="error in get:"+o,$.each(p.CallBacks,(function(e,t){t.call(this,d)})),void delete p.CallBacks;var b=3;function _(){if(++v<b);else{if(!f||!h||!m)return d.status=!1,$.each(p.CallBacks,(function(e,t){t.call(this,d)})),void delete p.CallBacks;np.utils.NPLocalStorage(l,r,"HTML",f),np.utils.NPLocalStorage(l,r,"XML",h),np.utils.NPLocalStorage(l,r,"H",g),np.utils.globalEval(m),np.utils.NPLocalStorage(l,r,"CC",e),p.Loaded=!0,d.description="success in get:"+n+","+a,$.each(p.CallBacks,(function(e,t){t.call(this,d)}))}}C={cache:!0,async:!0,dataType:"text",beforeSend:function(e){var t;t=e,u&&($.browser.chrome||t.setRequestHeader("If-Modified-Since",c),t.setRequestHeader("Cache-Control","no-cache"))},error:function(){_()},success:function(e){this.url==i&&(h=e),this.url==a&&(f=e),this.url==n&&(m=e),this.url==s&&(g=e),_()}},s&&(b++,C.url=s,np.noNg((()=>$.ajax(C)))),C.url=i,np.noNg((()=>$.ajax(C))),C.url=a,np.noNg((()=>$.ajax(C))),C.url=n,np.noNg((()=>$.ajax(C)))})))},GetScrollbarWidth:function(e){if(void 0===np.NPVars.ScrollbarWidth||e){var t=$("<div />").css({width:100,height:100,overflow:"scroll",position:"absolute",top:-200,left:-200}).append($("<div />").css({width:200,height:200})).appendTo("body");np.NPVars.ScrollbarWidth=t[0].offsetWidth-t[0].clientWidth,t.remove()}return np.NPVars.ScrollbarWidth},NPChangeNumToFarsi:function(e){try{e=e.toString()}catch(e){}var t,n=e.length;for(t=0;t<n;t++){var a=e.charCodeAt(t);a>47&&a<58&&(e=e.substr(0,t)+String.fromCharCode(a+1776-48)+e.substr(t+1))}return e},NPChangeNumToLatin:function(e){return e},NPChangeNumToUnicode:function(e){return e}}}(),function($,np){$.widget("np.nptinybutton",{options:{icon:"edit",title:null,attr:null},_create:function(){var e=this.options,t=this.element;e.title||(e.title="edit"==e.icon?"اصلاح":"delete"==e.icon?"حذف":"view"==e.icon?"نمايش":"help"==e.icon?"راهنما":"send"==e.icon?"ارسال":"confirm"==e.icon?"تاييد":"confsend"==e.icon?"تایید و ارسال":"detail"==e.icon?"جزييات":"viewflow"==e.icon?"مشاهده گردش کار":"cancel"==e.icon?"لغو درخواست":"viewflowA"==e.icon?"مشاهده گردش کار اتوماسيون":"-"),t.html("&nbsp;").attr("title",e.title).attr("np-icon",e.icon).addClass("np-tinyicon np-tinyicon-"+e.icon),e.attr&&$.each(e.attr,(function(e,n){t.attr(e,n)}))},cont:function(){this.options;return this.element.OuterHTML()},_destroy:function(){$(this.element).removeClass("np-tinyicon np-tinyicon-"+this.options.icon).removeAttr("np-icon").removeAttr("title")}}),$.widget("np.SimpleDialog",{options:{show:!1,appendTo:null,class:"col-lg-9 col-12",beforeClose:null,close:null,onShow:null,closeButton:!0,title:"",destroyOnClose:!1,parShowElem:[]},_create:function(){var e=this,t=e.options,n=e.element;t.appendTo||(t.appendTo=$("body")),e.htmlOrBody=$("html");var a=e.ol=$("<div class='flex-grow-1 w-100 np-d-none d-flex flex-column align-items-center'/>").prependTo(t.appendTo);e.uid=a.uniqueId().attr("id");var i=e.wr=$("<div class='np-SimpleDialog flex-grow-1 d-flex flex-column "+t.class+"'/>").appendTo(a);t.closeButton&&(e.$titwr=$('<div class="d-flex"/>'),e.$Backbtndv=$('<button class="btn btn-outline-info" style="border:0"><svg version="1.1" xmlns="http://www.w3.org/2000/svg"   xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 170 150" xml:space="preserve">   <path style="fill:#2b5989;stroke-width:0.35660052;fill-opacity:1" inkscape:connector-curvature="0" d="m 0.39537578,80.46493 a 80.235119,80.235119 0 1 0 160.47023422,0 80.235119,80.235119 0 1 0 -160.47023422,0" ></path>   <path  d="m 6.8704361,80.46493 a 73.760058,73.760058 0 1 0 147.5201139,0 73.760058,73.760058 0 1 0 -147.5201139,0" inkscape:connector-curvature="0" style="fill:#ffffff;stroke-width:0.32782248"></path>   <path style="fill:#2b5989;stroke-width:0.11146249;fill-opacity:1" inkscape:connector-curvature="0" d="m 27.181084,87.0289 h 81.175586 l -37.415216,37.53242 9.689032,9.35302 53.449414,-53.4494 -53.449414,-53.44941 -9.352702,9.35333 37.078886,37.4149 H 27.181084 v 13.36235 z" ></path></svg></button>').on("click",(function(){e.close()})).wrap("<div />").parent(),e.$titwr.append(e.$Backbtndv),e.$title=$("<div></div>").html(t.title||"").addClass("pr-2").appendTo(e.$titwr),i.append(e.$titwr)),e.saveCSS={style:n.attr("style"),class:n.attr("class")},n.addClass("d-flex flex-column flex-grow-1"),e.saveParent=n.wrap("<div/>").parent(),i.append(n),t.show?e.show():e.hide()},open:function(e){this.show(e)},show:function(e){var t=this,n=t.options;t._isOpen||(t.saveScroll={top:t.htmlOrBody.scrollTop(),left:t.htmlOrBody.scrollLeft()},t._isOpen=!0,t.ol.removeClass("np-d-none"),t.$childstate=[],n.appendTo.children().each((function(e,a){var i=$(a).attr("orgid"),o=$(a).attr("id"),r=[];n.parShowElem&&n.parShowElem.includes(i)||o==t.uid||($(a).hasClass("d-none")&&r.push("d-none"),$(a).hasClass("np-d-none")&&r.push("np-d-none"),$(a).addClass("np-d-none")),t.$childstate.push(r)})),t._trigger("onShow",e),t.htmlOrBody[0].scrollTop=0)},hide:function(){var e=this,t=e.options;e._isOpen&&(e._isOpen=!1,e.ol.addClass("np-d-none"),t.appendTo.children().each((function(n,a){var i=$(a).attr("orgid"),o=$(a).attr("id");t.parShowElem&&t.parShowElem.includes(i)||o==e.uid||($(a).removeClass("np-d-none"),$(e.$childstate[n]).each((function(e,t){$(a).addClass(t)})))})),e.htmlOrBody[0].scrollTop=e.saveScroll.top)},close:function(e){var t=this,n=t.options;!1!==t._trigger("beforeClose",e)&&($(".tooltip","body").remove(),t.hide(),t._trigger("close",e),n.destroyOnClose&&t.destroy())},_setOption:function(e,t){this._super(e,t),"title"===e&&this.$title&&this.$title.html(t)},_destroy:function(e,t){var n=this,a=(n.options,n.element);n.hide(),a.find("iframe").prop("src","../blank.htm").remove(),a.attr("style",n.saveCSS.style),a.attr("class",n.saveCSS.class),a.appendTo(n.saveParent).unwrap(),n.ol.remove()}}),$.widget("np.npUiDialog",$.ui.dialog,{options:{dialogClass:"np-npDialog",MobilityWeight:5,closeText:"بستن",draggable:!1,StopDraggable:!1,parentModal:null,IsEditor:!1,width:"auto",height:"auto",resizable:!1,CloseParentModal:!0,ParentIsDialog:!1,Top:null,contentMarginBottom:0,title:null,Class:null,position:{my:"center",at:"center",of:window},IsMessage:!1,OverlayClickEvent:!1,maxHeight:null,npDialog:null,CloseIcon:null,ClosePosition:"right",overflowX:"hidden",overflowY:"auto",npform:null,appendTo:"body"},_createTitlebar:function(){this._super(),this.uiDialogTitlebarClose.html('<i class="glyphicon glyphicon-remove text-danger" style="font-size:16px;padding-left:10px;vertical-align: top;margin-right:10px"></i>')},_create:function(){var e,t=this,n=t.options;(n.OverlayClickEvent||(n.OverlayClickEvent=n.closeOnEscape),n.IsHelp||n.Class||n.size)||(n.Class=n.Class?n.Class:"col-lg-8 col-12",n.width=n.width&&"auto"!=n.width?n.width:"auto","auto"!=n.width?e=isNaN(n.width)?n.width.split("px")[0]:n.width+"":n.Class="col-lg-11 col-12",e&&t.ConvertWidthToClass(e));(n.size&&("lg"==n.size&&(n.Class="col-lg-7 col-12"),"md"==n.size&&(n.Class="col-lg-4 col-12"),"sm"==n.size&&(n.Class="col-lg-3 col-12")),n.IsHelp&&!isNaN(n.width)&&(n.width+=12),this.options.appendTo&&this.options.position.of==window&&(this.options.position.of=this.options.appendTo,delete this.options.position.collision),this._super(),n.Class)&&($(t.element).parent().addClass("row").addClass(n.Class).css("padding","0px"),n.width="none");this.uiDialogTitlebarClose.removeAttr("class").css({width:"32px"}).addClass("close"),"left"==n.ClosePosition&&$(this.uiDialogTitlebar).prepend(this.uiDialogTitlebarClose),n.CloseIcon&&$("i",this.uiDialogTitlebar).removeClass("glyphicon-remove").addClass(n.CloseIcon),this.fixTitle(),$(this.uiDialogTitlebar).css({display:"flex","flex-direction":"row-reverse"}),this.uiDialogTitlebar.next("div").removeClass("ui-widget-content"),t._on({"mousedown button.close":function(){return!1}}),$(window).width()<=768&&(this.options.StopDraggable=!0),!this.options.StopDraggable&&this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",start:function(e,t){t.helper.removeClass("np-ui-dialog-top")},stop:function(e,t){var n=$(window).width(),a=$(window).height();t.helper.position().top<0&&t.helper.css("top","50px"),t.helper.position().left>n-50&&t.helper.css("left",n-50+"px"),t.helper.position().left<50-t.helper.width()&&t.helper.css("left",50-t.helper.width()+"px"),t.helper.position().top>a-200&&t.helper.css("top",a-200+"px")}}),$(this.element).parent().addClass("np-ui-dialog-position").on("click",(function(e){$(e.target).is("i.glyphicon-remove")||t.SetZIndex($(t.element).parent())}))},fixTitle:function(){var e=this,t=(e.options,$(".ui-dialog-title",e.uiDialogTitlebar).text());$(".ui-dialog-title",e.uiDialogTitlebar).html(t).addClass("text-danger").css({width:"calc(100% - 32px)"})},_setOption:function(e,t){(this._super(e,t),"title"===e&&this.uiDialogTitlebar.find(".ui-dialog-title").attr("np-title",t),"contentMarginBottom"===e&&this.element.css("margin-bottom",t),"disabled"===e&&$(this.element).prop("disabled",t),"label"===e&&t&&$(this.element).text(t),"height"===e&&(this.options.height="auto"),"width"===e)&&(this.ConvertWidthToClass(t),this.options.Class&&($(this.element).parent().addClass("row").addClass(this.options.Class).css("padding-right","0px"),this.options.width="none"));if("type"===e)switch($(this.element).attr("class",""),t){case"default":case"info":$(this.element).addClass("btn btn-outline-info");break;case"success":$(this.element).addClass("btn btn-outline-success");break;case"warning":$(this.element).addClass("btn btn-outline-warning");break;case"danger":$(this.element).addClass("btn btn-outline-danger")}},ConvertWidthToClass:function(e){var t=this.options;$(this.element).parent().removeClass((function(e,t){return(t.match(/\S*col-\S+/g)||[]).join(" ")})),(e=isNaN(e)?e.split("px")[0]:e+"")<=300&&(t.Class="col-lg-3 col-12"),300<e&&e<=400&&(t.Class="col-lg-4 col-12"),400<e&&e<=500&&(t.Class="col-lg-5 col-12"),500<e&&e<=600&&(t.Class="col-lg-6 col-12"),600<e&&e<=700&&(t.Class="col-lg-7 col-12"),700<e&&e<=800&&(t.Class="col-lg-8 col-12"),800<e&&e<=1e3&&(t.Class="col-lg-9 col-12"),1e3<e&&e<=1200&&(t.Class="col-lg-10 col-12"),e>=1200&&(t.Class="col-lg-12 col-12"),-1!=e.indexOf("%")&&((e=e.split("%")[0])<=50&&(t.Class="col-lg-6 col-12"),e>50&&e<70&&(t.Class="col-lg-8 col-12"),e>=70&&e<90&&(t.Class="col-lg-10 col-12"),e>=90&&(t.Class="col-lg-11 col-12"))},_moveToTop:function(e,t){return!!this.options.IsHelp&&this._super.apply(this,arguments)},open:function(e,t,n){var a=this,i=this.options,o=$(".scrollable-container");i.modal&&($("body").addClass("modal-open"),o&&o.length>0&&o.addClass("modal-open")),(!isNaN(i.width)&&i.width>$(window).width()||!isNaN(i.height)&&i.height>$(window).height())&&(i.width="95%",i.height=$(window).height()-100);var r=$(i.appendTo).attr("id")?i.appendTo.attr("id"):i.appendTo,l=$(".modal.show[parent="+r+"]",this.options.appendTo);this.options.IsEditor?this.options.parentModal.modal("hide"):this.options.CloseParentModal&&!i.IsHelp&&l.modal("hide"),this.SetZIndex($(this.element).parent(),"All"),$(this.element).parent().addClass("np-ui-dialog-top"),this._super(),(i.IsHelp||i.npDialog)&&(a.element.parent().css({"max-height":"80%","overflow-y":"auto"}),a.element.css({"max-height":"100%","overflow-y":i.overflowY,"overflow-x":i.overflowX})),i.maxHeight&&a.element.parent().css({"max-height":i.maxHeight+"px","overflow-y":"auto"}),$(".tooltip","body").remove(),np.noNg((()=>setTimeout((function(){i.modal&&($("#ScrollTop_Btn").fadeOut(),$("#ScrollBottom_Btn").fadeOut()),a.offScreen(a.element.parent()[0])&&a.element.parent().animate({top:parseInt(a.element.parent().css("top"))-250+"px"},500),i.IsMessage&&a.element.css("height","auto")}),0))),$(".ui-widget-overlay").css("top",0),i.OverlayClickEvent&&$(".ui-widget-overlay").click((function(){a.close()}))},offScreen:function(e){var t=e.getBoundingClientRect(),n=!1;return t.top-250>60&&t.height+t.top>$(document).height()&&(n=!0),n},SetZIndex:function(e,t){e=e||$(this.element).parent();if("All"==t)var n=$(".modal.show ,.ui-dialog:visible,.ui-widget-overlay,nb-layout-header").map((function(){var e=+$(this).css("z-index");return isNaN(e)?0:e})).get();else n=$(".modal.show,.ui-widget-overlay,nb-layout-header").map((function(){var e=+$(this).css("z-index");return isNaN(e)?0:e})).get();(n=Math.max.apply(null,n)||1)<0||(n+=1,$(e).css("z-index",n))},close:function(e,t,n){var a=this.options;$(".tooltip","body").remove(),$(this.element).find("iframe").prop("src","../blank.htm").remove(),this._super(),!a.modal||n||this.appendTo&&$(".ui-widget-overlay",this.appendTo).length>0||($("body").removeClass("modal-open"),$(".scrollable-container").removeClass("modal-open"))},destroy:function(e,t){this._super()}}),$.widget("np.npDialog",$.np.npUiDialog,{options:{Class:null,minWidth:null,maxHeight:null,size:null,npDialog:1},_create:function(){this.options.height="auto",this.options.minWidth&&(this.options.width=this.options.minWidth),this._super(),$(this.uiDialog).css("padding","1rem")},show:function(e){e?this.open():this.close()},hide:function(e,t){this.close()},setTit:function(e){this._setOption("title",e)},setWidth:function(e){this._setOption("width",e.toString())},setHeight:function(e){},appendChild:function(e,t){var n=this.element;$(n).append(t.$np("#"+e))},SetButtons:function(e){var t=this,n=(t.options,$(t.element),$("<div style='margin:10px'/>"));$(t.element).append(n),$.each(e,(function(e,t){var a=$("<button class='btn btn-outline-info' style='margin-left:5px;text-align: center;'   >"+t.text+"</button>");a.appendTo(n),a.on("click",t.click)}))}}),$.widget("np.npButton",$.ui.button,{options:{type:"default",marginLeft:"5px",marginRight:"5px"},_create:function(){var e=this.options,t=this.element,n=e.icons?e.icons.secondary||e.icons.primary:null;if(n&&t.is("button")){var a=$('<i style="padding-left:5px;padding-right:5px" ></i>');""==t.text()&&$(t).css("padding","0px 6px"),"<svg"==n.substr(0,4)?(a.html(n),$(t).css("padding","1px")):a.addClass("ui-icon").addClass(n),e.icons.secondary?$(t).prepend($(a)):$(t).append($(a))}switch(t.attr("title",e.tip),t.css({"margin-left":t[0].style.marginLeft?t[0].style.marginLeft:e.marginLeft,"margin-right":t[0].style.marginRight?t[0].style.marginRight:e.marginRight,"margin-bottom":t[0].style.marginBottom?t[0].style.marginBottom:e.marginBottom,"margin-top":t[0].style.marginTop?t[0].style.marginTop:e.marginTop}),t.addClass("btn").attr("type","button"),e.type){case"default":case"info":t.removeClass("btn-info").addClass("btn-outline-info");break;case"success":t.removeClass("btn-success").addClass("btn-outline-success");break;case"warning":t.removeClass("btn-warning").addClass("btn-outline-warning");break;case"danger":t.removeClass("btn-danger").addClass("btn-outline-danger")}},_updateIcon:function(e,t){var n="iconPosition"!==e,a=n?this.options.iconPosition:t;this.icon?n&&this._removeClass(this.icon,null,this.options.icon):(this.icon=$("<i style='padding-left:5px;padding-right:5px'>"),this._addClass(this.icon,"ui-icon")),n&&this._addClass(this.icon,null,t),this._attachIcon(a)},_setOption:function(e,t){if(this._super(e,t),"disabled"===e&&$(this.element).prop("disabled",t),"label"===e&&t&&$(this.element).text(t),"icon"===e&&t&&this._updateIcon("icon",t),"type"===e)switch($(this.element).attr("class",""),t){case"default":case"info":$(this.element).addClass("btn btn-outline-info");break;case"success":$(this.element).addClass("btn btn-outline-success");break;case"warning":$(this.element).addClass("btn btn-outline-warning");break;case"danger":$(this.element).addClass("btn btn-outline-danger")}},_destroy:function(){var e=this;e.options,e.element;e._super()}}),$.widget("np.ContextMenu",{options:{list:[{name:"ایجاد",act:"26",icon:"fa-plus"},{name:"اصلاح",act:"27",icon:"fa-edit"},{name:"حذف",act:"28",icon:"glyphicon-remove"}],grid:!1},_create:function(){var e=this,t=e.options,n=e.element,a=$('<ul class="dropdown-menu pull-right" style="text-align: right;font-size:12px"  ></ul>');$.each(t.list,(function(e,t){a.append('<li><a href="#" act='+t.act+'><i class="fa '+t.icon+'"></i><span style="padding-right:10px">'+t.name+"</span></a></li>")})),t.grid?($(n).addClass("dropdown"),$("div",n).attr("data-toggle","dropdown"),$(n).append(a),e.dropdown=$(n)):(e.dropdown=$(n).wrap('<div class="dropdown" ></div>'),$(n).attr("data-toggle","dropdown").after(a)),e.dropdown.on("show.bs.dropdown",(function(e){})),$("a",a).on("click",(function(e){alert("DoAct:"+$(this).attr("act"))}))}}),ko.bindingHandlers.UniHtml={init:function(e,t,n,a){return{controlsDescendantBindings:!0}},update:function(element,valueAccessor,allBindingsAccessor,viewModel){var value=ko.unwrap(valueAccessor())||"",HasCustomTag=0,patt=new RegExp("<npCustom");patt.test(value)&&(HasCustomTag=!0,value=np.ManageNpCustom(value,viewModel,element));try{value=value&&np.utils.NPChangeNumToUnicode(value)}catch(e){}var id=$(element).attr("orgid"),ShowTag=id&&viewModel._npform&&viewModel._npform.W_.FrmFld[id]&&"1"==viewModel._npform.W_.FrmFld[id].Valid.ShowTag;allBindingsAccessor()&&allBindingsAccessor().ShowTag&&(ShowTag=parseInt(allBindingsAccessor()&&allBindingsAccessor().ShowTag)),ShowTag&&(value=np.utils.escapeXml(value));var NoCheckHtml=id&&viewModel._npform&&viewModel._npform.W_.FrmFld[id]&&"1"==viewModel._npform.W_.FrmFld[id].Valid.NoCheckHtml;if(NoCheckHtml=NoCheckHtml||allBindingsAccessor()&&allBindingsAccessor().NoCheckHtml,NoCheckHtml||ShowTag)ko.utils.setHtml(element,value);else{var Result=np.utils.StandardHtml(value);Result.flag?ko.utils.setHtml(element,value):ko.utils.setHtml(element,Result.Str)}if(HasCustomTag){var clickHandler=function(){var elem=event.currentTarget,self=viewModel._npform;eval($(elem).attr("click"))};ko.utils.registerEventHandler($("a,button",element),"click",clickHandler)}}},ko.bindingHandlers.GridUniHtml={init:function(e,t,n,a){return{controlsDescendantBindings:!0}},update:function(e,t,n,a){var i=ko.unwrap(t())||"";try{i=i&&np.utils.NPChangeNumToUnicode(i)}catch(e){}if("1"==(n().ShowTagGrid||"0")){var o=i.indexOf(np.GrdColCaptionElem2);i=0==i.indexOf(np.GrdColCaptionElem1)&&o>0?i.substr(0,o+np.GrdColCaptionElem2.length-1)+np.utils.escapeXml(i.substr(o+np.GrdColCaptionElem2.length-1)):np.utils.escapeXml(i),ko.utils.setHtml(e,i)}else{var r=np.utils.StandardHtml(i);r.flag?ko.utils.setHtml(e,i):ko.utils.setHtml(e,r.Str)}}},ko.bindingHandlers.UniText={init:function(e,t,n,a){return{controlsDescendantBindings:!0}},update:function(e,t,n,a){var i=ko.unwrap(t())||"";try{i=i&&np.utils.NPChangeNumToUnicode(i)}catch(e){}ko.utils.setTextContent(e,i)}},ko.bindingHandlers.fadeInText={update:function(e,t){$(e).hide(),ko.bindingHandlers.text.update(e,t),$(e).fadeIn("slow")}},ko.virtualElements.allowedBindings.UniText=!0,ko.bindingHandlers.FadeVisible={update:function(e,t,n,a,i){var o=ko.utils.unwrapObservable(t());void 0===o?$(e).hide():o?$(e).show("blind",300,(function(){i.$root._npform.ShapeFrm()})):$(e).hide("blind",300,(function(){i.$root._npform.ShapeFrm()}))}},ko.bindingHandlers.FadeVisibility={update:function(e,t,n,a,i){var o=ko.utils.unwrapObservable(t());console.log(o),void 0===o?$(e).css("visibility","hidden"):o?$(e).animate({opacity:100},300,(function(){i.$root._npform.ShapeFrm()})):$(e).animate({opacity:0},300,(function(){i.$root._npform.ShapeFrm()}))}},ko.bindingHandlers.BindingCmp={init:function(e,t,n,a){var i=n.get("Desc"),o=n.get("Tip"),r=n.get("CmpId"),l=a._npform.W_.FrmFld[r].WidgetSelf;return l.options.SelValChanged=function(e,n){var i=l.GetValOfCmp();t()()!=i&&a._npform.Val(r,i)},l.options.TxtValChanged=function(e,t){var n=l.GetTxtOfCmp();i()!=n&&a._npform.Val(r+np.ACDesc,n)},l.options.TipValChanged=function(e,t){var n=l.GetTipOfCmp();o()!=n&&a._npform.Val(r+np.ACTip,n)},$(e).focus((function(){$("input:first",e).focus()})),{controlsDescendantBindings:!0}},update:function(e,t,n,a){var i=ko.utils.unwrapObservable(t()),o=ko.utils.unwrapObservable(n.get("Desc")),r=ko.utils.unwrapObservable(n.get("Tip")),l=n.get("CmpId"),s=a._npform.W_.FrmFld[l],d=s.WidgetSelf;"MS"!=s.Type2&&(d.SetTxtOfCmp(o),d.SetTipOfCmp(r),d.SetValOfCmp(i))}},ko.bindingHandlers.StopBindings={init:function(){return{controlsDescendantBindings:!0}}},ko.bindingHandlers.bdoValue={init:function(e,t,n){var a=function(){t()(e.innerHTML)};ko.utils.registerEventHandler(e,"keyup",a),ko.utils.registerEventHandler(e,"input",a)},update:function(e,t){var n=ko.utils.unwrapObservable(t())||"";n!==e.innerHTML&&(e.innerHTML=n)}},ko.bindingHandlers.npEditorValue={after:["options","foreach"],init:function(e,t,n,a){var i=$(e),o=i.attr("minimize")?i.attr("minimize"):"0",r=!(!i.attr("HideIcon")||"true"!=i.attr("HideIcon")),l=i.attr("title");i.npeditor({npform:a._npform,Minimize:o,HideIcon:r,title:l,change:function(e,n){var a=t(),i=""==$("<div>"+n.Val+"</div>").text()?"":n.Val;a.peek()!==i&&a(i)}}),ko.utils.domNodeDisposal.addDisposeCallback(e,(function(){i.npeditor("destroy")}))},update:function(e,t){var n=$(e),a=ko.utils.unwrapObservable(t()),i=n.npeditor("Val");if(a!==i){n.npeditor("Val",a)}}},ko.bindingHandlers.HtmValue={after:["options","foreach"],init:function(e,t,n){var a=$(e);a.cleditor({width:$(e).width(),height:$(e).height()}).change((function(){var n=t(),a=ko.selectExtensions.readValue(e);n.peek()!==a&&n(a)})),ko.utils.domNodeDisposal.addDisposeCallback(e,(function(){$.data(a[0],"cleditor").destroy()}))},update:function(e,t){var n=ko.utils.unwrapObservable(t()),a=ko.selectExtensions.readValue(e);if(n!==a){ko.selectExtensions.writeValue(e,n),$.data(e,"cleditor").updateFrame($.data(e,"cleditor"))}}},ko.bindingHandlers.npcb={after:["value","attr"],init:function(e,t,n){"checkbox"==e.type&&ko.utils.registerEventHandler(e,"change",(function(){var a=e.checked,i=1==(n.has("noy")?ko.utils.unwrapObservable(n.get("noy")):0)?a?"2":"1":a?"1":"0";t()(i)}))},update:function(e,t,n){var a=ko.utils.unwrapObservable(t()),i=1==(n.has("noy")?ko.utils.unwrapObservable(n.get("noy")):0)?"2"==a:"1"==a;e.checked=i}},ko.bindingHandlers.enterkey={init:function(e,t,n,a){$(e).keypress((function(n){return 13!==(n.which?n.which:n.keyCode)||(t().call(a,null,e),!1)}))}},ko.bindingHandlers.visibility=function(){function e(e,t){var n=ko.unwrap(t());$(e).css("visibility",n?"visible":"hidden")}return{init:e,update:e}}()}(jQuery,NowPardaz),function(e,t){npImages=[];for(var n=["/img/waiting1.gif"],a=0;a<1;a++){var i=new Image;i.src=n[a],npImages.push(i)}e.NPCreateWidget=function(t,n,a){t.data("NPWidget",n),t[n](a);var i=t[n]("instance");i.options.CmpId;t.on("mouseenter mouseleave mousedown mouseup focus blur","a.np-icon-only,a.np-a-help,input.ui-autocomplete-input,div[np-act],img.Comm,button[np-act],button.Comm",(function(t,n){var a,o=e(this);if(!o.hasClass("ui-button-disabled")&&!o.hasClass("ui-state-disabled"))switch(t.type){case"mouseenter":var r=o.prop("src");o.hasClass("Comm")&&r&&-1==r.indexOf("_Focus")&&o.prop("src",r.replace(".gif","_Focus.gif")),o.is(":button")&&o.addClass("ui-state-hover");var l=o.attr("np-act");i.Acts["act"+l]&&(a=i.Acts["act"+l].HlpArrElem)&&"_ShowError"!=n&&(e.each(a,(function(e,n){var a=n.Elem,i=a.prop("tagName");if(t.target!=document.activeElement)if(i&&"DIV"==i.toUpperCase()){var o=a.css("borderTopWidth"),r=a.css("borderBottomWidth"),l=a.css("borderLeftWidth"),s=a.css("borderRightWidth");a.addClass("ui-state-highlight"),o!==a.css("borderTopWidth")&&a.css("borderTopWidth",o),r!==a.css("borderBottomWidth")&&a.css("borderBottomWidth",r),l!==a.css("borderLeftWidth")&&a.css("borderLeftWidth",l),s!==a.css("borderRightWidth")&&a.css("borderRightWidth",s)}else a.addClass("ui-state-highlight")})),t.stopPropagation());break;case"mouseleave":r=o.prop("src");o.hasClass("Comm")&&r&&o.prop("src",r.replace("_Focus.gif",".gif").replace("_Clicked.gif",".gif")),o.removeClass("ui-state-hover"),o.removeClass("ui-state-active");l=o.attr("np-act");i.Acts["act"+l]&&(a=i.Acts["act"+l].HlpArrElem)&&(e.each(a,(function(e,t){t.Elem.removeClass("ui-state-highlight")})),t.stopPropagation());break;case"mousedown":r=o.prop("src");o.hasClass("Comm")&&r&&o.prop("src",r.replace("_Focus.gif",".gif").replace("_Clicked.gif",".gif").replace(".gif","_Clicked.gif")),o.is(":button")&&o.addClass("ui-state-active");break;case"mouseup":r=o.prop("src");o.hasClass("Comm")&&r&&o.prop("src",r.replace("_Focus.gif",".gif").replace("_Clicked.gif",".gif").replace(".gif","_Focus.gif")),o.removeClass("ui-state-active");break;case"focus":o.is(":button")&&o.addClass("ui-state-active");break;case"blur":o.removeClass("ui-state-active")}})),i.NPGen=i.$ValidXml.r.NPGen,(i.NPGen?i.NPGen.ver:0)<300&&t.find("fieldset").removeClass("ui-widget-content").end().find(':input[type="text"]').addClass("form-control").end().find("select").addClass("form-control").end().find("button.np-icon-only").each((function(t,n){var a=e(n).attr("style")?e(n).attr("style"):"";e(n).after("<a id="+e(n).attr("id")+' style="cursor:pointer;padding-right:5px;'+a+'"  orgid='+e(n).attr("orgid")+" np-act="+e(n).attr("np-act")+' class="np-icon-only"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" class="svg-info" style="vertical-align: middle;" height="20" viewBox="0 0 32 32"><path d="M11.772 20.164v2.871q0 0.251 0.162 0.413t0.413 0.162h2.871q0.251 0 0.413-0.162t0.162-0.413v-2.871q0-0.251-0.162-0.413t-0.413-0.162h-2.871q-0.251 0-0.413 0.162t-0.162 0.413zM7.178 11.264q0 0.897 0.269 1.615t0.816 1.238 0.933 0.79 1.068 0.646q0.574 0.323 0.834 0.502t0.467 0.431 0.206 0.52v0.574q0 0.251 0.162 0.413t0.413 0.162h2.871q0.251 0 0.413-0.162t0.162-0.413v-1.22q0-0.628-0.188-1.157t-0.431-0.852-0.7-0.637-0.736-0.458-0.799-0.377q-0.951-0.449-1.346-0.772t-0.395-0.879q0-0.754 0.781-1.283t1.714-0.529q1.005 0 1.705 0.485 0.52 0.359 1.436 1.489 0.162 0.215 0.449 0.215 0.197 0 0.341-0.108l1.938-1.471q0.18-0.126 0.215-0.359t-0.090-0.413q-2.189-3.445-6.263-3.445-2.315 0-4.28 1.606t-1.965 3.849zM13.781 3.225q2.333 0 4.459 0.915t3.661 2.449 2.449 3.661 0.915 4.459-0.915 4.459-2.449 3.661-3.661 2.449-4.459 0.915-4.459-0.915-3.661-2.449-2.449-3.661-0.915-4.459 0.915-4.459 2.449-3.661 3.661-2.449 4.459-0.915zM0 14.709q0 3.75 1.848 6.918t5.016 5.015 6.918 1.848 6.918-1.848 5.015-5.015 1.848-6.918-1.848-6.918-5.015-5.016-6.918-1.848-6.918 1.848-5.016 5.016-1.848 6.918z"></path></svg></a>'),e(n).remove()})).end().find("textarea").addClass("form-control").css("white-space","pre-wrap").end()},e.fn.NPFocus=function(){this.focus().select()},e.fn.OuterHTML=function(){return e("<div></div>").append(this.clone()).html()},e((function(){var n;e(window.document).on("keyup",(function(n){if("keyup"===n.type){var a,i;e.ui.keyCode;a=n.keyCode?n.keyCode:n.which,n.which,i=n.shiftKey,n.altKey&&i&&67==a&&confirm("آیا مطمئن هستید می خواهید حافظه های موقت پاک شود؟")&&t.utils.NPClearLocalStorage()}})),e.fn.size=function(){return this.length},e.fn.scrollIntoView||t.noNg((()=>e.ajax({url:t.JSFolder+"jq_scrollintoview.js",cache:!0,dataType:"script"}))),n="<script type='text/html' id='ColgroupNPGrid'><col data-bind=\"attr:{width:Width()+'px'}\" ></col><\/script>",e("body").append(e(n)),n="<script type='text/html' id='HeaderTrNPGrid'><tr data-bind=\"template:{name:'ThNPGrid', foreach:$parent.ThTdNoHide($data,'Th',$context)}, npresizable: { animate: true  },npdraggable: { cursor: 'crosshair' }\" ></tr><\/script>",e("body").append(e(n)),n="<script type='text/html' id='ThNPGrid'>\x3c!-- ko if:(typeof(CheckBox)!='undefined') --\x3e"+String.fromCharCode(10)+'<th class=\'npgrid-header\' > <input type="checkbox" data-bind="click:function($data,ev){return $root.NpAllCheckedClick(ev,$data)}, checked:$root.IsNpAllChecked($context) " /></th>\x3c!-- /ko --\x3e'+String.fromCharCode(10)+"\x3c!-- ko if:(typeof(CheckBox)=='undefined') --\x3e"+String.fromCharCode(10)+"<th class='npgrid-header' data-bind=\"    attr:{rowspan:RowSpan,colspan:ColSpanTemp(),       dir:typeof(HDir) !== 'undefined' ? HDir : null,        align:typeof(HAlign) !== 'undefined' ? HAlign : null},    click:function($data,ev){return $root.HeaderRowClick(ev,$data)}\" >    <span data-bind=\"UniHtml:Html() \"  ></span>    <span class='npgrid-sort'>       <nobr>          <span data-bind=\"css:$root.ClassName($data) \" ></span>       </nobr>    </span></th>\x3c!-- /ko --\x3e"+String.fromCharCode(10)+"<\/script>",e("body").append(e(n)),n="<script type='text/html' id='TBodyNPGrid'><tr class='TR-NPGrid' style='border: currentColor; font-weight: normal;cursor: pointer;'    data-bind=\"template:{name:'TdNPGrid', foreach:$parent.ThTdNoHide($data,'Td',$context)}      ,css: $root.RowClassName($data,$context)      ,click:function($data,ev){return $parent.RowClick(ev,$data)}       ,event: { mouseover: $parent.mov, mouseout: $parent.mou }      ,attr:{RadifIndex:$index}\" ></tr><\/script>",e("body").append(e(n)),n="<script type='text/html' id='TdNPGrid'>"+String.fromCharCode(10)+" <td class='npgrid-body-cell np-border-left-right'    data-bind=\"css:{'npgrid-header ui-state-default':id=='R'}     ,attr:{rowspan:RowSpan,colspan:ColSpanTemp(),        dir:typeof(Dir) !== 'undefined' ? Dir : null,         align:typeof(Align) !== 'undefined' ? Align : null }      ,NpMultiLine:((typeof(MultiLine) !== 'undefined')&&(MultiLine=='1'))?'1':'0'      ,template:{name:$data.TempName}   \"  ></td>"+String.fromCharCode(10)+"<\/script>",e("body").append(e(n)),n="<script type='text/html' id='TdNPGrid_Check'>"+String.fromCharCode(10)+" <input type=\"checkbox\" data-bind=\" checked:$root.IsNpCheck($data,$context) \" /><\/script><script type='text/html' id='TdNPGrid_Html'>"+String.fromCharCode(10)+' <span   data-bind="UniHtml:Html()   "  ></span>'+String.fromCharCode(10)+"<\/script><script type='text/html' id='TdNPGrid_Text'>"+String.fromCharCode(10)+' <span   data-bind="UniText:Html()   "  ></span>'+String.fromCharCode(10)+"<\/script>",e("body").append(e(n))}))}(jQuery,NowPardaz),function($,np){var NPCommanderButtonClass="NPCommanderButtons",ReturnButtonID="ReturnButton",tbFooterAlignment="tbFooterAlignment";$.fn.zIndex=function(e){try{if(e)return $(this[0]).css("z-index",e),e;var t=$(this[0]).css("z-index");return"auto"==t?1:t}catch(e){}},$.fn.SetZIndex=function(){var e=this[0],t=$(".modal.show,.ui-dialog:visible").map((function(){var e=+$(this).css("z-index");return isNaN(e)?0:e})).get();t=Math.max.apply(null,t)||1,t+=1,e&&$(e).css("z-index",t)},$.fn.xml2=function(e){var t="";for(this.length&&(void 0!==e&&e?this:$(this[0]).contents()).each((function(){try{t+=(new XMLSerializer).serializeToString(this)}catch(e){t+=this.xml}}));t.indexOf(String.fromCharCode(10))>-1;)t=t.replace(String.fromCharCode(10),"&#10;");return t},Array.max=function(e){return Math.max.apply(Math,e)},Array.min=function(e){return Math.min.apply(Math,e)},$.fn.npicon=function(e,t,n){n||(n="ui-state-default");var a=("np"==e.substr(0,2)?"np":"ui")+"-icon";return this.addClass("np-icon-only ui-corner-all "+n).attr("role","button").attr("href","#").children("div").addClass("size"+t+" "+e+" "+a),this},$.widget("np.npform",{options:{fname:"",inxml:null,AfterClose:null,AfterOpen:null,ReturnParam:null,AfterAct:null},_create:function(){var e=this,t=e.options,n=e.element,a=n;e.WebBusy=!1,e.ExitFromSystem=!1,e.BackSpaceFocus=!0,e.EmptyMessage={msg:{errors:[],war:[],suc:[]}},e.ContId=n.uniqueId().attr("id"),e.$ValidXml={r:{n:{},acts:{},iacts:{}}},e.Acts=e.$ValidXml.r.acts,e.iacts=e.$ValidXml.r.iacts,e.V_={},e.W_={RunDoActInQueue:0,OpenedDialogs:{},StayedForm:{},FrmFld:{},FrmFld_Grd:{},FrmFld_StateNo:{},FrmFld_Htm:{},FrmFld_PDat:{},FrmFld_GDat:{},HelpDialogs:{},HelpGrids:{},Alias2Id:{}};var i=$(window),o=i.width(),r=i.height();(o<=768||o<=900&&r<=400)&&(e.W_.IsInMobile=!0),e.Valid_={IsChangeInProgress:!1,CurLang:null,ML:[[31,31,31,31,31,31,31,30,30,30,30,30,30],[31,31,29,31,30,31,30,31,31,30,31,30,31]],ControlKeys:[18,$.ui.keyCode.BACKSPACE,1,17,$.ui.keyCode.DELETE,$.ui.keyCode.DOWN,$.ui.keyCode.END,$.ui.keyCode.HOME,$.ui.keyCode.INSERT,$.ui.keyCode.LEFT,$.ui.keyCode.RIGHT,16,$.ui.keyCode.UP,$.ui.keyCode.TAB]},e.Resp=null,e.UserLvl=0,e._SndXML=null,e.ActNo="",e.FMod="",e.ModeCode="",e.NextAct="",e._Grd=[],e.IsBindingInProgress=!1,t.IsMakedFullId||($("[id]",a).each((function(t,n){var a,i=$(n);a=i.prop("id"),i.attr("orgid",a),i.prop("id",e.MakeFullId(a))})),$("label[for]",n).each((function(t,n){var a=$(n),i=e.MakeFullId(a.attr("for"));a.prop("for",i)}))),e.W_.$dvfrmHeader=$("#"+e.MakeFullId("dvfrmHeader"),a),e.W_.$dvfrmCenter=$("#"+e.MakeFullId("dvfrmCenter"),a),e.W_.$dvfrmCenter.on("scroll",(function(){GlobViewModel.LangShow.hide(),$(".ui-autocomplete",a).hide()})),t.IsCmp||e.W_.$dvfrmCenter.addClass("panel-body m-md-2 p-md-2 pr-md-2 m-0 p-0 pr-1 np-overflow-x-auto"),t.OpenInline&&t.OpenerSelf.W_.$dvfrmCenter.removeClass("np-overflow-x-auto"),e.W_.$dvfrmFooter=$("#"+e.MakeFullId("dvfrmFooter"),a),e.W_.$bod=$("#"+e.MakeFullId("bod"),a).addClass("panel-default").removeClass("ui-widget").removeClass("ui-widget-content"),e.W_.$dvfrmHeader.length&&!t.IsCmp&&e.W_.$dvfrmHeader.height()>0&&e.W_.$dvfrmHeader.addClass("panel-heading"),(t.ShowFooter||void 0===t.HideFooter)&&(t.HideFooter=!1),t.OpenInline&&t.HideFooter||(e.W_.$dvfrmFooter.addClass("panel-footer nobr").removeClass("ui-widget-header"),$(e.W_.$bod).css("overflow",""),t.OpenInDialog||t.OpenedByDashboard&&t.OpenerSelf&&t.OpenerSelf.options.OpenInDialog?e.W_.$dvfrmFooter.css({position:"sticky",bottom:t.NavStepSelf?"":"0px",width:"100%",left:"0px"}):e.W_.$dvfrmFooter.css({position:"sticky",bottom:"0px"}).css({width:"100%",right:"0px"})),$("hr",e.W_.$dvfrmHeader).remove(),e.ViewModel={ContId:e.ContId,_npform:e,WebBusy:ko.observable(!1),OpenWaiting:ko.observable(0),OpenLoading:ko.observable(0),vm_FullId:function(t){return e.MakeFullId(t)},vm_ResetClicked:function(){e.ResetClick()},vm_FaciHelp:function(){try{e.parsedHelpJson&&"undefined"!=typeof introJs?e.IntroHelp(0):e.FaciHelp()}catch(t){e.FaciHelp()}},vm_Trigger:function(t){e._trigger(t)},vm_ValText:function(e,t,n){return function(e,t,n){for(var a=t[n+np.OPTOPT](),i=t[n](),o=0;o<a.length;o+=1){var r=a[o];if(r.val===i)return r.val+") "+r.dsc}}(0,t.$root,n)},vm_DoAct:function(t){e.ErLen=0,e.WarLen=0,e.DoAct(t)},vm_DisableCommanderButtons:ko.observableArray([]),vm_CommanderButtonDisable:function(t){return e.ViewModel.WebBusy()||e.ViewModel.vm_DisableCommanderButtons.indexOf(t)>-1},vm_ReturnBack:function(){e.ReturnButtonClick()}},t.ParentCmp||(e.ViewModel.vm_Respmsg=ko.observable({c:ko.observableArray([])}),e.ViewModel.vm_ShowRespmsg=ko.observable(!1)),e.ViewModel.WebBusy.subscribe((function(t){e.GetngData()?.AngularTab?.openWaiting&&e.GetngData()?.AngularTab?.openWaiting(!!t)})),e.ViewModel.OpenLoading.subscribe((function(t){e.GetngData()?.AngularTab?.openWaiting&&e.GetngData()?.AngularTab?.openWaiting(!!t,!0)})),t.ParentCmp?(t.HideFooter=!0,e.EnableAllField=!1,e.ReadyCallBack_cnt=0):(e._CreateCommanderButtons(),$("td span.ui-icon-help",e.W_.$dvfrmHeader).remove()),t.NewFormAutJSON&&t.NewFormAutJSON.tit&&(t.ftitle=t.NewFormAutJSON.tit),t.IsCmp||t.UseOpenerAut||(e.Aut={rp:t.rp}),t.CmpId&&e.GetXmlValidation()},clearDashDoAct:function(){var e=this.options;this.element;e.inxml?.doact?.act&&e.inxml?.outpar?.F77771&&delete e.inxml.doact.act},gettinybutton:function(e,t){var n="edit"==e?"اصلاح":"delete"==e?"حذف":"view"==e?"نمايش":"help"==e?"راهنما":"send"==e?"ارسال":"confirm"==e?"تاييد":"detail"==e?"جزييات":"viewflow"==e?"مشاهده گردش کار":"viewflowA"==e?"مشاهده گردش کار اتوماسيون":"-";t=t||{};var a="";return $.each(t,(function(e,t){a=e+'="'+t+'" '})),'<button title="'+n+'" np-icon="'+e+'" class="np-tinyicon np-tinyicon-'+e+'" '+a+">&nbsp;</button>"},SetHyper:function(e,t){var n=(e=e||{}).tagName||"span",a=e.name&&' name="'+e.name+'"'||"",i=e.attr||{},o=e.style&&' style="'+e.style+'"'||"",r=" ",l="np-hypertext",s=e.title&&' title="'+e.title+'"'||"";return e.class&&(l=l+" "+e.class),$.each(i,(function(e,t){r+=e+'="'+t+'" '})),"<"+n+s+o+a+r+" class='"+l+"'>"+t+"</"+n+">"},GetGlyphIcon:function(e){e=e||{};this.options,this.element;var t=e.tagName||"span",n=e.name||"",a=e.attr||{},i=e.style||"",o=" ",r=e.type||"",l="",s=' title="'+e.title+'"'||"";switch($.each(a,(function(e,t){o+=e+'="'+t+'" '})),n.toLowerCase()){case"key":l="glyphicon npglyph-key-stroke";break;case"write":case"nextstep":l="glyphicon npglyphicon-esc";break;case"download":l="glyphicon glyphicon-download";break;case"confirm":l="glyphicon glyphicon-check";break;case"delete":l="glyphicon glyphicon-close2-solid";break;case"edit":l="glyphicon npglyphicon-pen";break;case"rep1":l="glyphicon glyphicon-paper";break;case"rep2":l="glyphicon glyphicon-paper-stack";break;case"rep3":l="glyphicon glyphicon-file";break;case"send":l="glyphicon npglyphicon-send";break;case"view":l="glyphicon glyphicon-search";break;case"viewflow":l="glyphicon npglyphicon-map";break;case"confsend":l="glyphicon npglyphicon-confsend";break;case"sendcomm":l="glyphicon glyphicon-comment";break;case"comm":l="glyphicon npglyphicon-COMM";break;case"nconfsend":l="glyphicon npglyphicon-nconfsend";break;case"faci1":case"faci4":case"faci7":l="glyphicon glyphicon-book";break;case"faci2":case"faci5":case"faci8":l="glyphicon glyphicon-folder-close";break;case"faci3":case"faci6":case"faci9":l="glyphicon npglyphicon-clipboard";break;case"makecmp":l="glyphicon glyphicon-cog";break;case"paramsandfields":l="glyphicon glyphicon-layout";break;case"columns":l="glyphicon glyphicon-fire";break;case"grid2":l="glyphicon npglyphicon-grid2";break;case"server":l="glyphicon npglyphicon-server";break;case"help":l="glyphicon glyphicon-question-sign";break;case"info":l="glyphicon glyphicon-info-solid";break;case"validation":l="glyphicon glyphicon-ok-circle";break;case"hlp":l="glyphicon npglyphicon-Hlp";break;case"arrow-up":l="glyphicon npglyphicon-arrow-up-outline";break;case"arrow-down":l="glyphicon npglyphicon-arrow-down-outline";break;case"cancel":l="glyphicon npglyphicon-cancel"}if(e.class&&(l=l+" "+e.class),"svg"==r){var d='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32">',p="";if("download"===n.toLowerCase())p='<path d="M26.202 9.455l1.881 1.881-12.035 12.035-9.34-9.34v6.143h-2.695v-10.719h10.719v2.695h-6.143l7.459 7.459z"></path>';return $(d).append(p),$(d)}return"<"+t+s+o+" class='"+l+"' name='"+n+"' style='"+i+"'></"+t+">"},_UpdateCommanderButtons:function(){var e=this,t=(e.options,e.element,$(".table>div:eq(1)",e.W_.$tbFooterAlignment));$("button",t).each((function(t,n){e.W_.IMs[$(n).attr("orgid")]&&e.W_.IMs[$(n).attr("orgid")].Icon&&$(n).npButton("option","icon",e.W_.IMs[$(n).attr("orgid")].Icon)}))},_CreateCommanderButtons:function(){var e=this,t=e.options,n=(e.element,e.W_.$dvfrmFooter.children());e.W_.$tbFooterAlignment=$('<div id="'+e.MakeFullId(tbFooterAlignment)+'" style="dis_play:table;width:100%"><div style="display:flex;flex-wrap: nowrap;align-items:center" class="table"><div data-bind="click:function(){$root.vm_ShowRespmsg(!$root.vm_ShowRespmsg())}, style: { transform: $root.vm_ShowRespmsg()?\'rotate(-180deg)\': \'rotate(0deg)\' }" style=" position: absolute;top: 0px;right:4px; transform: rotate(0deg);display:inline-block;cursor:pointer;-webkit-transition-duration: 0.4s;-moz-transition-duration: 0.4s;-o-transition-duration: 0.4s;transition-duration: 0.4s;-webkit-transition-property: -webkit-transform;-moz-transition-property: -moz-transform;transition-property: transform;"><div style="display:none" data-bind="visible:($root.vm_Respmsg().c().length > 0)">   <svg class="svg-info" viewBox="0 0 20 20" style="max-height:28px" height="17" width="17">      <path d="M0 10c0-5.523 4.477-10 10-10s10 4.477 10 10v0c0 5.523-4.477 10-10 10s-10-4.477-10-10v0zM10 18c4.418 0 8-3.582 8-8s-3.582-8-8-8v0c-4.418 0-8 3.582-8 8s3.582 8 8 8v0zM10.7 7.46l3.55 3.54-1.41 1.41-2.84-2.81-2.83 2.8-1.41-1.4 4.24-4.24 0.7 0.7z"></path>   </svg></div></div><div class="flex-grow-1" style="overflow-x: auto;"><div style="white-space: nowrap;wid_th: calc(100% - 100px);" id="'+e.MakeFullId("tbFooterAlignmentRight")+'"></div></div><div style="dis_play:table-cell;direction:ltr;text-align: left;wid_th:100px"></div></div></div>').appendTo(e.W_.$dvfrmFooter);var a=$(".table>div:eq(1)",e.W_.$tbFooterAlignment);if(n.appendTo(a),e.W_.$dvfrmFooter.prepend($("<div data-bind=\"template:{name:'_ErrorTmpl',data:vm_Respmsg }\"></div>")),e.W_.IMs={},$("button",a).each((function(t,n){var a,i=e.MakeOrgId(n.id);switch(e.W_.IMs[i]={LastShow:!1,LastEnable:!0,LasText:null,LastIcon:null},i){case"IM01":a="np-icon-check";break;case"IM02":a="ui-icon-submit";break;case"IM03":a="ui-icon-close";break;case"IM04":case"IM09":a="np-icon-submit";break;case"IM08":a="np-icon-search";break;case"IM99":a=""}$(n).addClass(NPCommanderButtonClass).npButton({icons:{secondary:a},type:"default"})})),$("button."+NPCommanderButtonClass,e.W_.$dvfrmFooter).hide(),!t.ParentCmp){var i=$(".table>div:eq(2)",e.W_.$tbFooterAlignment);void 0!==t.ReturnCaption||t.OpenerSelf&&t.OpenerSelf.options.NoReturn||(t.ReturnCaption="بازگشت"),t.NoReturn=!t.ReturnCaption,t.ReturnCaption||(t.ReturnCaption="بازگشت"),e.W_.$ReturnButton=$('<button id="'+e.MakeFullId(ReturnButtonID)+'" class="np-d-none" style="display:none" title="بازگشت به منوی اصلی"></button>').attr("title",t.ReturnCaption||"بازگشت به منوی اصلی").appendTo(i).npButton({icons:{secondary:"np-icon-return"},type:"default"}),e.W_.$ScrollToTop=$('<span class="np-d-none"><svg  version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  class="svg-secondary" style="padding-top:5px;opacity:0.9" height="32" width="32" viewBox="0 0 32 32"><path d="M5.081 15.95c0-1.078 0.419-2.090 1.181-2.852l9.569-9.569 9.569 9.57c1.522 1.522 1.522 4.179 0 5.702-0.761 0.761-1.774 1.18-2.85 1.18s-2.090-0.419-2.852-1.181l-3.867-3.867-3.869 3.867c-0.761 0.762-1.774 1.181-2.85 1.181s-2.090-0.419-2.852-1.181c-0.761-0.761-1.18-1.772-1.18-2.85zM15.832 7.33l-7.669 7.67c-0.508 0.508-0.507 1.393 0 1.9 0.254 0.254 0.59 0.394 0.95 0.394s0.696-0.14 0.95-0.394l5.769-5.768 5.769 5.768c0.254 0.254 0.591 0.394 0.95 0.394s0.696-0.14 0.95-0.394c0.509-0.508 0.508-1.393 0.001-1.9l-7.67-7.67z"></path> </svg></span>').appendTo(i),e.W_.$ScrollToBot=$('<span><svg  version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  class="np-d-none svg-secondary" style="padding-top:5px;opacity:0.9" height="32" width="32" viewBox="0 0 32 32"><path d="M5.081 11.919c0-1.078 0.419-2.090 1.181-2.852 0.761-0.761 1.774-1.18 2.85-1.18s2.090 0.419 2.852 1.181l3.867 3.867 3.869-3.867c0.761-0.762 1.774-1.181 2.85-1.181s2.090 0.419 2.852 1.181c1.521 1.522 1.522 4.178-0.001 5.702l-9.569 9.569-9.569-9.57c-0.762-0.761-1.181-1.772-1.181-2.85zM23.894 11.919c0-0.36-0.14-0.696-0.392-0.95-0.255-0.254-0.593-0.394-0.951-0.394s-0.696 0.14-0.95 0.394l-5.769 5.768-5.769-5.768c-0.254-0.254-0.59-0.394-0.95-0.394s-0.696 0.14-0.95 0.394c-0.509 0.508-0.508 1.393-0.001 1.9l7.67 7.67 7.669-7.67c0.254-0.254 0.394-0.59 0.394-0.95z"></path></svg></span>').appendTo(i),$("html,body").scroll((function(){e.W_&&(e.W_.$ScrollToTop.addClass("np-d-none"),$(document).height()>$(window).height()&&$(this).scrollTop()>5&&e.W_.$ScrollToTop.removeClass("np-d-none"))})),e._on(e.W_.$ScrollToTop,{click:function(){$("html,body").animate({scrollTop:0},"fast")}}),e._on(e.W_.$ScrollToBot,{click:function(){$("html,body").animate({scrollTop:document.body.scrollHeight},"fast")}}),e._on(e.W_.$ReturnButton,{click:function(){e.ReturnButtonClick()}})}},ReturnButtonClick:function(){var e=this,t=e.options;t.NavStepSelf&&t.NavStepSelf.GetParentCmp()&&t.NavStepSelf.GetParentCmp().options.NavStepSelf&&!t.OpenInDialog&&t.NavStepSelf.GetParentCmp().options.NavStepSelf.Close(),t.NavStepSelf&&!t.OpenInDialog?t.NavStepSelf.Close():t.$FaciDialogDiv?e.CloseDialog():e.Close()},SetReturnCaption:function(e){this.W_.$ReturnButton.attr("title",e)},HideReturnButton:function(e){e?this.W_.$ReturnButton.hide():this.W_.$ReturnButton.show()},GetCover:function(e){var t=this;if(!e)return null;for(;e.parent();){if(e.parent()[0].id==t.MakeFullId("dvfrmFooter")||e.parent()[0].id==t.MakeFullId("dvfrmCenter")||e.parent()[0].id==t.MakeFullId("bod")||e.parent()[0].id==t.MakeFullId("dvfrmCenter"))return e.parent();e=e.parent()}return null},ShapeFrm:function(){var e=this,t=e.options;e.W_&&t.OpenInDialog&&e.dvfrmCenterHeight()},_init:function(){var e=this;e.options.HideFooter&&e.W_.$dvfrmFooter.hide(),e.ShapeFrm()},ReplaceParameter:function(e,t,n){this.options,this.element;var a=n.EscapeXml,i=n.EscapeJSON;return e&&$.each(e,(function(e,n){var o;i&&(o=n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')),a&&(o=np.utils.escapeXml(n)),t=e==np.P_IDIDID?t.replace(new RegExp("#"+np.P_IDIDID+"#*","g"),o):t.replace(new RegExp("#"+e+"#[^\"']*","g"),o)})),t=t.replace(np.utils.SetDefaultExpr,"")},SetDefToChild:function(e,t){var n=this,a=n.W_.FrmFld[e].md;a&&$.each(a,(function(a,i){var o=n.W_.FrmFld[i.P].WidgetSelf.W_.FrmFld[i.C].Valid.Def;t!=o&&("$"==t&&n.W_.FrmFld[i.P].WidgetSelf.ViewModel[i.C](n.ViewModel[e]()),n.W_.FrmFld[i.P].WidgetSelf.W_.FrmFld[i.C].Valid.Def=t,n.W_.FrmFld[i.P].WidgetSelf.SetDefToChild(i.C,t))}))},CreateFrmFlds:function(){var e=this,t=(e.options,e.element);$.each(e.W_.FrmFld,(function(t,n){if(n.Help&&e.W_.FrmFld[t+"_Div"]){var a=e.$np("#"+n.Help);e.$np("#"+t+"_Div").append(a)}if(n.md&&$.each(n.md,(function(t,n){var a=/#(\w*)#(\w*)/.exec(n.C);if(a){var i=e.W_.FrmFld[n.P];i.WidgetSelf=i.WidgetSelf||np.utils.GetWidgetSelf(i.Elem,i.WidgetName);var o=i.WidgetSelf.W_.Alias2Id[a[1]];n.C=o||n.C.replace("#"+a[1]+"#","")}})),n.mdChild&&$.each(n.mdChild,(function(e,t){var a=/#(\w*)#(\w*)/.exec(t.ChId);if(a){n.WidgetSelf=np.utils.GetWidgetSelf(n.Elem,n.WidgetName);var i=n.WidgetSelf.W_.Alias2Id[a[1]];t.ChId=i||t.ChId.replace("#"+a[1]+"#","")}})),"Cmp"==n.Valid.Typ){n.WidgetSelf=np.utils.GetWidgetSelf(n.Elem,n.WidgetName);var i=n.WidgetSelf.$ValidXml.r.KeyObjId;if(110025==n.WidgetSelf.options.CmpId){var o,r=e.W_.Alias2Id.MULTIVAL,l=e.W_.Alias2Id.SINGLVAL,s=n.WidgetSelf.W_.Alias2Id.MULTIVAL,d=n.WidgetSelf.W_.Alias2Id.SINGLVAL;r&&s&&(o=e.W_.FrmFld[r])&&(o.md=o.md||[],o.md.push({P:t,C:s}),n.mdChild=n.mdChild||[],n.mdChild.push({PId:r,ChId:s})),l&&d&&(o=e.W_.FrmFld[l])&&(o.md=o.md||[],o.md.push({P:t,C:d}),n.mdChild=n.mdChild||[],n.mdChild.push({PId:l,ChId:d}))}!i||n.Valid.P_MSAutoC&&"0"!=n.Valid.P_MSAutoC||(n.md=n.md||[],n.md.push({P:t,C:i}),n.mdChild=n.mdChild||[],n.mdChild.push({PId:t,ChId:i}))}var p,c=n.Valid.MasterCmp;if(c&&(p=e.W_.FrmFld[c])){if(p.Valid.CmpId!=n.Valid.CmpId)return void alert('CmpId of "'+t+'" must same as its MasterCmp("'+c+'")');var u=n.Valid.npMode;if(!u)return void alert('npMode is Require for "'+t+'" object');var m=e.W_.FrmFld[c+np.VMCmpXml];m.SubFrmBrothers=m.SubFrmBrothers||[],m.SubFrmBrothers.push({id:t,idXml:t+np.VMCmpXml,npMode:u,self:n.WidgetSelf})}})),$.each(e.W_.FrmFld,(function(t,n){var a=n.Valid,i=n.md;if(i){var o=n.Valid.HasDesc,r=e.W_.FrmFld[t].Valid.Def;r||($.each(i,(function(t,n){var a=e.W_.FrmFld[n.P].WidgetSelf.W_.FrmFld[n.C].Valid.Def;if(a&&"$"!=a)return r=a,!1})),e.W_.FrmFld[t].Valid.Def=r),r&&e.SetDefToChild(t,r),e.ViewModel[t].subscribe((function(n){$.each(i,(function(a,i){var r={outpar:{}};r.outpar[i.C]=n,o&&(r.outpar[i.C+np.ACDesc]=e.ViewModel[t+np.ACDesc](),r.outpar[i.C+np.ACTip]=e.ViewModel[t+np.ACTip]()),e.W_.FrmFld[i.P].WidgetSelf._XML2ViewModel(r,{SetByMd:!0,NoInternalChg_OnSubs:!e.InternalChg_OnSubs})}))}))}"Cmp"==a.Typ?(n.mdChild&&$.each(n.mdChild,(function(e,t){n.WidgetSelf.SetRelationChildToParent(t.ChId,t.PId,n.WidgetSelf.W_.FrmFld[t.ChId].Valid.HasDesc)})),a.UrlF?(n.IsFaci=!1,a.OnAC||e.ViewModel[t+np.VMCmpXml].subscribe((function(t){var a={outpar:{}},i=$(t);i.length&&($.each(i[0].attributes,(function(e,t){var n=t.name.toUpperCase();-1==n.indexOf(np.ACDesc.toUpperCase())&&-1==n.indexOf(np.ACTip.toUpperCase())&&(a.outpar[n]=t.value),n.indexOf(np.ACDesc.toUpperCase())>-1&&(a.outpar[n.replace(np.ACDesc.toUpperCase(),np.ACDesc)]=t.value),n.indexOf(np.ACTip.toUpperCase())>-1&&(a.outpar[n.replace(np.ACTip.toUpperCase(),np.ACTip)]=t.value)})),n.WidgetSelf._XML2ViewModel(a,{NoInternalChg_OnSubs:!e.InternalChg_OnSubs}))}))):n.IsFaci=!0):n.Elem=e.GetFldElem(t)})),$("label[for]",t).each((function(n,a){var i=$(a),o=i.attr("for"),r=$("#"+o,t),l=r.prop("tagName");if(l&&(l=l.toUpperCase())&&("DIV"==l||"SELECT"==l)){var s=r.attr("orgid"),d=r.hasClass("groupInput");if(s=s&&e.W_.FrmFld[s],"DIV"==l){var p=r.find("input:first");o=p.prop("id")||o,i.prop("for",o),d&&s&&(s.LabelElemCmp=i,p.css("box-shadow","none","important").data("LabelElemCmp",i).parent().css("box-shadow","none","important"))}d&&s&&"SELECT"==l&&i.insertAfter(r)}}))},GetFldElem:function(e){var t=this,n=t.W_.FrmFld[e],a=n.Elem;return a||"_Var"===n.Valid.Typ||(a=$("#"+t.MakeFullId(e),t.W_.$bod),n.Elem=a),a},GetFldWidgetElem:function(e){var t,n=this.W_.FrmFld[e],a=n.WidgetElem;if(!a){if(!(t=this.GetFldElem(e)))return;n.Valid.IsAC&&t.is(":np-npAutoComplete")&&(a=t.npAutoComplete("widget")),"Grd"==n.Valid.Typ&&t.is(":np-npgrid")&&(a=t.npgrid("widget")),"But"==n.Valid.Typ&&t.is(":np-npButton")&&(a=t.npButton("widget")),n.WidgetElem=a}return a},GetXmlValidation:function(){var e,t=this,n=t.options;t.element;function a(e){n.PreLoad?t.$ValidXml=n.PreLoad.$ValidXml:t.$ValidXml=JSON.parse(t.ReplaceParameter(n.P_,e||'{"r":{"n":{},"acts":{}}}',{EscapeJSON:!0})),t.Acts=t.$ValidXml.r.acts,t.iacts=t.$ValidXml.r.iacts,"0"==t.$ValidXml.r.Return&&(n.NoReturn=!0),n.NoReturn||t.W_.$ReturnButton&&t.W_.$ReturnButton.show();var a=t.$ValidXml.r.NoAuth;a&&"1"!=a&&delete t.$ValidXml.r.NoAuth,t.AfterGetXmlValidation(null,(function(){t.CreateFrmFlds(),t.CreateViewModelFinal()}),n.PreLoad?1:0)}if(n.CmpId&&(e=np.utils.NPLocalStorage(n.CmpType,n.CmpId,"XML")))a(e);else{var i={dataType:"text",cache:!0,error:function(e,t,n){alert("error occur at get xml validation")},success:function(e){a(e)}};np.noNg((()=>$.ajax(n.fname+".json",i)))}},CreateViewModel:function(mdObj,mdChild,OnlyThisId){var self=this;mdObj=mdObj||{},mdChild=mdChild||{},$.each(self.$ValidXml.r.n,(function(id,v){if(!OnlyThisId||id==OnlyThisId){var ThisFrmFld=self.W_.FrmFld[id];if(v.id=id,!ThisFrmFld){ThisFrmFld=self.W_.FrmFld[id]={},ThisFrmFld=$.extend(ThisFrmFld,{LastReq:null,Enable:!0,LastEnable:null,Show:null,LastShow:null,SetClear:null,DisAC:null,LastDisAC:null,relfield:"",Lastrelfield:""}),ThisFrmFld.Valid=v;var Valid_=ThisFrmFld.Valid,to,pos;if(Valid_.Typ=Valid_.Typ||"Txt",Valid_.Nex=Valid_.Nex||"",Valid_.Dec=Valid_.Dec||"",Valid_.Req=Valid_.Req||"0",Valid_.Fro=Valid_.Fro||"",Valid_.To=Valid_.To||"",Valid_.Min=Valid_.Min||"",Valid_.Max=Valid_.Max||"",Valid_.Lan=Valid_.Lan||"3",Valid_.Fil=Valid_.Fil||"",Valid_.Jus=Valid_.Jus||"",Valid_.Cap=Valid_.Cap||"",Valid_.OnCh=Valid_.OnCh||"","Tmpl"==Valid_.Typ&&(self.ViewModel[id+np.OPTOPT]=ko.observableArray([])),"Grd"==Valid_.Typ&&(self.W_.FrmFld_Grd[id]=ThisFrmFld,ThisFrmFld.ColsValid=v.col),Valid_.StateNo&&(self.W_.FrmFld_StateNo[id]=ThisFrmFld),"Htm"!=Valid_.Typ&&"SHtm"!=Valid_.Typ||(self.W_.FrmFld_Htm[id]=ThisFrmFld),"PDat"==Valid_.Typ&&(self.W_.FrmFld_PDat[id]=ThisFrmFld),"GDat"==Valid_.Typ&&(self.W_.FrmFld_GDat[id]=ThisFrmFld),"Radio"==Valid_.Typ&&(self.ViewModel[id+"_Enable"]=ko.observable(!0)),"1"==Valid_.Opt){var opt=[];v.d&&$.each(v.d,(function(e,t){var n={};$.each(t,(function(e,t){n[e]=t})),""===n.val&&""===n.dsc||opt.push(n)})),self.ViewModel[id+np.OPTOPT]=ko.observableArray(opt)}!Valid_.Max&&Valid_.To&&(Valid_.Max=Valid_.To.length),Valid_.Max||"PDat"!=Valid_.Typ&&"GDat"!=Valid_.Typ||(Valid_.Max=8),!Valid_.Dec&&(to=Valid_.To)&&(pos=to.indexOf("."),pos>-1&&(Valid_.Dec=to.substr(pos+1).length)),ThisFrmFld.Help=Valid_.Hlp,ThisFrmFld.Req=Valid_.Req,ThisFrmFld.Act=Valid_.Act,ThisFrmFld.Alias=Valid_.Alias,"DLbl"==Valid_.Typ&&(Valid_.ValidInc||(Valid_.ValidExc="1"),Valid_.RO="1");var def=Valid_.Def;def||(def="");try{def.indexOf("(")>-1&&(def=eval(def),Valid_.Def=def)}catch(e){}def+="";var firstdef=def,idx=def.indexOf("$"),Alias,OnSubs;if(idx>-1&&(firstdef="$$"==def?"$":def.substr(0,idx),def="$",Valid_.Def=def),self.ViewModel[id]=ko.observable(firstdef),self.ViewModel[id].extend({notify:"always"}),mdObj[id]&&(ThisFrmFld.md=eval(mdObj[id])),mdChild[id]&&(ThisFrmFld.mdChild=mdChild[id]),(Alias=Valid_.Alias)&&(Alias=Alias.toUpperCase(),self.W_.Alias2Id[Alias]=id,-1==id.indexOf(np.ACDesc)&&-1==id.indexOf(np.ACTip)&&-1==id.indexOf(np.VMCmpXml)&&(self.W_.Alias2Id[Alias+np.ACDesc]=id+np.ACDesc,self.W_.Alias2Id[Alias+np.ACTip]=id+np.ACTip,self.W_.Alias2Id[Alias+np.VMCmpXml]=id+np.VMCmpXml,self.W_.Alias2Id[Alias+np.VMCmpXmlUppercase]=id+np.VMCmpXml)),Valid_.MSAutoC&&"0"!=Valid_.MSAutoC&&(ThisFrmFld.Type2="MS"),"But"==Valid_.Typ){var Elem=ThisFrmFld.Elem=$("#"+self.MakeFullId(id),self.W_.$bod),o={},ricon=Valid_.RIcon,licon=Valid_.LIcon,label=Valid_.Label;if((ricon||licon)&&(o.icons={},licon&&(o.icons.primary=licon),ricon&&(o.icons.secondary=ricon)),Valid_.BtnClass&&(o.type=Valid_.BtnClass),void 0===label&&(label=Elem.html()),""==label?o.text=!1:o.label=label,Elem.npButton(o),"1"==Valid_.IsCurSubFrm){var div=$("<div id="+Elem.attr("id")+" class='btn btn-success' orgid="+Elem.attr("orgid")+" style='display:inline-block;cursor:auto' >"+Elem.text()+"</div>");$(div).insertAfter(Elem),Elem.remove()}}MyFunction("OpenFaci"),MyFunction("OnOvr"),MyFunction("OnOut"),MyFunction("OnClk"),MyFunction("OnBl"),MyFunction("OnCh"),(OnSubs=Valid_.OnSubs)&&self.ViewModel[id].subscribe((function(e){self._trigger(OnSubs,null,{NewValue:e,IsUsrChg:!self.InternalChg_OnSubs})}))}}function MyFunction(e){var t=Valid_[e];t&&(ThisFrmFld["np-"+e]=t)}}))},HideHeader:function(){this.$np("#dvfrmHeader").parent().addClass("np-d-none")},ShowHeader:function(){this.$np("#dvfrmHeader").parent().removeClass("np-d-none").removeClass("d-none")},AfterGetXmlValidation:function(e,t,n){var a=this,i=a.options,o=(a.element,np.utils.NPLocalStorage(0,i.CmpId,"H"));if(a.W_.$dvfrmHeader.wrapAll("<div class='d-flex flex-row w-100 flex-nowrap' ></div>"),a.W_.$dvfrmHeader.css("overflow-x","auto").addClass("d-flex flex-row flex-nowrap p-0 flex-grow-1"),!i.ParentCmp&&!a.HHlpIconIsAdded){try{a.parsedHelpJson=o&&JSON.parse(o)?.help}catch(e){}a.parsedHelpJson&&(a.parsedHelpJson.forEach((e=>{e.h=e.h||[],e.h=e.h.filter((e=>2==e.cnf))})),a.parsedHelpJson=a.parsedHelpJson.filter((e=>e.h.length))),("1"==i.HHLP||a.parsedHelpJson&&a.parsedHelpJson[0]?.mode)&&(a.W_.HelpBox=$('<div class="pl-2"><button class="p-2 btn" style="border:0px" data-bind="click: vm_FaciHelp"><span title="راهنما"  class="ui-icon ui-icon-Texthelp FaciHelp"></span></span></button></div>'),a.W_.$dvfrmHeader.parent().prepend(a.W_.HelpBox)),i.OpenInDialog||i.OpenInline||(i.HideBackButton=!0),a.W_.$dvfrmHeader.parent().prepend($('<div class="d-flex pl-2 align-items-start"><button class="btn btn-outline-info'+(i.HideBackButton?" np-d-none":"")+'" style="border:0;border-radius:0" data-bind="click: vm_ReturnBack"><svg version="1.1" xmlns="http://www.w3.org/2000/svg"   xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 170 150" xml:space="preserve">   <path style="fill:#2b5989;stroke-width:0.35660052;fill-opacity:1" inkscape:connector-curvature="0" d="m 0.39537578,80.46493 a 80.235119,80.235119 0 1 0 160.47023422,0 80.235119,80.235119 0 1 0 -160.47023422,0" ></path>   <path  d="m 6.8704361,80.46493 a 73.760058,73.760058 0 1 0 147.5201139,0 73.760058,73.760058 0 1 0 -147.5201139,0" inkscape:connector-curvature="0" style="fill:#ffffff;stroke-width:0.32782248"></path>   <path style="fill:#2b5989;stroke-width:0.11146249;fill-opacity:1" inkscape:connector-curvature="0" d="m 27.181084,87.0289 h 81.175586 l -37.415216,37.53242 9.689032,9.35302 53.449414,-53.4494 -53.449414,-53.44941 -9.352702,9.35333 37.078886,37.4149 H 27.181084 v 13.36235 z" ></path></svg></button></div>')),$(a.W_.$dvfrmHeader.find("td").get().reverse()).each((function(e,t){var n=$(t);""!=n.html()&&(n.contents().wrapAll('<div style="padding-left:5px;white-space:nowrap" class="align-self-center" ></div>').parent().attr("np-frm-title",n.attr("np-frm-title")).prependTo(a.W_.$dvfrmHeader),n.removeAttr("np-frm-title"))})),a.HHlpIconIsAdded=!0}t||(t=e,e=null);var r=[];n||$.each(a.$ValidXml.r.load,(function(e,t){var n=t;np.NPPkgs[n]&&!np.NPPkgs[n].Loaded&&r.push(n)})),np.IscalendarLoaded||(np.IscalendarLoaded=1,r.push("calendar")),a.NewComponentsObj={};var l=0;a.FormComponentsIdArr=[],a.FormFacisIdArr=[];var s={},d={},p=i.PreLoad?1:0;$.each(a.$ValidXml.r.n,(function(e,t){var n=a.NPGen?a.NPGen.ver:0;!p&&n<302&&("2"==t.Lan&&$("#"+a.MakeFullId(e),a.W_.$bod).addClass("IsLatin"));if("Cmp"==t.Typ&&(t.OnAC?(a.$ValidXml.r.n[e].HasDesc=!0,a.$ValidXml.r.n[e+np.ACDesc]={Typ:"_Var",Cap:"desc",Alias:a.$ValidXml.r.n[e].Alias+np.ACDesc},a.$ValidXml.r.n[e+np.ACTip]={Typ:"_Var",Cap:"tip",Alias:a.$ValidXml.r.n[e].Alias+np.ACTip},a.$ValidXml.r.n[e+np.ACDesc].Def=a.$ValidXml.r.n[e].Def,a.$ValidXml.r.n[e].Alias||(delete a.$ValidXml.r.n[e+np.ACDesc].Alias,delete a.$ValidXml.r.n[e+np.ACTip].Alias)):(a.$ValidXml.r.n[e+np.VMCmpXml]={Typ:"_Var",Cap:"CmpXml",Alias:a.$ValidXml.r.n[e].Alias+np.VMCmpXml},a.$ValidXml.r.n[e].Alias||delete a.$ValidXml.r.n[e+np.VMCmpXml].Alias)),t.d&&(t.Opt="1"),t.md&&$.each(t.md,(function(t,n){var a=n.PId,i=n.ChId,o=e,r=s[a];r=r?r.substr(0,r.length-1)+",":"[",r+='{P:"'+o+'",C:"'+i+'"}]',s[a]=r,d[o]=d[o]||[],d[o].push({PId:a,ChId:i})})),"Cmp"==t.Typ){var i=t.UrlF,o=t.UrlP,r=t.CmpId;i&&o&&!np.utils.NPLocalStorage(t.CmpType,r,"HTML")&&!a.NewComponentsObj[r]&&(a.NewComponentsObj[r]={},np.fillCmpNames(a.NewComponentsObj[r],o+"/",i),++l),r?a.FormComponentsIdArr.push(e):a.FormFacisIdArr.push(e)}}));var c=r.length,u=0,m=!1,f=function(){++u<c+l||(m||(m=!0,a.CreateViewModel(s,d)),a.AfterGetAllPkgCmp(e,(function(){t.call(a)})))};c&&$.each(r,(function(e,t){a.GetPkg(t,f)})),l&&$.each(a.NewComponentsObj,(function(e,t){a.GetComponent(e,f)})),m||(m=!0,a.CreateViewModel(s,d)),c||l||a.AfterGetAllPkgCmp(e,t)},AfterGetAllPkgCmp:function(e,t){var n=this,a=n.FormComponentsIdArr.length,i=n.FormFacisIdArr.length,o=0;if(e&&e.call(n),a||i){var r=function(){++o<a||(o-a<i?n.CreateComponent(n.FormFacisIdArr[o-a],r):t.call(n))};$.each(n.FormComponentsIdArr,(function(e,t){n.CreateComponent(t,r)})),0==a&&n.CreateComponent(n.FormFacisIdArr[0],r)}else t.call(n)},_SetValueOf_P_:function(e,t){e.P_={},$.each(t,(function(t,n){var a=t,i=n;0==a.indexOf("P_")&&(e.P_[a]=i,!0)}))},CreateComponent:function(e,t){var n,a,i,o=this,r=o.options,l=(o.element,o.W_.FrmFld[e]),s=l.Valid,d=l.Valid,p=s.UrlF,c=s.CmpId,u=0;if(r.PreLoad&&r.PreLoad.Childs&&r.PreLoad.Childs[e]?(a=r.PreLoad.Childs[e],u=1):(a={},o._SetValueOf_P_(a,d)),a.ParentCmp=o,a.IdInFather=e,a.ReadyCallBack=function(e,n){1==n.cnt&&t&&t.call(this,"success in Create:"+p)},!p){a.IsCmp=!1,a.IsFaci=!0,n='<div style="position:relative" id="'+o.MakeFullId(e)+'_W_"></div>',i=o.$np("#"+e,o.W_.$bod).html(n),a.InlineBox=l.Elem=o.$np("#"+e+"_W_",i);var m=s.FType,f=s.FId,h=s.SubFId;return a.ReturnCaption="",a.Width="auto",a.Height="auto",a.inxml=null,a.OpenInline=!0,void o.OpenNewForm(m,f,h,a)}a.IsCmp=!0,a.IsFaci=!1,a.CmpId=c,a.Usrfrm=r.Usrfrm,a.UserLvl=r.UserLvl,u||(a.P_[np.P_IDIDID]=o.MakeFullId(e)+"_W_",n=np.utils.NPLocalStorage(0,c,"HTML"),a.IsMakedFullId=n.indexOf(np.P_IDIDID)>-1,a.IdPrefix=a.IsMakedFullId?"#"+o.MakeFullId(e)+"_W_":"#",n=o.ReplaceParameter(a.P_,n,{EscapeXml:!0}),n='<div style="position:relative" id="'+o.MakeFullId(e)+'_W_">'+n+"</div>",a.AddrPath=s.UrlP+"/",a.FName=p,a.fname=a.AddrPath+a.FName);var g=function(t){if(o.W_){i=o.$np("#"+e,o.W_.$bod),u||(i.html(t),$(a.IdPrefix+"bod",i).css("overflow","visible").removeClass("ui-widget-content"),$(a.IdPrefix+"dvfrmCenter",i).css("overflow","visible"),s.OnAC&&i.attr("data-bind","BindingCmp:"+e+",Desc:"+e+np.ACDesc+",Tip:"+e+np.ACTip+',CmpId:"'+e+'"')),l.Elem=o.$np("#"+e+"_W_",i),l.WidgetName=p;var n=d.npMode;n&&(a.npMode=n),$.NPCreateWidget(l.Elem,l.WidgetName,a)}};u?g.call(o,n):(a.PreLoad={},a.PreLoad.html_core=$(n),a.PreLoad.PreId=o.MakeFullId(e)+"_W_",o.GetCmpInStr(a,(function(){g(a.PreLoad.html_core)})))},CreateDynaComponent:function(e,t){var n=this,a=e.id,i=n.$ValidXml.r.n[a]={};i.CmpId="110010",i.UrlF="BAS0245_CMP_DYNAFRM",i.UrlP="/frm/BAS0245_CMP_DYNAFRM",i.Typ="Cmp","1"==e.Req&&(i.Req="1"),n.$ValidXml.r.n[a+np.VMCmpXml]={Typ:"_Var",Cap:"CmpXml"},n.CreateViewModel(null,null,a),n.CreateComponent(a,t)},GetDynaComponent:function(e){var t="/frm/BAS0245_CMP_DYNAFRM/BAS0245_CMP_DYNAFRM",n="/frm/BAS0245_CMP_DYNAFRM/",a={CmpId:110010,CmpType:0,Js_FileName:t+".js",Html_FileName:t+".htm",Xml_FileName:t+".json",CC_Filename:n+"controlchange.htm",H_FileName:n+"usrhlp.json"};this.GetComponent(a,e)},GetComponent:function(e,t){"object"!=typeof e&&(this.NewComponentsObj[e].CmpId=e,(e=this.NewComponentsObj[e]).CmpType=e.CmpType||0),np.utils.GetComponent(e,t)},GetPkg:function(e,t){var n,a=this,i={description:""};if(!(n=np.NPPkgs[e])||!n.js||!n.css)return i.description="This Pkg is Unknown",void t.call(this,i);var o=n.js.length,r=0;if(!o)return i.description="This Pkg hasnt any js",void t.call(this,i);if(n.Loaded)return i.description="This Pkg is Loaded Before",void t.call(this,i);if(n.CallBacks)n.CallBacks.push(t);else{n.CallBacks=[],n.CallBacks.push(t);var l=np.utils.NPLocalStorage(0,1,"FORMSJS"),s=np.utils.NPLocalStorage(0,1,"PKG_CSS_"+e),d=np.utils.NPLocalStorage(0,1,"PKG_JS_"+e),p=s!==l,c=d!==l,u=n.css.length,m=0;$.each(n.css,(function(t,n){n.Loaded||a.AddStyleSheet(n.f,(function(){++m<u||np.utils.NPLocalStorage(0,1,"PKG_CSS_"+e,l)}),p),n.Loaded=!0})),$.each(n.js,(function(e,t){t.Loading=!1,t.Loaded=!1}));var f=function(t){if(++r<o)a.GetJs(n.js[r],f,c);else{var i=!0;$.each(n.js,(function(e,t){t.Loaded||(i=!1)})),n.Loaded=i,t.description=i?"Get Pkg Compeleted":"Get Pkg has error",$.each(n.CallBacks,(function(e,n){n.call(this,t)})),i||delete n.CallBacks,np.utils.NPLocalStorage(0,1,"PKG_JS_"+e,l)}};a.GetJs(n.js[r],f,c)}},GetJs:function(e,t,n){var a="";if(e||(a="no input"),e.f||(a="file not defined"),e.Loading&&(a="js in loading"),e.Loaded&&(a="js loaded before"),a)t.call(this,a);else{e.Loading=!0;var i={url:e.f,cache:!0,async:!0,dataType:"script",beforeSend:function(e){n&&($.browser.chrome||e.setRequestHeader("If-Modified-Since","Mon, 26 Jul 1997 05:00:00 GMT"),e.setRequestHeader("Cache-Control","no-cache"))},success:function(n,a){e.Loaded=!0,t.call(this,"success in get:"+e.f)},error:function(n,a,i){e.Loading=!1,t.call(this,"error in get:"+e.f)}};np.noNg((()=>$.ajax(i)))}},AddStyleSheet:function(e,t,n){var a=this;if(n){var i={url:e,cache:!0,async:!0,dataType:"text",beforeSend:function(e){$.browser.chrome||e.setRequestHeader("If-Modified-Since","Mon, 26 Jul 1997 05:00:00 GMT"),e.setRequestHeader("Cache-Control","no-cache")},complete:function(n,i){a.AddStyleSheet_Core(e),t&&t.call(this)}};np.noNg((()=>$.ajax(i)))}else a.AddStyleSheet_Core(e)},AddStyleSheet_Core:function(e){document.createStyleSheet?document.createStyleSheet(e):$("head").append('<link href="'+e+'" type="text/css" rel="Stylesheet" />')},BeforeBinding:function(){},ShowACData:function(e,t,n){var a=this,i=(a.options,a.element,a.W_.FrmFld[e].Valid.OnAC),o=a.W_.FrmFld[e].Valid.OnACSMC;if(i){n&&(t.IsHelp=!0,t.MaxHlp=t.MaxHlp||200,t.HelpId=a.MakeFullId(e));var r=function(){return a._trigger(i,null,t)};if(!n||!o)return t.NotRunFromShowMore=!1,r.call(this);t.NotRunFromShowMore=!0,a._trigger(o,null,{CallBack:r,Params:t})}},CreateViewModelFinal:function(){var e=this,t=e.options,n=e.element,a=e.$ValidXml.r;e.W_.RAttrOfValidation={},$.each(a,(function(t,n){e.W_.RAttrOfValidation[t]=n})),e.UseModeCode=1;var i=a.MChanger;e.NPGen=a.NPGen,i||(i=""),e.MChanger=i,e.CreateHlpInOut_Act(),e.ViewModel.vm_bod=e.Get$bod().parent(),e.ViewModel.vm_rst=e.ViewModel,e.ViewModel.vm_npform=e,$.each(e.W_.FrmFld,(function(n,a){var i,o;if(a.Valid.Typ&&"Check"==a.Valid.Typ){var r=e.GetFldElem(n);if(0!=$(r).next("label").length){var l=$(r).next("label");l.attr("for")||l.attr("for",$(r).attr("id")),$(r).hide().wrap("<div class='checkbox checkbox-success' style='display:inline;white-space:nowrap;margin:0px'></div>"),$(r).parent().append(l)}}if(!a.Valid.Typ||"Radio"!=a.Valid.Typ||"1"!=a.Valid.SimpleRadio&&"1"!=a.Valid.BreakRadio){if(a.Valid.Typ&&"Radio"==a.Valid.Typ){s="<label class='btn btn-outline-primary' style='border:1px dashed;height:24px' data-bind=\"css:{'active':$root."+n+'()==val} "><input type="radio" data-bind="enable:$root[\''+n+"_Enable'],attr: {id:$root.vm_FullId('"+n+"')+'_'+val, value: val , name:$root.vm_FullId('"+n+"')}, checked: $root."+n+"\" /><label data-bind=\"attr:{'for':$root.vm_FullId('"+n+"')+'_'+val}, html:dsc\" ></label></label>";(r=e.GetFldElem(n)).addClass("btn-group").attr("data-toggle","buttons").attr("data-bind","foreach: "+n+"_OPT").html(s)}else if(a.Valid.Opt&&"1"==a.Valid.Opt){o=i=(r=e.GetFldElem(n))&&r.attr("data-bind"),a.Valid.OptEq&&(o=o.replace(/options:\w*_OPT/g,"options:"+a.Valid.OptEq+"_OPT")),i&&-1==i.indexOf("foreach")&&-1==i.indexOf("attr:{")&&!r.attr("title")&&(o=o+",attr:{title:$root.vm_ValText($data,$context,'"+n+"')}"),i!=o&&r.attr("data-bind",o)}}else{var r=e.GetFldElem(n),s="<input type=\"radio\" style='margin-right:5px;margin-left:5px' data-bind=\"enable:$root['"+n+"_Enable'],attr: {id:$root.vm_FullId('"+n+"')+'_'+val, value: val , name:$root.vm_FullId('"+n+"')}, checked: $root."+n+"\" /><label style='display:inline;' data-bind=\"attr:{'for':$root.vm_FullId('"+n+"')+'_'+val}, html:dsc\" ></label>";"1"==a.Valid.BreakRadio&&(s+="<br/>"),r.addClass("btn-group").attr("data-bind","foreach: "+n+"_OPT").html(s)}var d=a.Valid.Act;d&&(r=e.GetFldElem(n)).attr("np-act",d);if(a.Valid.SAC&&a.Valid.Dat&&(a.Valid.OnAC=1),a.Valid.OnAC&&!a.Valid.CmpId){a.Valid.IsAC=!0;r=e.GetFldElem(n);var p=a.Valid.MSAutoC,c=a.Valid.OnACRFR,u=a.Valid.SAC,m=a.Valid.MaxHlp,f=a.Valid.SingleS,h=a.Valid.Ltl,g=a.Valid.BoxWidth,C=a.Valid.SCol,v=a.Valid.disabled,b=a.Valid.TipCol,_=a.Valid.Dat,F=a.Valid.KCol;i="npAutoComplete:"+n+",valueUpdate:'afterkeydown'"+(p&&"0"!=p?",MSAutoC:"+p:"")+",ACOptions:{Cmpid:'"+n+"',ACid:'"+n+"',vm_npform:vm_npform,appendTo:vm_bod,rst:["+e.Acts["act"+d].rst+"],csq:["+e.Acts["act"+d].csq+"],ActNo:'"+d+"'"+(u?",SAC:'"+u+"'":"")+(m?",MaxHlp:'"+m+"'":"")+(f?",SingleS:'"+f+"'":"")+(g?",BoxWidth:'"+g+"'":"")+(C?",SCol:'"+C+"'":"")+(v?",disabled:"+(1==v?"true":"false"):"")+(h?",Ltl:'"+h+"'":"")+(_?",Dat:'"+_+"'":"")+(b?",TipCol:'"+b+"'":"")+(F?",KCol:'"+F+"'":"")+(c?",NPRender:"+n+"_Ren":"")+"}",c&&(e.ViewModel[n+"_Ren"]=t[c]),r.attr("data-bind",i)}})),e._trigger("CreateViewModel"),e.BeforeBinding(),e.IsBindingInProgress=!0,a.DontApplyBinding||ko.applyBindings(e.ViewModel,n[0]),e.IsBindingInProgress=!1,e.StartValidationCheck(),e.$ValidXml.r.NoAuth&&e.ReFillLookup(),$.each(e.W_.FrmFld,(function(t,n){"Cmp"==n.Valid.Typ&&110025==n.Valid.CmpId&&n.Valid.SAC&&"1"==n.Valid.SAC&&(e.$ValidXml.r.NoAuth?e.$ValidXml.r.NoAuthSAC="1":(e.$ValidXml.r.AuthSAC="1",$.each(n.WidgetSelf.W_.FrmFld,(function(e,t){t.Valid.IsAC&&(n.Valid.npAutoCompleteWidget=t.Elem.npAutoComplete("instance"))}))))})),$.each(e.W_.FrmFld_Htm,(function(t,a){var i=a.Valid,o=i.Typ;if("Htm"==o||"SHtm"==o){$("label[for='"+e.MakeFullId(t)+"']",n).each((function(n,a){$(a).prop("for",e.MakeFullId(t)+"_Editor")}));var r=i.Lan;r&&"Htm"==o&&e.GetFldElem(t).each((function(e,t){$.data(t,"cleditor").ChangeLang(2==r?"latin":1==r?"farsi":"both")}))}})),e.SetDatePickers(),$.each(e.W_.FrmFld_Grd,(function(t,n){var a=n.Valid,i=a.Act;i&&(e.$ValidXml.r.acts["act"+i].help="0");var o,r,l,s={npform:e,IsNotHelp:!0,DefaultNoRadif:!0,ActNo:a.Act,MaxRowId:a.MaxRowId,NoRowColor1:!(!a.NoRowColor1||"1"!=a.NoRowColor1),NoRowColor2:!(!a.NoRowColor2||"1"!=a.NoRowColor2),NoRowColor3:!(!a.NoRowColor3||"1"!=a.NoRowColor3),NoTdPadding:!(!a.NoTdPadding||"1"!=a.NoTdPadding),NoShowHeader:!(!a.NoShowHeader||"1"!=a.NoShowHeader),StopSort:!(!a.StopSort||"1"!=a.StopSort)},d=null;(o=a.Switch)&&((d=d||{}).Switch=o),n.Valid.mode&&$.each(n.Valid.mode,(function(e,t){(d=d||{}).All=d.All||[];var n=d.All[e]={};(r=t.id)&&(n.Mode=r),n.ModeXml=t,(l=t.DisableF)&&(n.DisableF=l.split(","))})),d&&(s.Modes=d),e.CreateNPGrid(n.Valid,s,e.GetFldElem(t))}));var o,r,l=a.CmpState;if(l&&(e.CmpStateId=l,e.CmpStateVal=e.ViewModel[l](),e.ViewModel[l].subscribe((function(t){e.CmpStateVal=t||"",e.InitFrm_Core()}))),e.MChanger?(e.FMod=e.ViewModel[e.MChanger](),e.ViewModel[e.MChanger].extend({notify:""}).subscribe((function(t){e.FMod_Changed()})),e.UseModeCode||e.FMod_Changed()):e.FMod=0,e._trigger("AfterLoad"),o=t.inxml&&t.inxml.doact&&"0"==t.inxml.doact.act00,r=t.inxml&&t.inxml.doact&&t.inxml.doact.act,o||(o="0"==a.Act00),o&&t.CmpId){var s={NoAct00:!0};e.ActNo=s.ActNo="00",s.ErLen=e.ErLen=0,s.WarLen=e.WarLen=0,e.CalcModeCode("00",0),e._XML2ViewModel(t.inxml,{NoAct00:!0}),np.noNg((()=>e.Get_Data_Core(0,s))),r?np.noNg((()=>e.DoAct(r,null,{RunInQueue:!0}))):(e.CalcModeCode("00",0),t.ParentCmp||e.InitFrm())}else//!op.CmpId==>in first form must doact00 for get oaut
e.DoAct("00",null)},MakeFullId:function(e){return this.ContId+e},MakeOrgId:function(e){return e&&e.substring(this.ContId.length,e.length)},SetDatePickers:function(){var e=this;$.each(e.W_.FrmFld_PDat,(function(t,n){var a=n.Valid.Fro?n.Valid.Fro.substring(0,4):"1300",i=n.Valid.To?n.Valid.To.substring(0,4):"1420";e.GetFldElem(t).parent()&&"TD"==e.GetFldElem(t).parent()[0]?.tagName&&e.GetFldElem(t).css("width","80px");var o="",r=!1;e.GetFldElem(t).datepicker({dateFormat:"yy/mm/dd",changeYear:!0,yearRange:a+":"+i,showOn:"button"==n.Valid.ShowOn?"button":"focus",buttonImage:"../../img/calendar.gif",buttonImageOnly:!0,buttonText:"",beforeShow:function(e,t){if($(this).prop("readonly"))return!1;$("body").on("scroll",(function(){t.dpDiv.css({top:$(e).offset().top+t.input.outerHeight()})})),np.noNg((()=>setTimeout((function(){t.dpDiv.css({top:$(e).offset().top+t.input.outerHeight()}),t.dpDiv.offset().top+t.dpDiv.outerHeight()+document.body.scrollTop>document.body.scrollHeight&&(r=!0,o=$(e).css("margin-bottom"),$(e).css("margin-bottom",t.dpDiv.outerHeight()))}),0)))},onClose:function(e,t){r&&t.input.css("margin-bottom",o)}})})),$.each(e.W_.FrmFld_GDat,(function(t,n){var a=n.Valid.Fro?n.Valid.Fro.substring(0,4):"1900",i=n.Valid.To?n.Valid.To.substring(0,4):"2040";e.GetFldElem(t).datepicker({dateFormat:"yy/mm/dd",calendar:Date,changeYear:!0,yearRange:a+":"+i,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["January","February","March","April","May","June","July","August","September","October","November","December"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],showOn:"button"==n.Valid.ShowOn?"button":"focus",buttonImage:"../../img/calendar.gif",buttonText:"",buttonImageOnly:!0,beforeShow:function(e,t){if($(this).prop("readonly"))return!1}})}));var t=$("#ui-datepicker-div");t.length&&(parBox=t.parent(),parBox.length&&!parBox.hasClass("np5ht7")&&t.wrap('<div np5ht7 class="np5ht7"/>'))},OpenWaitingDialog:function(e){},CloseWaitingDialog:function(){},$np:function(e,t){var n,a,i=e;return(n=i.indexOf("#"))>=0&&(a=i.substring(n+1,i.length),i=i.substring(0,n)+"#"+this.MakeFullId(a)),$(i,t)},GetFrmFld:function(e){return this.W_.FrmFld[e]},GetCmpSelf:function(e){var t=this.W_.FrmFld[e];return!t.WidgetSelf&&t.Elem&&t.WidgetName&&(t.WidgetSelf=np.utils.GetWidgetSelf(t.Elem,t.WidgetName)),t.WidgetSelf},Xml2Obj:function(e){var t={};return $.each(e[0].attributes,(function(e,n){t[n.name]=n.value})),t},_Init_SndXML:function(e){var t=this,n=(t.options,e&&e.NavType||"");if("nav"==n)t._SndNavXML=null,t._SndNavXML={...t.AutXml()},t._SndNavXML.rp&&(t._SndNavXML.rp={...t._SndNavXML.rp},delete t._SndNavXML.rp.seq);else if("logout"==n)t._SndNavXML=null,t._SndNavXML={...t.AutXml()};else{if(e.AnotherSvc||(t._SndXML=null),t.$ValidXml.r.NoAuth)return void(t._SndXML={r:{}});t._SndXML={...t.AutXml(),r:t._SndXML?t._SndXML.r:{}}}},OpenerTicketSelf:function(){var e=this.options;return e.OpenerTicketSelf||e.OpenerSelf},SetAutByResp:function(e,t){var n,a=this,i=e?.t;if(i&&a.setTicket(i),t){var o={rp:{...e.oaut?.rp,sp:{...e.oaut?.sp}}};a.GetngData().AngularTab?.setDataByUrl(o),(n=o.rp).sp.UsrType=n.sp.UsrType||localStorage.getItem("ut"),n.ut=n.sp.UsrType,n.b=n.sp.BrnNo,n.sp=JSON.stringify(n.sp),n.sid=localStorage.getItem("sid");var r=a.AutXml().rp;r&&(delete r.fop,delete r.foh)}else(n={...a.AutXml().rp}).fop=e?.oaut?.rp?.fop,n.foh=e?.oaut?.rp?.foh,n.fop||e?.oaut?.rp?.fop,n.foh||e?.oaut?.rp?.foh,a.AutXml().rp=n;return n},GetngData:function(){var e=this.options;return(e.IsCmp||e.IsFaci)&&e.ParentCmp?e.ParentCmp.GetngData():e.UseOpenerAut?this.OpenerTicketSelf().GetngData():e.ngData||e?.OpenerSelf?.GetngData()},AutUT:function(){return this.AutXml().rp.ut},RunDoActInQueueCnt:function(e){var t=this,n=t.options;return n.IsCmp&&n.ParentCmp?n.ParentCmp.RunDoActInQueueCnt(e):n.UseOpenerAut?t.OpenerTicketSelf().RunDoActInQueueCnt(e):!!t.W_&&("inc"==e&&t.W_.RunDoActInQueue++,"dec"==e&&t.W_.RunDoActInQueue--,t.W_.RunDoActInQueue)},IsFreezServer:function(){var e=this,t=e.options;return t.IsCmp&&t.ParentCmp?t.ParentCmp.IsFreezServer():t.UseOpenerAut?e.OpenerTicketSelf().IsFreezServer():e.FreezServer},SetFreezServer:function(e){var t=this,n=t.options;return n.IsCmp&&n.ParentCmp?n.ParentCmp.SetFreezServer(e):n.UseOpenerAut?t.OpenerTicketSelf().SetFreezServer(e):(t.FreezServer=!!e,t.SetWebBusy(e))},SetWebBusy:function(e){var t=this,n=t.options;return n.IsCmp&&n.ParentCmp?n.ParentCmp.SetWebBusy(e):n.UseOpenerAut?t.OpenerTicketSelf().SetWebBusy(e):(t.WebBusy=!!e,t.ViewModel.WebBusy(!!e),t.WebBusy)},IsWebBusy:function(e){var t=this,n=t.options;if(n.IsCmp&&n.ParentCmp)return n.ParentCmp.IsWebBusy(e);if(n.UseOpenerAut)return t.OpenerTicketSelf().IsWebBusy(e);if(t.IsFreezServer())return!0;if(t.W_.TokenQueue||(t.W_.TokenQueue=[]),e){for(var a=t.W_.TokenQueue,i=0;i<a.length;i++)if(a[i].Params.Key==e)return!0;return!1}return 0!==t.W_.TokenQueue.length},_DoServer:function(e,t,n,a){var i=this,o=i.options;if(o.IsCmp&&o.ParentCmp)return o.ParentCmp._DoServer(e,t,n);if(o.UseOpenerAut)return i.OpenerTicketSelf()._DoServer(e,t,n,a||i);if(i.W_.TokenQueue||(i.W_.TokenQueue=[]),!i.W_.TokenQueue.length){var r=function(e){i.W_&&(i.WebBusy=!1,(e||i).ViewModel.WebBusy(!1),i.W_.TokenQueue=i.W_.TokenQueue.slice(1),i.W_.TokenQueue.length>0&&(i.WebBusy=!0,(i.W_.TokenQueue[0].RealSelf||i).ViewModel.WebBusy(!0),i.W_.TokenQueue[0].CB(r,!0,i.W_.TokenQueue[0].RealSelf)))};return i.WebBusy=!0,(a||i).ViewModel.WebBusy(!0),i.W_.TokenQueue=[{CB:t,Params:n}],i.W_.TokenQueue[0].CB(r,!1,a)}return!!e&&i.W_.TokenQueue.push({CB:t,Params:n,RealSelf:a})},QueueAct:function(e,t){this._DoServer(!0,e,t)},ImmedAct:function(e,t){return this._DoServer(!1,e,t)},AutXml:function(){var e=this,t=e.options;if(t.IsCmp&&t.ParentCmp)return t.ParentCmp.AutXml();if(t.UseOpenerAut)return e.OpenerTicketSelf().AutXml();const n=localStorage.getItem("t");return e.Aut.t=n,e.Aut},getFid:function(){return this.AutXml().rp.f},getUt:function(){return this.AutXml().rp.ut},RootContId:function(){var e=this.options;return e.ParentCmp?e.ParentCmp.RootContId():e.OpenInDialog||e.OpenInline?e.OpenerSelf.RootContId():this.ContId},setTicket:function(e){this.GetngData()?.AngularTab?.setTicket?this.GetngData()?.AngularTab?.setTicket(e):localStorage.setItem("t",e)},GetAut:function(e){var t,n="";t=e?[e]:["ft","f","seq","subfrm","t","ut","act"];var a=this.AutXml();return $.each(t,(function(e,t){n=n+"  "+("t"==t||"act"==t?a[t]:a.rp[t])})),n.substr(2)},PassValueToParent:function(e,t){var n=this;e.indexOf(np.ACDesc)>1&&!n.W_.FrmFld[e.substring(0,e.indexOf(np.ACDesc))].Valid.HasDesc||e.indexOf(np.ACTip)>1&&!n.W_.FrmFld[e.substring(0,e.indexOf(np.ACTip))].Valid.HasDesc||n.Val(e)!==n.NPFix(e,t)&&n.Val(e,t)},SetRelationChildToParent:function(e,t,n){var a=this,i=a.options;a.W_.FrmFld[e].dm||(a.W_.FrmFld[e].dm=[],a.ViewModel[e].subscribe((function(t){var o,r;n&&(o=a.ViewModel[e+np.ACDesc](),r=a.ViewModel[e+np.ACTip]()),$.each(a.W_.FrmFld[e].dm,(function(e,a){n&&i.ParentCmp.PassValueToParent(a+np.ACDesc,o),n&&i.ParentCmp.PassValueToParent(a+np.ACTip,r),i.ParentCmp.PassValueToParent(a,t)}))}))),a.W_.FrmFld[e].dm.push(t)},GetHlpInsteadElem:function(){return this.element},GetHlpIn:function(e,t,n,a){var i=this,o=i.options;if(t.push(i.MakeFullId(e)),i.W_.FrmFld[e]){if(n.push(i.W_.FrmFld[e].Valid.Typ),a){var r,l,s=i.GetFldElem(e);if(s){if("Cmp"==i.W_.FrmFld[e].Valid.Typ){var d=i.W_.FrmFld[e].WidgetSelf;l=3,r=d&&d.GetHlpInsteadElem()}else l=2,(r=i.GetFldWidgetElem(e))||(r=s,l=1);r&&a.push({Elem:r,HlpElemType:l})}}var p=i.W_.FrmFld[e].dm;p&&$.each(p,(function(e,i){var r=o.ParentCmp.MakeFullId(i);-1==t.indexOf(r)&&o.ParentCmp.GetHlpIn(i,t,n,a)}));var c=i.W_.FrmFld[e].md;c&&$.each(c,(function(e,o){var r=i.GetCmpSelf(o.P).MakeFullId(o.C);-1==t.indexOf(r)&&i.GetCmpSelf(o.P).GetHlpIn(o.C,t,n,a)}))}},Reset:function(e){var t=this,n=(t.options,t.element,t.ActNo);t.W_.$dvfrmCenter[0].scrollLeft=t.W_.$dvfrmCenter[0].offsetWidth,e||(t.ActNo="00",t.CalcModeCode(t.ActNo,0),t.ResizeHandler()),t.IsBindingInProgress=!0,t.InternalChg_OnSubs=!0;try{$.each(t.W_.FrmFld,(function(a,i){var o=a,r=i.Valid.Typ,l=i.Valid.Def;switch(void 0===l&&(l=""),r){case"Cmp":t.GetFldElem(o);"$"!=l&&(e||i.WidgetSelf.Reset(e),t.Val(o,l),i.Valid.XmlDef=i.Valid.XmlDef||i.Valid.P_XmlDef,i.Valid.XmlDef&&t.Val(o+np.VMCmpXml,i.Valid.XmlDef));break;case"Grd":"00"!==n&&"$"!=l&&t.GetFldElem(o).npgrid("refresh","<Root/>");break;default:"$"==l||e&&""==l||t.Val(o,l)}}))}finally{t.InternalChg_OnSubs=!1,t.IsBindingInProgress=!1}},ResetClick:function(e){var t=this;t.IsWebBusy()||(t.ClearRespmsg(),t.Reset(e),t.InitFrm())},Get_Data_Core:function(e,t){var n=this,a=n.options;a.ReturnActParam=null,t=t||{},n.fromdash=!1;var i=n.W_.Alias2Id.F77771;if("00"==t.ActNo&&i){var o=n.Val(i);if(""!=o&&(n.fromdash=!0,o=o.split("@@"),n.Val(i,o[0]),o[1])){n.fromdashact=o[1];var r=n.W_.Alias2Id.F00111;r&&n.Val(r,o[1])}}n.Get_Data(e,t),n.RequireInitFrm&&n.InitFrm(!0),a.ParentCmp&&!n.WebBusy&&0==n.ReadyCallBack_cnt&&(++n.ReadyCallBack_cnt,n._trigger("ReadyCallBack",null,{cnt:n.ReadyCallBack_cnt})),a.ReturnActParam&&n._trigger("AfterAct",null,a.ReturnActParam),t.AfterAct&&t.AfterAct(t.ErLen)},IntroHelp:function(e){var t,n=this;n.options;if(n.parsedHelpJson){if(n.parsedHelpJson.forEach((e=>{e.mode==n.ModeCode&&(t=e.h)})),!t)return;for(var a=0;a<t.length;a++)t[a].gid&&(t[a].element="#"+n.MakeFullId(t[a].gid)),e?(t[a].hint=t[a].intro,t[a].hintPosition=t[a].position):t[a].position=t[a].position}n.intro||(n.intro=introJs());try{n.intro.onexit((()=>{n.W_.$dvfrmFooter.css({position:"sticky"})})),n.intro.onskip((()=>{n.W_.$dvfrmFooter.css({position:"sticky"})})),n.intro.onstart((()=>{n.W_.$dvfrmFooter.css({position:"static"})}))}catch(e){}n.intro.setOptions({nextLabel:"بعدی",prevLabel:"قبلی",doneLabel:"پایان",hintButtonLabel:"بستن"}),e?n.intro.setOptions({hints:t}):n.intro.setOptions({steps:t}),e?n.intro.addHints():n.intro.start()},ClearRespmsg:function(){var e=this,t=e.options;t.ParentCmp?t.ParentCmp.ClearRespmsg():t.HideFooter?t.OpenerSelf.ClearRespmsg():(e.W_.ClearShowErrorBox_TimeOut&&(np.noNg((()=>clearTimeout(e.W_.ClearShowErrorBox_TimeOut))),e.W_.ClearShowErrorBox_TimeOut=null),e.GetngData()?.AngularTab?.clearRespmsg&&np.byNg((()=>e.GetngData().AngularTab.clearRespmsg())),t.OpenInline&&t.OpenerSelf.GetngData()?.AngularTab?.clearRespmsg&&np.byNg((()=>t.OpenerSelf.GetngData().AngularTab.clearRespmsg())))},SetRespmsg:function(e){var t,n=this,a=n.options;if(a.ParentCmp)return t=a.ParentCmp.SetRespmsg(e),n.ErLen=t?.ErLen,n.WarLen=t?.WarLen,t;if(a.HideFooter)return t=a.OpenerSelf.SetRespmsg(e),n.ErLen=t?.ErLen,n.WarLen=t?.WarLen,t;return n.ErLen=0,n.WarLen=0,$.each(e.c,(function(e,t){"0"!=t.m[0].e&&0,$.each(t.m,(function(e,t){n.ErLen+="2"==t.e?1:0,n.WarLen+="1"==t.e?1:0;var a=t.m.indexOf("::");a>0&&(t.m=t.m.substring(0,a))}))})),n.GetngData()?.AngularTab?.setRespmsg?np.byNg((()=>n.GetngData().AngularTab.setRespmsg(e))):a.OpenInline&&a.OpenerSelf.GetngData()?.AngularTab?.setRespmsg&&np.byNg((()=>a.OpenerSelf.GetngData().AngularTab.setRespmsg(e))),{ErLen:n.ErLen,WarLen:n.WarLen}},DoActServer:function(e,t,n){var a=this,i=a.options;a.element;if(!(n=n||{}).NoAuth){var o=n.AutoComplete&&i.CmpId+"_"+e,r=a.IsWebBusy(),l=a.RunDoActInQueueCnt(),s="00"==e||n.RunInQueue||l||n.AutoComplete&&a.IsWebBusy(o)||n.AutoComplete&&!r;if(a.IsFreezServer()&&(s=!1),r&&!s)return a.SetRespmsg({c:[{m:[{e:"1",m:"لطفا صبر کنید"}]}]}),a.W_.ClearShowErrorBox_TimeOut=np.noNg((()=>setTimeout((function(){a.W_&&a.ClearRespmsg()}),3e3))),!1}function d(o,r,s){var d;if(!a.W_)return o(s),!1;a.$ValidXml.r.acts["act"+e]&&(d=a.$ValidXml.r.acts["act"+e].help),d&&"1"==d&&(n.IsHelp=!0),r||l||n.NoAuth||a.ClearRespmsg(),a.ActNo=e,"00"==e&&a._XML2ViewModel(i.inxml,{inxml:!0}),a._Init_SndXML({CmpId:i.CmpId,AnotherSvc:n.AnotherSvc});const p=a._ViewModel2XML(e,n);if(a._SndXML.r.MaxHlpMaxHlp&&(a._SndXML.MaxHlp=a._SndXML.r.MaxHlpMaxHlp,delete a._SndXML.r.MaxHlpMaxHlp),!p)return n.AutoComplete&&n.Get_Data_AC&&n.Get_Data_AC(),o(s),!1;if(i.ParentCmp&&!a.$ValidXml.r.NoAuth&&(a.WebBusy=!0),!n.AnotherSvc){a.NPGen&&a.NPGen.ver;0!==i.fname.indexOf("/frmc/")?a.url=np.DomainUrl+i.fname+".svc/":a.url=np.DomainUrl+i.fname+""}var c,u,m;function f(e){for(var t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){for(var i=n[a];" "==i.charAt(0);)i=i.substring(1);if(-1!=i.indexOf(t))return i.substring(t.length,i.length)}return null}a.$ValidXml.r.NoAuth&&((u=f("Unvno"))&&(a._SndXML.Unvno=u),(m=f("Hasbranch"))&&(a._SndXML.Hasbranch=m)),a.$ValidXml.r.NoAuth&&$.each(a._SndXML.r,(function(e,t){0==t.toString().indexOf("<r><row")&&delete a._SndXML.r[e]})),c=JSON.stringify(a._SndXML);var h=a.$ValidXml.r.NoAuth?"GET":"POST",g=a.$ValidXml.r.NoAuth?""+c.replace(/\$/g,"$0").replace(/\:/g,"$1").replace(/\//g,"$2").replace(/\\/g,"$3").replace(/\*/g,"$4").replace(/\?/g,"$5").replace(/\"/g,"$6").replace(/\</g,"$7").replace(/\>/g,"$8").replace(/\|/g,"$9").replace(/\%/g,"$a"):"",C=a.url+g,v={type:h,url:C,dataType:"json",contentType:"application/json; charset=utf-8",processData:!1,async:!0,data:c,beforeSend:function(e,t){e.setRequestHeader("ngsw-bypass","true")}};if(a.$ValidXml.r.NoAuth&&delete v.data,v.complete=function(r,l){if(a.W_){if(i.ParentCmp&&(a.WebBusy=!1),"success"==l){if(a.Resp=null,"GET"==h){var d=np.utils.ResponseCache(C);d.responseText=r.responseText,d.ready||(d.ready=!0,d.callback.forEach((e=>{e(r.responseText)})),d.callback=[])}a.Resp=JSON.parse(r.responseText),a.GetngData().AngularTab?.doActResp(a.Resp),a.SetRespmsg(a.Resp.msg),n=n||{},a.ActNo=n.ActNo=e,n.ErLen=a.ErLen,n.WarLen=a.WarLen,n.UserLvl=i.UserLvl??0,n.Usrfrm=i.Usrfrm??0,0==a.UserLvl&&(a.UserLvl=n.UserLvl),a.SetAutByResp(a.Resp),a.RunDoActInQueueCnt("inc"),np.noNg((()=>a.Get_Data_Core(t,n))),a.RunDoActInQueueCnt("dec")}else n.AutoComplete&&n.Get_Data_AC&&np.noNg((()=>n.Get_Data_AC()));var p;o(s),"success"==l&&"00"==e&&i.inxml&&i.inxml.doact&&(p=i.inxml.doact.act)&&np.noNg((()=>a.DoAct(p,null,{RunInQueue:!0})))}},v.error=function(e,t,n){if(a.W_)if("rejected"==e.state()){t=e.responseText||"";a.Message({type:"alert",text:t,title:"خطا رد درخواست"})}else this._errMsg=e.responseText,alert("this._errMsg"),alert(this._errMsg)},"GET"==h){var b=np.utils.ResponseCache(C);if(b){if(b.ready){var _=b.responseText;return void np.noNg((()=>setTimeout((function(){v.complete({responseText:_},"success")}),0)))}return void b.callback.push((e=>{v.complete({responseText:e},"success")}))}np.utils.ResponseCache(C,{ready:!1,callback:[],responseText:""})}np.noNg((()=>$.ajax(v)))}if(n.NoAuth)return d($.noop,!1),!0;var p={Key:o};return p.OpenWaitingDialog=n.AutoComplete?{NoText:!0,NoDisable:!0,NoOverlay:!0}:{NoOverlay:!0},s&&r?(p.Key||(p.Key=e),a.QueueAct(d,p),!0):a.ImmedAct(d,p)},DecodeDfi:function(){this.DoAct("DF",null,{RunInQueue:!0})},CanDoAct:function(e,t){var n=this,a=n.IsWebBusy(),i=n.RunDoActInQueueCnt(),o="00"==e||t.RunInQueue||i||t.AutoComplete&&n.IsWebBusy(ACKey)||t.AutoComplete&&!a;return!(a&&!o)},DoActClient:function(e,t){var n=this;return n.CanDoAct(e,t)?0==n.CheckValAct(e)?0:(n.CalcModeCode(e,0),1):0},DoAct:function(e,t,n){var a=this;if(n=n||{},a.$ValidXml&&a.W_)return a.$ValidXml.r.acts["act"+e]?(n.MethodType=a.$ValidXml.r.acts["act"+e].MethodType,n.MethodType&&"1"!=n.MethodType?(n.myEvent=t,Ret=a.DoActClient(e,n)):(Ret=a.DoActServer(e,t,n),GlobViewModel.MsgSelf&&$.now()-GlobViewModel.LastMsgFormCalled>3e5&&GlobViewModel.MsgSelf.ReloadMessages(),GlobViewModel.LastMsgFormCalled=$.now()),Ret):void 0},SetModeCode:function(e){var t=this;return t.ModeCode=e,t.ModeCode&&(t.ModeCodeJSON=t.$ValidXml.r.modes["mod"+t.ModeCode],t.ModeCodeJSON||alert("mode "+t.ModeCode+" is not declared")),e},CalcModeCode:function(e,t){var n=this,a=n.options;if("00"==e&&a.npMode)return n.SetModeCode(a.npMode),n.ModeCode;if(0!=t&&"00"!=e)return n.ModeCode;var i=n.$ValidXml.r.acts;i||alert("acts was not declared");var o=i["act"+e];o||alert("act"+e+" was not declared");var r=o.NexMod;return r?(n.ModeCode="",selfAntiUgly=n,$.each(r,(function(e,t){var a=t.cond;if(""==a||(a="var self=selfAntiUgly;"+a)&&np.utils.eval(a))return n.ModeCode=t.mod,!1})),n.ModeCode=n.SetModeCode(n.ModeCode),n.ModeCode):n.ModeCode?n.ModeCode:void 0},CalcCheckValModeCode:function(e){var t,n=this.$ValidXml.r.acts["act"+e].ChkMod;if(n)return selfAntiUgly=this,$.each(n,(function(e,n){var a=n.cond;if(""==a||(a="var self=selfAntiUgly;"+a)&&np.utils.eval(a))return t=n.mod,!1})),t},_GetLabelOfElem:function(e){var t=this,n=t.W_.FrmFld[e].Elem;if(n){if(""!==t.W_.FrmFld[e].LabelOfElem&&!t.W_.FrmFld[e].LabelOfElem){var a=t.W_.FrmFld[e].Valid.LabelId;if(a){if("0"!=a)return t.W_.FrmFld[e].LabelOfElem=t.$np("#"+a)}else{var i,o=n.prop("tagName")||"";o=o.toUpperCase(),["TABLE","TR","TD"].indexOf(o)>-1?i="":((i=n.next("label")).length||(i=$("label",n.parent())),i.length>1&&(i=$(i[0]))),t.W_.FrmFld[e].LabelOfElem=i}}return t.W_.FrmFld[e].LabelOfElem}},_RemoveReqStar:function(e,t){var n=this;if("1"!=n.$ValidXml.r.NoReqStar&&!n.W_.FrmFld[e].Valid.NoReqStar){var a=n.W_.FrmFld[e].Elem;if(n.W_.FrmFld[e].LabelElemCmp&&"1"!=n.W_.FrmFld[e].LabelElemCmp){var i=n.W_.FrmFld[e].LabelElemCmp.text().replace(/\*/g,"");n.W_.FrmFld[e].LabelElemCmp.text(i)}else if(n.W_.FrmFld[e].IsgroupInput||(n.W_.FrmFld[e].IsgroupInput=a.hasClass("groupInput")?"1":"0"),"1"!=n.W_.FrmFld[e].IsgroupInput)if(n.W_.FrmFld[e].Type2&&"MS"==n.W_.FrmFld[e].Type2)a.npAutoComplete("Require",!1);else if("Htm"!=t)if("SHtm"!=t){var o=n.W_.FrmFld[e].ElemReqStar;o&&o.hide()}else a.npeditor("Require",!1);else a.each((function(e,t){$.data(t,"cleditor").NpSetReq(!1)}));else{var r=n._GetLabelOfElem(e);if(!r)return;i=r.text().replace(/\*/g,"");r.text(i)}}},_AddReqStar:function(e,t){var n=this;if("1"!=n.$ValidXml.r.NoReqStar&&!n.W_.FrmFld[e].Valid.NoReqStar){var a=n.W_.FrmFld[e].Elem;if(n.W_.FrmFld[e].LabelElemCmp||(n.W_.FrmFld[e].LabelElemCmp=a.data("LabelElemCmp")||"1"),"1"==n.W_.FrmFld[e].LabelElemCmp)if(n.W_.FrmFld[e].IsgroupInput||(n.W_.FrmFld[e].IsgroupInput=a.hasClass("groupInput")?"1":"0"),"1"!=n.W_.FrmFld[e].IsgroupInput)if(n.W_.FrmFld[e].Type2&&"MS"==n.W_.FrmFld[e].Type2)a.npAutoComplete("Require",!0);else if("Htm"!=t)if("SHtm"!=t){var i=n.W_.FrmFld[e].ElemReqPar,o=n.W_.FrmFld[e].ElemReqStar;if(n.W_.FrmFld[e].ElemReqIsLabel||(n.W_.FrmFld[e].ElemReqIsLabel=a.is("label")?"1":"0"),"1"!=n.W_.FrmFld[e].ElemReqIsLabel)if(i)o.css("display","inline-block");else if(n.W_.FrmFld[e].Valid.IsAC&&!n.W_.FrmFld[e].Valid.MSAutoC)i=n.W_.FrmFld[e].ElemReqPar=a.parent().wrap('<SPAN class="npRquire col-12" style="width:100%;white-space:nowrap;display:block"></SPAN>'),o=n.W_.FrmFld[e].ElemReqStar=$('<SPAN class="npRquire" style="position:absolute;white-space:nowrap;display:inline-block;top:0px;left:-7px/*loat:right*/">*</SPAN>').appendTo(i.parent());else{a=a.add($("label",a.parent())),i=n.W_.FrmFld[e].ElemReqPar=a.wrapAll('<SPAN class="npRquire col-12" style="width:100%;white-space:nowrap"></SPAN>').parent(),o=n.W_.FrmFld[e].ElemReqStar=$('<SPAN class="npRquire" style="white-space:nowrap">*</SPAN>').appendTo(i)}}else a.npeditor("Require",!0);else a.each((function(e,t){$.data(t,"cleditor").NpSetReq(!0)}));else{var r=n._GetLabelOfElem(e);if(!r)return;(l=r.text().replace(/\*/g,""))&&r.text(l+"*")}else{var l=n.W_.FrmFld[e].LabelElemCmp.text().replace(/\*/g,"");n.W_.FrmFld[e].LabelElemCmp.text(l+"*")}}},EnableField:function(e,t,n){var a,i,o,r,l,s=this;if(Array.isArray(e))$(e).each((function(e,a){s.EnableField(a,t,n)}));else if(a=s.W_.FrmFld[e].Elem){var d=a.prop("tagName")||"",p=s.W_.FrmFld[e];return o=p.Help,r=p.Req,l=p.Valid.Typ,p.LastEnable=t,p.LastReq=r,"BDO"==(d=d&&d.toUpperCase())&&$(a).attr("contenteditable",t),"Radio"==l&&s.ViewModel[e+"_Enable"](t),"DIV"==d?(r="0",a.hasClass("btn-group")&&("Radio"!=l&&(t?a.removeClass("np-state-readonly"):a.addClass("np-state-readonly")),t?$("input",a).removeAttr("disabled"):$("input",a).attr("disabled",!0),t?$("label.btn",a).removeClass("disabled"):$("label.btn",a).addClass("disabled"))):["FIELDSET","TABLE","TR","TD"].indexOf(d)>-1||("Htm"==l?a.each((function(e,n){$.data(n,"cleditor").disable(!t)})):"SHtm"==l?t?a.npeditor("enable"):a.npeditor("disable"):p.Valid.IsAC?t?a.npAutoComplete("enable"):a.npAutoComplete("disable"):a.is("input")||$(a).is("textarea")?(a.prop("readonly",!t),"checkbox"!=a[0].type&&"radio"!=a[0].type&&"text"!=a[0].type||a.prop("disabled",!t)):a.is("button")?a.toggleClass("ui-state-disabled",!t):a.is("select")?(a.prop("disabled",!t),a.attr("readonly",!t),a.toggleClass("np-select-readonly",!t),p.LastVal=s.ViewModel[e]()):(a.is("img")&&a.prop("src",a.prop("src").replace("_Focus.gif",".gif").replace("_Clicked.gif",".gif")),a.toggleClass("ui-state-disabled",!t).toggleClass("ui-button-disabled",!t),(a.is("a")||a.is("img"))&&(t?a.attr("disabled",!1):a.attr("disabled",!0)))),o&&s.W_.FrmFld[o]&&(i=s.W_.FrmFld[o].Elem)&&(s.W_.FrmFld[o].LastEnable=t,s.W_.FrmFld[o].LastReq="0",t?i.removeClass("ui-button-disabled").removeClass("ui-state-disabled").attr("disabled",!1):(i.blur().addClass("ui-button-disabled").addClass("ui-state-disabled").attr("disabled",!0),i.is("img")&&i.prop("src",i.prop("src").replace("_Focus.gif",".gif").replace("_Clicked.gif",".gif")))),t&&"0"!=r?"1"==r&&"Check"!=l&&s._AddReqStar(e,l):s._RemoveReqStar(e,l),"HLnk"!=l&&"BUTTON"!=d&&"LABEL"!=d||(t?a.removeClass("ui-button-disabled").removeClass("ui-state-disabled"):a.addClass("ui-button-disabled").addClass("ui-state-disabled")),a}},CreateHlpInOut_Act:function(){var e=this;$.each(e.$ValidXml.r.acts,(function(t,n){var a=t.substr(3,2);if(e.Acts["act"+a].HlpArrElem=[],n.hlpin&&n.hlpin.length){var i=[],o=[];$.each(n.hlpin,(function(t,n){var r=n;e.GetHlpIn(r,i,o,e.Acts["act"+a].HlpArrElem)}))}var r="",l="";n.relfield&&n.relfield.length&&$.each(n.relfield,(function(e,t){t.colD=t.colD||"",t.col=t.col||t.data||"",r+=",'"+t.id+"'",l+=",'"+(parseInt(t.colD||t.col)-1).toString()+"'"})),e.Acts["act"+a].rst=r.substr(1),e.Acts["act"+a].csq=l.substr(1)}))},CommitEnableF:function(){var e,t=this;$.each(t.W_.FrmFld,(function(n,a){"Cmp"==a.Valid.Typ?(a.WidgetSelf.ComponentReq=a.Req,a.WidgetSelf.EnableAllField=!!a.Enable,a.WidgetSelf.InitFrm_Core(),(e=a.LabelElemCmp)&&"1"!=e&&(t.Val(n)||!a.Enable||""!=$("input.ui-autocomplete-input",a.Elem).val()||$("input.ui-autocomplete-input",a.Elem)[0]===document.activeElement?e.addClass("groupInputFocus"):e.removeClass("groupInputFocus"))):(a.LastVal=t.ViewModel[n](),a.Enable==a.LastEnable&&a.Req==a.LastReq||t.EnableField(n,a.Enable),a.Valid.OnAC&&(e=t._GetLabelOfElem(n))&&(t.Val(n)||!a.Enable||""!=$(a.Elem).val()||$(a.Elem)[0]===document.activeElement?e.addClass("groupInputFocus"):e.removeClass("groupInputFocus")));if(a.Show!=a.LastShow&&null!=a.Show){a.LastShow=a.Show;var i=t._GetLabelOfElem(n),o=a.Elem;"SHtm"==a.Valid.Typ&&(o=o.parent()),"1"==a.Valid.VisibleType?(o&&o.css("visibility",a.Show?"visible":"hidden"),(e=a.LabelElemCmp)&&"1"!=e&&e.css("visibility",a.Show?"visible":"hidden"),i&&i.css("visibility",a.Show?"visible":"hidden")):(o&&o.css("display",a.Show?"":"none"),(e=a.LabelElemCmp)&&"1"!=e&&e.css("display",a.Show?"":"none"),i&&i.css("display",a.Show?"":"none"))}"1"==a.SetClear&&(a.SetClear=null,t.Val(n,""),void 0!==a.Valid.OnAC?t.ValDesc(n,""):"Cmp"==a.Valid.Typ&&a.WidgetSelf.Reset())})),t.W_.IMs&&$.each(t.W_.IMs,(function(e,n){if(n.Show){if(n.LastShow||$("#"+t.MakeFullId(e),t.W_.$dvfrmFooter).show(),n.Enable!=n.LastEnable)(t.NPGen?t.NPGen.ver:0)>303?(n.Enable||-1!=t.ViewModel.vm_DisableCommanderButtons.indexOf(e)||t.ViewModel.vm_DisableCommanderButtons.push(e),n.Enable&&t.ViewModel.vm_DisableCommanderButtons.remove(e)):$("#"+t.MakeFullId(e),t.W_.$dvfrmFooter).npButton(n.Enable?"enable":"disable");if(n.Text&&n.Text!=n.LastText&&$("#"+t.MakeFullId(e),t.W_.$dvfrmFooter).npButton("option","label",n.Text),n.Icon&&n.Icon!=n.LastIcon){var a={};a.primary=n.Icon,$("#"+t.MakeFullId(e),t.W_.$dvfrmFooter).npButton("option","icons",a)}n.LastEnable=n.Enable,n.LastText=n.Text,n.LastIcon=n.Icon}else n.LastShow&&$("#"+t.MakeFullId(e),t.W_.$dvfrmFooter).hide(),n.Enable=n.LastEnable,n.Text=n.LastText,n.Icon=n.LastIcon;n.LastShow=n.Show}))},SetFocusToFirst:function(e){this.W_.DontFocus=!e},InitFrm:function(e){var t=this;if(t.InitFrm_Core(),!(e||t.W_&&t.W_.DontFocus)){var n=t.SelectFirstElem();n&&n&&t.NPSetFocus(n,null,!0,!1)}},SelectFirstElem:function(){for(var e=this,t=null,n=e.$ValidXml.r.FirstElem,a=0,i=e.W_.FrmFld;n&&a<1e3;){var o=i[n];if(o&&o.Enable&&0!=o.Show){if(o.Valid&&"Cmp"==o.Valid.Typ)t=o.WidgetSelf.SelectFirstElem();else{var r=o.Elem?o.Elem.prop("tagName"):"";r&&["TABLE","TR","TD","DIV","SPAN","LABEL","A"].indexOf(r)<0&&o.Elem.is(":visible")&&(t=e.MakeFullId(n))}if(t)return t}n=o&&o.Valid&&o.Valid.Nex,a++}return t||$.each(i,(function(n,a){if(a.Enable&&0!=a.Show){if(a.Valid&&"Cmp"==a.Valid.Typ)t=a.WidgetSelf.SelectFirstElem();else{var i=a.Elem?a.Elem.prop("tagName"):"";(i=i&&i.toUpperCase())&&["TABLE","TR","TD","DIV","SPAN","LABEL","A"].indexOf(i)<0&&a.Elem.is(":visible")&&(t=e.MakeFullId(n))}if(t)return!1}})),t},InitFrm_Core:function(e){var t=this,n=t.options;t.RequireInitFrm=!1;var a,i,o,r=t.ComponentReq,l=e&&e.CheckValModeCodeJSON;if(a=l||t.ModeCodeJSON){i=a.defSH,o=a.defDE,t.CreateHlpInOut_Act(),$.each(t.W_.FrmFld,(function(e,a){var s=a.Valid.Req||"0";l?a.Valid.ValidExc||(a.CheckValEnable="0"!=o,a.CheckValReq=r&&"0"==r?"0":s):(a.Valid.ValidExc||(a.Req=r&&"0"==r?"0":s,a.Enable="0"!=o,a.Help&&t.W_.FrmFld[a.Help]&&(t.W_.FrmFld[a.Help].Enable="0"!=o)),!n.ParentCmp||t.EnableAllField||a.Valid.ValidExc||(a.Enable=!1),a.Show=" "==i?null:"0"!=i,a.SetClear=null,a.DisAC=null)}));var s=t.W_.FrmFld;selfAntiUgly=t,a.Cond&&$.each(a.Cond,(function(e,a){var i=a.if;(""==i||(i="var self=selfAntiUgly;"+i)&&np.utils.eval(i))&&$.each(a,(function(e,a){(!n.ParentCmp||t.EnableAllField)&&"ExcDis"==e&&$.each(a,(function(e){var t=s[e];if(!t.Valid.ValidExc){if(l)return void(t.CheckValEnable=!1);t.Enable=!1,t.Help&&s[t.Help]&&(s[t.Help].Enable=!1)}})),(!n.ParentCmp||t.EnableAllField)&&"ExcEna"==e&&$.each(a,(function(e){var t=s[e];if(!t.Valid.ValidExc){if(l)return void(t.CheckValEnable=!0);t.Enable=!0,t.Help&&s[t.Help]&&(s[t.Help].Enable=!0)}})),"ExcHide"==e&&$.each(a,(function(e){var t=s[e];l?t.Valid.ValidExc||(t.CheckValEnable=!1):t.Show=!1})),"ExcShow"==e&&$.each(a,(function(e){var t=s[e];l||(t.Show=!0)})),"ExcNReq"==e&&$.each(a,(function(e){var t=s[e];if(!t.Valid.ValidExc){if(l&&!t.Valid.ValidExc)return void(t.CheckValReq="0");t.Req="0"}})),(!r||"1"==r)&&"ExcReq"==e&&$.each(a,(function(e){var t=s[e];if(!t.Valid.ValidExc){if(l)return void(t.CheckValReq="1");t.Req="1"}})),"ExcClear"==e&&$.each(a,(function(e){var t=s[e];l||(t.SetClear="1")}))}))})),!l&&$.each(t.W_.FrmFld_StateNo,(function(e,n){var a=n.Valid.StateNo;if(e&&a&&!isNaN(a)){a=parseInt(a)-1;var i=t.CmpStateVal[a];i&&"3"==i&&(t.W_.FrmFld[e].Show=!1),i&&"4"==i&&(t.W_.FrmFld[e].Show=!0)}})),$.each(t.W_.FrmFld_Grd,(function(e,n){if("Grd"==n.Valid.Typ){var a,i,o=n.Valid.Switch;o&&(a=t.Val(o)),a&&$.each(n.Valid.mode,(function(e,t){t.id==a&&(i=t.DisableF)})),i&&$.each(i.split(","),(function(e,n){if(""!=n){var a=s[n];if(l)return void(a.CheckValEnable=!1);a.Enable=!1,a.Help&&(t.W_.FrmFld[a.Help].Enable=!1)}}))}})),!l&&$.each(t.W_.FrmFld_StateNo,(function(e,n){var a=n.Valid.StateNo;if(e&&a&&!isNaN(a)){a=parseInt(a)-1;var i=t.CmpStateVal[a];i&&"1"==i&&(t.W_.FrmFld[e].Enable=!1),i&&"2"==i&&(t.W_.FrmFld[e].Enable=!0),i&&"5"==i&&(t.W_.FrmFld[e].Req="1"),i&&"5"!=i&&(t.W_.FrmFld[e].Req=t.W_.FrmFld[e].Valid.Req)}})),l||(t.W_.IMs&&($.each(t.W_.IMs,(function(e,t){t.Show=!1})),selfAntiUgly=t,a.imgCond&&$.each(a.imgCond,(function(e,n){var a=n.if;(""==a||(a="var self=selfAntiUgly;"+a)&&np.utils.eval(a))&&$.each(n,(function(e,n){"if"!=e&&t.W_.IMs[e]&&(t.W_.IMs[e].Show=!0,n.Hidden&&(t.W_.IMs[e].Show=!1),t.W_.IMs[e].Enable="2"==n.Enable,t.W_.IMs[e].Text=n.text,t.W_.IMs[e].Icon=n.icon)}))}))),n.ParentCmp||t._UpdateCommanderButtons(),t.CommitEnableF(),n.ParentCmp||"10700"==n.CmpId||t.dvfrmCenterHeight())}},dvfrmCenterHeight:function(){},FMod_Changed:function(){var e=this;e.MChanger?e.FMod=e.ViewModel[e.MChanger]():e.FMod=0,e.CalcModeCode("00",0),e.InitFrm(),e.ResizeHandler()},Get$dvfrmCenter:function(){return this.W_.$dvfrmCenter},Get$bod:function(){var e=this.options;return e.ParentCmp?e.ParentCmp.Get$bod():e.OpenerSelf&&e.OpenInDialog?e.OpenerSelf.Get$bod():this.W_.$bod},parent$bod:function(){this.options;return this.Get$bod().parent()},GetWaitDialogParent:function(){var e=this.options;return e.ParentCmp?e.ParentCmp.GetWaitDialogParent():e.OpenerSelf&&e.OpenInDialog?e.OpenerSelf.GetWaitDialogParent():this.WaitDialogParent},GetParentCmp:function(){var e=this.options;return e.ParentCmp?e.ParentCmp.GetParentCmp():e.OpenerSelf&&e.OpenInDialog?e.OpenerSelf.GetParentCmp():this},Get_Data:function(e,t){t=t||{};var n=this,a=(n.element,n.options),i=t.IsHelp;if(n.Resp&&n.Resp.oaut&&n.Resp.oaut.oa&&n.Resp.oaut.oa.time&&GlobViewModel.vm_Time(n.Resp.oaut.oa.time),"00"!=t.ActNo||a.IsCmp||($("div.hideDvfrmCenter",n.W_.$bod).removeClass("hideDvfrmCenter").css("visibility","visible"),n.W_.$dvfrmCenter.css("overflow","")),null!==e&&"object"==typeof e&&(e=e&&e.currentTarget&&e.currentTarget.id?e.currentTarget.id:""),!e&&t.HelpId&&(e=t.HelpId),!t.NoAct00){var o=n.ModeCode;if(n.CalcModeCode(t.ActNo,n.ErLen),n._XML2ViewModel(n.Resp),n.CalcModeCode(t.ActNo,n.ErLen)){if(n.InitFrm("00"!=n.ActNo&&o==n.ModeCode),"00"==n.ActNo&&n.ResizeHandler(),t&&t.AutoComplete)t.Get_Data_AC&&t.Get_Data_AC(n._Grd[0]);else if(i){if(0==n.ErLen){var r;e&&((r=n.W_.FrmFld[n.MakeOrgId(e)].Valid).KCol=n._Grd[0].KCol||r.KCol,r.TipCol=n._Grd[0].TipCol||r.TipCol,r.id=n.MakeOrgId(e),r.MoreGridOnRowClickSelf=t.MoreGridOnRowClickSelf);var l=null,s=null;if(!n.W_.IsInMobile&&n.W_.HelpDialogs["ACT"+t.ActNo]&&n.W_.HelpDialogs["ACT"+t.ActNo].data("npgrdstruc")!=n._Grd[0].struc){var d=n.W_.HelpDialogs["ACT"+t.ActNo].npUiDialog("widget");l=d.css("top"),s=d.css("left"),n.W_.HelpDialogs["ACT"+t.ActNo].npUiDialog("close")}if(n.W_.HelpDialogs["ACT"+t.ActNo]){var p=n.W_.HelpGrids["ACT"+t.ActNo].npgrid("instance")._vm.Cols(),c=n._Grd[0].titrow&&n._Grd[0].titrow.IDNUMBERCOL;if(isNaN(c)||c==p.length)return n.W_.HelpGrids["ACT"+t.ActNo].npgrid("refresh",n._Grd[0].dat),n.W_.HelpGrids["ACT"+t.ActNo].npgrid("option","MaxRow",n._Grd[0].MaxRow),n.W_.HelpGrids["ACT"+t.ActNo].npgrid("option","UpDat",n._Grd[0].UpDat),n.W_.HelpGrids["ACT"+t.ActNo].npgrid("option","HideHeader",n._Grd[0].HideHeader),n.W_.HelpGrids["ACT"+t.ActNo].npgrid("option","HideFooter",n._Grd[0].HideFooter),n.W_.HelpGrids["ACT"+t.ActNo].npgrid("option","HideGrid",n._Grd[0].HideGrid),n.W_.HelpGrids["ACT"+t.ActNo].npgrid("option","Height",n._Grd[0].Height),n.W_.HelpGrids["ACT"+t.ActNo].npgrid("option","NoRowColor1",n._Grd[0].NoRowColor1),n.W_.HelpGrids["ACT"+t.ActNo].npgrid("option","NoRowColor2",n._Grd[0].NoRowColor2),n.W_.HelpGrids["ACT"+t.ActNo].npgrid("option","NoRowColor3",n._Grd[0].NoRowColor3),n.W_.IsInMobile?n.W_.HelpDialogs["ACT"+t.ActNo].SimpleDialog("option","title",n._Grd[0].tit):(n.W_.HelpDialogs["ACT"+t.ActNo].npUiDialog("option","title",n._Grd[0].tit).npUiDialog("SetZIndex"),n.W_.HelpDialogs["ACT"+t.ActNo].npUiDialog("SetZIndex").npUiDialog("fixTitle")),void(n._Grd=[]);!n.W_.IsInMobile&&n.W_.HelpDialogs["ACT"+t.ActNo].npUiDialog("close"),n.W_.IsInMobile&&n.W_.HelpDialogs["ACT"+t.ActNo].SimpleDialog("close")}n.W_.HelpDialogs["ACT"+t.ActNo]=$("<div />");var u,m=1;if(t.MSAutoC_npform){m=0,n._Grd[0].col='<col width = "45px">'+n._Grd[0].col,n._Grd[0].th="<tr><th>انتخاب</th>"+n._Grd[0].th.substr(4),n._Grd[0].ColAttr.CheckBox0="0"==t.SingleS_npform?"1":"2";var f=r.KCol||"C1,C2";-1==f.indexOf(",")&&(f="C1,C2"),f=f.split(",");var h=r.TipCol,g=f[0].split("C")[1],C=f[1].split("C")[1],v=h?h.split("C")[1]:g;u=function(e,t){}}n.W_.HelpGrids["ACT"+t.ActNo]=$("<table><colgroup>"+n._Grd[0].col+"</colgroup><thead>"+n._Grd[0].th+"</thead><tbody><tr><td>&nbsp;</td></tr></tbody></table>").appendTo(n.Get$bod().parent());var b=n._Grd[0].dat,_=t.term||"";if("1"==t.SAC&&""!=_){t.SCol=t.SCol||"C1,C2";var F=t.SCol.split(","),y=$("row",b).filter((function(){if("%"==t.term)return!0;var e=!1,n=this;return $.each(F,(function(a,i){if(($(n).attr(i)||"").toLowerCase().indexOf(t.term.toLowerCase())>-1)return e=!0,!1})),e}));b=$("<dat/>").append(y)}var w={CheckBox_Index_VAL:g,CheckBox_Index_DSC:C,CheckBox_Index_TIP:v,CheckBox_MS:t.MSAutoC_npform,CheckBox_SS:t.SingleS_npform,DoActParams:t,npform:n,ActNo:t.ActNo,MaxRow:n._Grd[0].MaxRow,HideHeader:n._Grd[0].HideHeader,HideFooter:n._Grd[0].HideFooter,HideGrid:n._Grd[0].HideGrid,UpDat:n._Grd[0].UpDat,InXML:b,GridCursor:"pointer",ColFirstNo:m,RowNodeName:"row",ColPrefix:"C",NewDesign:"1",width:$(window).width()/2,height:n._Grd[0].Height?n._Grd[0].Height:$(window).height()/2,DefaultCloseDialog:!0,DefaultNoRadif:!0,HelpDialog:n.W_.HelpDialogs["ACT"+t.ActNo],ColAttr:n._Grd[0].ColAttr,jsonstruc:n._Grd[0].jsonstruc,AftFilRowInternal:u,AdvSearchParams:t.AdvSearchParams,FullScreenable:0,NoRowColor1:n._Grd[0].NoRowColor1,NoRowColor2:n._Grd[0].NoRowColor2,NoRowColor3:n._Grd[0].NoRowColor3};if(n.W_.IsInMobile&&(w.width=$(window).width()),(r=r||{}).NoPaging=n._Grd[0].titrow.NoPaging||r.NoPaging,r.LinePerPage=n._Grd[0].titrow.LinePerPage||r.LinePerPage||"10",n.CreateNPGrid(r,w,n.W_.HelpGrids["ACT"+t.ActNo]),n.Get$bod().parent().removeClass("d-flex"),n.W_.HelpDialogs["ACT"+t.ActNo].data("npgrdstruc",n._Grd[0].struc).addClass("np-dialog-nopad-noscroll").appendTo(n.Get$bod().parent()).append(n.W_.HelpGrids["ACT"+t.ActNo].npgrid("Container")),n.W_.IsInMobile)n.W_.HelpDialogs["ACT"+t.ActNo].SimpleDialog({title:n._Grd[0].tit,appendTo:n.Get$bod().parent(),close:function(){n.W_.HelpGrids["ACT"+t.ActNo]&&n.W_.HelpGrids["ACT"+t.ActNo].remove(),delete n.W_.HelpGrids["ACT"+t.ActNo],n.W_.HelpDialogs["ACT"+t.ActNo]&&n.W_.HelpDialogs["ACT"+t.ActNo].remove(),delete n.W_.HelpDialogs["ACT"+t.ActNo]}}),n.W_.HelpDialogs["ACT"+t.ActNo].SimpleDialog("show");else{n.W_.HelpDialogs["ACT"+t.ActNo].npUiDialog({appendTo:n.Get$bod().parent(),width:$(n.W_.HelpGrids["ACT"+t.ActNo].npgrid("Container")).outerWidth(!0)+7,title:n._Grd[0].tit,IsHelp:!0,beforeClose:function(){},open:function(){},close:function(){n.W_.HelpGrids["ACT"+t.ActNo]&&n.W_.HelpGrids["ACT"+t.ActNo].remove(),delete n.W_.HelpGrids["ACT"+t.ActNo],n.W_.HelpDialogs["ACT"+t.ActNo]&&n.W_.HelpDialogs["ACT"+t.ActNo].remove(),delete n.W_.HelpDialogs["ACT"+t.ActNo]},resize:function(e,a){var i=$(this).parent(),o=$(".ui-dialog-titlebar",i)?$(".ui-dialog-titlebar",i).outerHeight():30,r=a.size.height-o,l=a.size.width;n.W_.HelpGrids["ACT"+t.ActNo].npgrid("option","width",l).npgrid("option","height",r).npgrid("ReCalcDim",l,r)}});var A=n.W_.HelpDialogs["ACT"+t.ActNo].npUiDialog("widget");s&&(A.css("top",l),A.css("left",s)),"1"!=n._Grd[0].HideGrid&&"1"!=n._Grd[0].HideFooter&&"1"!=n._Grd[0].HideHeader||n.W_.HelpDialogs["ACT"+t.ActNo].npUiDialog("option",{minHeight:0,contentMarginBottom:"10px"})}n.Get$bod().parent().addClass("d-flex")}}else n._Grd.length>0&&$(n._Grd).each((function(e,t){var a,i,o=$("#"+n.MakeFullId(t.id));if(o.length>0)if(t.struc&&t.struc!=o.data("npgrdstruc")){o.npgrid("destroy").hide().html("<colgroup>"+t.col+"</colgroup><thead>"+t.th+"</thead>"),o.data("npgrdstruc",t.struc);var r=n.W_.FrmFld[t.id],l=r.Valid;r.WidgetElem=null;var s,d,p,c={RowNodeName:"row",ColPrefix:"C",ColFirstNo:1,InXML:t.dat,ColAttr:t.ColAttr,jsonstruc:t.jsonstruc,npform:n,DefaultNoRadif:!0,ActNo:l.Act,MaxRowId:l.MaxRowId,NoRowColor1:!(!l.NoRowColor1||"1"!=l.NoRowColor1),NoRowColor2:!(!l.NoRowColor2||"1"!=l.NoRowColor2),NoRowColor3:!(!l.NoRowColor3||"1"!=l.NoRowColor3),NoTdPadding:!(!l.NoTdPadding||"1"!=l.NoTdPadding),NoShowHeader:!(!l.NoShowHeader||"1"!=l.NoShowHeader)},u=null;if((s=l.Switch)&&((u=u||{}).Switch=s),r.Valid.mode&&$.each(r.Valid.mode,(function(e,t){(u=u||{}).All=u.All||[];var n=u.All[e]={};(d=t.id)&&(n.Mode=d),n.ModeXml=t,(p=t.DisableF)&&(n.DisableF=p.split(","))})),u&&(c.Modes=u),delete r.Valid.col,r.Valid.NoPaging=n._Grd[0].titrow.NoPaging||r.Valid.NoPaging,r.Valid.LinePerPage=n._Grd[0].titrow.LinePerPage||r.Valid.LinePerPage,n.CreateNPGrid(r.Valid,c,n.GetFldElem(t.id)),f=l.MaxRowId){var m=n.Val(f);o.npgrid("option","MaxRow",m)}}else{var f;if(o.npgrid("option","jsonstruc",t.jsonstruc),(a=o.npgrid("option","RId"))&&(i=n.Val(a)),o.npgrid("refresh",t.dat,i),f=n.W_.FrmFld[t.id].Valid.MaxRowId){m=n.Val(f);o.npgrid("option","MaxRow",m)}}}));n._Grd=[],n.$ValidXml.r.FindAfterInsert&&"09"==n.ActNo&&"2"==n.FMod&&0==n.ErLen&&(n.ViewModel[n.MChanger]("4"),n.DoAct("08"))}}},DisableFindAfterInsert:function(){this.$ValidXml.r.FindAfterInsert=!1},CloseHelpDialog:function(e){-1==e.indexOf("ACT")&&(e="ACT"+e),e&&this.W_.HelpDialogs[e]&&(!this.W_.IsInMobile&&this.W_.HelpDialogs[e].npUiDialog("close"),this.W_.IsInMobile&&this.W_.HelpDialogs[e].SimpleDialog("close"))},IsVisibleHelpDialog:function(e){return-1==e.indexOf("ACT")&&(e="ACT"+e),!!(e&&this.W_.HelpDialogs[e]&&this.W_.HelpDialogs[e].is(":visible"))},CloseAllHelpDialog:function(){var e=this;$.each(this.W_.HelpDialogs,(function(t,n){!e.W_.IsInMobile&&n.npUiDialog("close"),e.W_.IsInMobile&&n.SimpleDialog("close")}))},_XML2ViewModel:function(e,t){var n=this,a=n.options,i=t&&t.SetByMd;if(!!t&&t.NoAct00&&!n.RunResetBeforeForAct00){n.RunResetBeforeForAct00=!0,n.Reset(!0);var o=!0}if(e){var r=!!t&&t.SetInParam,l=!!t&&t.NoInternalChg_OnSubs;n.InternalChg_OnSubs=!l,e.rset&&e.rset.grd&&$.each(e.rset.grd,(function(e,t){var a;try{a=$("grd",$.parseXML('<?xml version="1.0" encoding="utf-8"?>'+t.xml))}catch(e){a=$("grd",$.parseXML('<?xml version="1.0" encoding="utf-8"?><grd/>'))}var i,o,r,l=a.attr("id"),s={},d=null,p=$("dat",a),c="",u="",m="",f={};t.struc?(o=JSON.parse(t.struc),f.IDTITLE=o.IDTITLE,f.NoPaging=o.NoPaging,f.LinePerPage=o.LinePerPage,f.KCol=o.KCol||o.KCOL,f.TipCol=o.TipCol||o.TIPCOL,f.IDNUMBERCOL=o.Cols.length,$.each(o.Cols,(function(e,t){var n=e+1;f["IDWIDTH"+n]=t.Width,f["IDCOLUMN"+n]=t.Caption||"",f["COLTOPTITLE"+n]=t.TopTitle,f["COLSPAN"+n]=t.ColSpan,f["ALIGN"+n]=t.Align,f["SHOWTAG"+n]=t.ShowTag,f["MULTILINE"+n]=t.Multiline,f["COLTYPE"+n]=t.ColType,f["DIR"+n]=t.Dir,f["FilterType"+n]=t.FilterType,f["SHOWLABEL"+n]=t.ShowLabel,f["ColMdWidth"+n]=t.ColMdWidth,f["ColXsWidth"+n]=t.ColXsWidth,f["NAME"+n]=t.Name,f["Hide"+n]=t.Hide,f["HideIfEmpty"+n]=t.HideIfEmpty,f["NexCol"+n]=t.NexCol,f["NexRow"+n]=t.NexRow,f["CB"+n]=t.CB,f["NOY"+n]=t.NOY,f["Typ"+n]=t.Typ,f["CurLang"+n]=t.CurLang,f["Fro"+n]=t.Fro,f["To"+n]=t.To,f["Max"+n]=t.Max,f["Min"+n]=t.Min,f["Lan"+n]=t.Lan,f["Fil"+n]=t.Fil,f["Jus"+n]=t.Jus,f["inputmode"+n]=t.inputmode}))):(r=$("tit>row",a)).length&&(r=r[0])&&$.each(r.attributes,(function(e,t){var n=t.name.toUpperCase();n=n.replace("HIDE","Hide").replace("KCOL","KCol").replace("TIPCOL","TipCol").replace("GRID","Grid").replace("FOOTER","Footer").replace("HEADER","Header").replace("NOPAGING","NoPaging").replace("LINEPERPAGE","LinePerPage"),f[n]=t.value}));try{d=f.IDTITLE;for(var h=0,g=1;g<=f.IDNUMBERCOL;g++){c+='<col width = "'+f["IDWIDTH"+g]+'px">';var C=f["COLSPAN"+g],v="",b=' rowspan="2"';C&&(v=' colspan="'+C+'"',h=parseInt(C),u+="<th"+v+">"+(f["COLTOPTITLE"+g]||f["IDCOLUMN"+g])+"</th>"),h>0?(b="",h--,m+="<th>"+f["IDCOLUMN"+g]+"</th>"):u+="<th"+b+v+">"+(f["COLTOPTITLE"+g]||f["IDCOLUMN"+g])+"</th>",(i=f["ALIGN"+g])&&(s["ALIGN"+g]=i,s["DIR"+g]="LEFT"==i.toUpperCase()?"ltr":"rtl"),(i=f["COLTYPE"+g])&&(s["COLTYPE"+g]=i),(i=f["SHOWTAG"+g])&&(s["SHOWTAG"+g]=i),(i=f["SHOWLABEL"+g])&&(s["SHOWLABEL"+g]=i),(i=f["ColMdWidth"+g])&&(s["ColMdWidth"+g]=i),(i=f["ColXsWidth"+g])&&(s["ColXsWidth"+g]=i),(i=f["MULTILINE"+g])&&(s["MULTILINE"+g]=i),(i=f["DIR"+g]||f["IDDIRECTION"+g])&&(s["DIR"+g]=i),(i=f["IDDIRECTION"+g])&&(s["NOLATIN"+g]="1"),(i=f["NAME"+g])&&(s["NAME"+g]=i),(i=f["Hide"+g])&&(s["Hide"+g]=i),(i=f["HideIfEmpty"+g])&&(s["HideIfEmpty"+g]=i),(i=f["FilterType"+g])&&(s["FilterType"+g]=i),(i=f["NexCol"+g])&&(s["NexCol"+g]=i),(i=f["NexRow"+g])&&(s["NexRow"+g]=i),(i=f["CB"+g])&&(s["CB"+g]=i),(i=f["NOY"+g])&&(s["NOY"+g]=i),(i=f["Typ"+g])&&(s["Typ"+g]=i),(i=f["CurLang"+g])&&(s["CurLang"+g]=i),(i=f["Fro"+g])&&(s["Fro"+g]=i),(i=f["To"+g])&&(s["To"+g]=i),(i=f["Max"+g])&&(s["Max"+g]=i),(i=f["Min"+g])&&(s["Min"+g]=i),(i=f["Lan"+g])&&(s["Lan"+g]=i),(i=f["Fil"+g])&&(s["Fil"+g]=i),(i=f["Jus"+g])&&(s["Jus"+g]=i),(i=f["inputmode"+g])&&(s["inputmode"+g]=i)}}catch(e){}u="<tr>"+u+"</tr>",m&&(m="<tr>"+m+"</tr>"),l&&o&&(n.W_.FrmFld[l]=n.W_.FrmFld[l]||{},n.W_.FrmFld[l].ColsValid=o.Cols),n._Grd.push({id:l,tit:d,col:c,th:u+m,dat:p,titrow:f,ColAttr:s,KCol:f.KCol||f.KCOL,struc:o?JSON.stringify(f):"",jsonstruc:o,TipCol:f.TipCol||f.TIPCOL,HideHeader:f.HideHeader,HideFooter:f.HideFooter,HideGrid:f.HideGrid,Height:f.HEIGHT,NoRowColor1:f.NOROWCOLOR1,NoRowColor2:f.NOROWCOLOR2,NoRowColor3:f.NOROWCOLOR3,MaxRow:a.attr("MaxRow"),UpDat:a.attr("UpDat")})})),e.rset&&e.rset.nopt&&$.each(e.rset.nopt,(function(e,t){var a=t,i=[],o=a.id;a.val;if(o){n.IsBindingInProgress=!0;try{n.ViewModel[o+np.OPTOPT].removeAll(),$.each(a.d,(function(e,t){var n={};$.each(t,(function(e,t){n[e]=t})),""===n.val&&""===n.dsc||i.push(n)}))}finally{n.ViewModel[o+np.OPTOPT]?n.ViewModel[o+np.OPTOPT](i):alert("رکوردست خروجی که مقدار "+o+"(شناسه یکتا) را پر می کند از نوع کامبو تعریف شده است"),n.IsBindingInProgress=!1}}}));var s,d=!1;if("00"!=n.ActNo||t&&t.inxml||r||n.RunResetBeforeForAct00||(n.RunResetBeforeForAct00=!0,n.Reset(!0),n.InitFrm_Core(),d=!0),e.rset&&e.rset.n&&$.each(e.rset.n,(function(e,t){for(var a=0;a<3;a++)$.each(t,(function(e,t){var i=e,o=t;"Opt"!==i&&(0==a&&i.indexOf(np.ACDesc)>0||1==a&&i.indexOf(np.ACTip)>0||2==a&&-1==i.indexOf(np.ACDesc)&&-1==i.indexOf(np.ACTip))&&(n.IsBindingInProgress=!0,o&&(o=np.utils.NPTrim(o)),n.Val(i,o),n.IsBindingInProgress=!1)}))})),!i||n.$ValidXml.r.NoAuthSAC||n.$ValidXml.r.AuthSAC||(s=!1,e.outpar&&$.each(e.outpar,(function(e,t){var a=t&&np.utils.NPTrim(t);e=n.W_.Alias2Id[e]||n.W_.Alias2Id[e.toUpperCase()]||e,ko.isObservable(n.ViewModel[e])&&n.Val(e)!=(a||"")&&(s=!0)}))),!i||s||n.$ValidXml.r.NoAuthSAC||n.$ValidXml.r.AuthSAC){e.outpar&&$.each(e.outpar,(function(e,t){try{t&&np.utils.NPTrim(t);e=(e=n.W_.Alias2Id[e]||n.W_.Alias2Id[e.toUpperCase()]||e).replace(np.VMCmpXmlUppercase,np.VMCmpXml),n.W_.FrmFld[e]&&-1==e.indexOf(np.ACDesc)&&-1==e.indexOf(np.ACTip)&&"110025"==n.W_.FrmFld[e].Valid.CmpId&&(n.Val(e+np.ACDesc,""),n.Val(e+np.ACTip,""))}catch(e){alert("exception2")}}));for(var p=0;p<3;p++)e.outpar&&$.each(e.outpar,(function(e,t){try{var a=t&&np.utils.NPTrim(t);if(e=(e=n.W_.Alias2Id[e]||n.W_.Alias2Id[e.toUpperCase()]||e).replace(np.VMCmpXmlUppercase,np.VMCmpXml),(0==p&&e.indexOf(np.ACDesc)>0||1==p&&e.indexOf(np.ACTip)>0||2==p&&-1==e.indexOf(np.ACDesc)&&-1==e.indexOf(np.ACTip))&&ko.isObservable(n.ViewModel[e])){n.IsBindingInProgress=!0,n.Val(e,a||""),n.IsBindingInProgress=!1;var i=n.W_.FrmFld[e]&&n.W_.FrmFld[e].SubFrmBrothers;i&&$.each(i,(function(e,t){n.Val(t.idXml,a||"")}))}n.W_.FrmFld[e]&&n.W_.FrmFld[e].Valid&&"1"==n.W_.FrmFld[e].Valid.npViewer&&($(n.W_.FrmFld[e].Elem).npviewer({Binary:t}),n.W_.FrmFld[e].Valid.RO="1",$(n.W_.FrmFld[e].Elem).npviewer("ShowBinaryImage"))}catch(e){n.IsBindingInProgress=!1,alert("exception")}}))}e.outpar&&$.each(e.outpar,(function(e,t){if("_LkDfi"==e){var a={outpar:{}},i=$(t);i.length&&($.each(i[0].attributes,(function(e,t){var n=t.name.toUpperCase();-1==n.indexOf(np.ACDesc.toUpperCase())&&-1==n.indexOf(np.ACTip.toUpperCase())&&(a.outpar[n]=t.value),n.indexOf(np.ACDesc.toUpperCase())>-1&&(a.outpar[n.replace(np.ACDesc.toUpperCase(),np.ACDesc)]=t.value),n.indexOf(np.ACTip.toUpperCase())>-1&&(a.outpar[n.replace(np.ACTip.toUpperCase(),np.ACTip)]=t.value)})),n._XML2ViewModel(a))}})),d&&n._XML2ViewModel(a.inxml,{SetInParam:!0}),o&&n.InitFrm_Core(),n.InternalChg_OnSubs=!1}},FindTmplRecord:function(e,t,n){var a=null;return $.each(e,(function(e,i){if(i.idF==t&&i.idFSeq==n)return a=i,!1})),a},CheckVM2XmlRowTmpl:function(e,t,n){return!0},CheckValAct_Core:function(e,t){var n,a=this,i=(t=t||{}).ComponentReq,o=t.Ltl&&1==t.Ltl?1:0,r="",l=(n="ThisMode"==e?a.ModeCode:a.CalcCheckValModeCode(e))&&a.$ValidXml.r.modes["mod"+n];return l?(a.InitFrm_Core({CheckValModeCodeJSON:l}),$.each(a.W_.FrmFld,(function(e,t){var n;if(n=i&&"0"==i?"0":t.CheckValReq,t.CheckValEnable){var l=t.Valid.Ltl&&1==t.Valid.Ltl?1:0;if("Cmp"==t.Valid.Typ&&t.Valid.OnAC){var s=0;(d=a.Val(e))||l||o||(d=a.ValDesc(e),s=1),void 0===d&&(d=""),a.CheckVal(a.MakeFullId(e),e,d,!1,{Req:n,Desc:s})<0&&""==r&&(r=a.MakeFullId(e))}else if("Cmp"!=t.Valid.Typ||t.IsFaci){if(-1==e.indexOf(np.VMCmpXml)){var d;void 0===(d=a.Val(e))&&(d=""),a.CheckVal(a.MakeFullId(e),e,d,!1,{Req:n})<0&&""==r&&(r=a.MakeFullId(e))}}else{var p=t.WidgetSelf.CheckValAct_Core("ThisMode",{ComponentReq:n,Ltl:l});""==r&&(r=p)}}})),r):""},CheckValAct:function(e){var t;return""!==(t=this.CheckValAct_Core(e))?(this.NPSetFocus(t,null,!1,!1),0):1},GetValOfCmp:function(){return this._ViewModel2XML("Cmp")},_ViewModel2XML:function(e,t){var n,a,i,o,r,l=this;if("object"==typeof t?(r=t.RootName,a=t.MaxHlp,i=t.StdHlp):a=t,!a&&np.NOFRowHLP&&(a=np.NOFRowHLP),"Cmp"==e?(r||(r="row"),n={}):(n=l._SndXML.r,l._SndXML.act=e,i&&(n.StdHlp=i),a&&!isNaN(a)?n.MaxHlpMaxHlp=a:delete n.MaxHlpMaxHlp),"NextAct"!==e&&"Cmp"!==e&&0==l.CheckValAct(e))return 0;var s=[];if($.each(l.W_.FrmFld,(function(t,a){var i=a.Valid.Typ;if(!(a.Valid.RO&&"1"==a.Valid.RO||t.indexOf(np.VMCmpXml)>-1||a.Valid.MasterCmp)){if(l.W_.FrmFld[t+np.VMCmpXml]){var r=l.W_.FrmFld[t+np.VMCmpXml].SubFrmBrothers;if(r){var d=l.W_.FrmFld[t].WidgetSelf;$.each(r,(function(e,t){var n=t.npMode&&t.self.$ValidXml.r.modes["mod"+t.npMode];if(n){var a=t.self.EnableAllField;t.self.EnableAllField=!0,t.self.InitFrm_Core({CheckValModeCodeJSON:n}),t.self.EnableAllField=a,$.each(t.self.W_.FrmFld,(function(e,n){n.CheckValEnable&&(ko.isObservable(d.ViewModel[e+np.VMCmpXml])&&d.ViewModel[e+np.VMCmpXml](t.self.W_.FrmFld[e].WidgetSelf._ViewModel2XML("Cmp")),ko.isObservable(d.ViewModel[e+np.ACDesc])&&d.ViewModel[e+np.ACDesc](t.self.ViewModel[e+np.ACDesc]()),ko.isObservable(d.ViewModel[e])&&d.ViewModel[e](t.self.ViewModel[e]()))}))}else alert("unknown npMode")}))}}if("Cmp"==i&&a.Valid.OnAC)(o=l.Val(t))&&(o=np.utils.NPTrim(o)),n._LkId=o,"1"==a.Valid.SAC&&(s.push(t+np.ACDesc),s.push(t+np.ACTip));else if("Grd"==i){var p;o=a.Elem.npgrid("GetGridData"),l.Acts["act"+e]&&(p=l.Acts["act"+e].ActIn)&&$.each(p,(function(e,t){var i=a.Cols&&a.Cols[t];i&&(n[t]=i)}))}else(o=l.Val(t))&&(o=np.utils.NPTrim(o));var c;if("Cmp"==e&&(c=a.Alias),c||(c=t),o&&"object"!=typeof o&&(n[c]=o),l.$ValidXml.r.n[t+np.VMCmpXml]){var u=a.WidgetSelf.GetValOfCmp();u&&"object"!=typeof u&&(n[c+np.VMCmpXml]=u)}}})),$.each(s,(function(e,t){delete n[t]})),l.iacts&&l.iacts[e]&&$.each(n,(function(t,a){"MaxHlpMaxHlp"!=t&&-1===l.iacts[e].indexOf(t)&&delete n[t]})),"Cmp"==e){if(t&&t.toJson)return n;var d="<"+r;return $.each(n,(function(e,t){if("object"!=typeof t){var n="object"==typeof t?np.utils.escapeXml(JSON.stringify(t)):np.utils.escapeXml(t||"");d+=" "+e+'="'+n+'"'}})),d+="></"+r+">"}return 1},GetCmpInStr:function(e,t){var n=this,a=e.PreLoad,i=0;a.NewComponentsObj={},a.FormComponentsIdArr=[],a.FormFacisIdArr=[];var o=np.utils.NPLocalStorage(e.CmpType,e.CmpId,"XML");a.$ValidXml=JSON.parse(n.ReplaceParameter(e.P_,o||'{"r":{"n":{},"acts":{}}}',{EscapeJSON:!0}));var r=[];$.each(a.$ValidXml.r.load,(function(e,t){var n=t;np.NPPkgs[n]&&!np.NPPkgs[n].Loaded&&r.push(n)})),e.IsMakedFullId||(e.IsMakedFullId=!0,e.IdPrefix="#"+a.PreId,$("[id]",a.html_core).each((function(e,t){var n,i=$(t);n=i.prop("id"),i.attr("orgid",n),i.prop("id",a.PreId+n)})),$("label[for]",a.html_core).each((function(e,t){var n=$(t),i=a.PreId+n.attr("for");n.prop("for",i)})));var l=a.$ValidXml.r.NPGen,s=l?l.ver:0;$.each(a.$ValidXml.r.n,(function(e,t){s<302&&("2"==t.Lan&&"_Var"!=t.Typ&&$("#"+a.PreId+e,a.html_core).addClass("FIDDI"));if(t.OnAC){var n=e;$("#"+a.PreId+e,a.html_core).attr("data-bind","BindingCmp:"+n+",Desc:"+n+np.ACDesc+",Tip:"+n+np.ACTip+',CmpId:"'+n+'"')}if("Cmp"==t.Typ){var o=t.UrlF,r=t.UrlP,l=t.CmpId;o&&r&&!np.utils.NPLocalStorage(t.CmpType,l,"HTML")&&!a.NewComponentsObj[l]&&(a.NewComponentsObj[l]={CmpId:l,CmpType:0},np.fillCmpNames(a.NewComponentsObj[l],r+"/",o),++i),l?a.FormComponentsIdArr.push({id:e,CmpId:l,Loaded:!1}):a.FormFacisIdArr.push(e)}}));var d=a.FormComponentsIdArr.length,p=r.length,c=0,u=0,m=function(i){var o=a.$ValidXml.r.n[i],r=o.CmpId;a.Childs=a.Childs||{},a.Childs[i]={CmpType:0,CmpId:r,PreLoad:{PreId:e.PreLoad.PreId+i+"_W_"}},n._SetValueOf_P_(a.Childs[i],o),a.Childs[i].P_[np.P_IDIDID]=a.Childs[i].PreLoad.PreId;var l=np.utils.NPLocalStorage(0,r,"HTML");a.Childs[i].IsMakedFullId=l.indexOf(np.P_IDIDID)>-1,a.Childs[i].IdPrefix=a.Childs[i].IsMakedFullId?"#"+a.Childs[i].PreLoad.PreId:"#",l=n.ReplaceParameter(a.Childs[i].P_,l,{EscapeXml:!0}),l=$('<div style="position:relative" id="'+a.Childs[i].PreLoad.PreId+'">'+l+"</div>"),a.Childs[i].IsMakedFullId||(a.Childs[i].IsMakedFullId=!0,a.Childs[i].IdPrefix="#"+a.Childs[i].PreLoad.PreId,$("[id]",l).each((function(e,t){var n,o=$(t);n=o.prop("id"),o.attr("orgid",n),o.prop("id",a.Childs[i].PreLoad.PreId+n)})),$("label[for]",l).each((function(e,t){var n=$(t),o=a.Childs[i].PreLoad.PreId+n.attr("for");n.prop("for",o)}))),$(a.Childs[i].IdPrefix+"bod",l).css("overflow","visible").removeClass("ui-widget-content"),$(a.Childs[i].IdPrefix+"dvfrmCenter",l).css("overflow","visible"),$(a.Childs[i].IdPrefix+"dvfrmFooter",l).remove(),a.Childs[i].AddrPath=o.UrlP+"/",a.Childs[i].FName=o.UrlF,a.Childs[i].fname=a.Childs[i].AddrPath+a.Childs[i].FName,a.Childs[i].PreLoad.html_core=$("#"+a.PreId+i,e.PreLoad.html_core),a.Childs[i].PreLoad.html_core.html(l),n.GetCmpInStr(a.Childs[i],(function(e){++u==d&&t()}))},f=function(e){if(++c<i+p){var n=e.CmpId;n&&$.each(a.FormComponentsIdArr,(function(e,t){t.CmpId!=n||t.Loaded||(t.Loaded=!0,m(t.id))}))}else 0==d?t(a.html_core):$.each(a.FormComponentsIdArr,(function(e,t){t.Loaded||(t.Loaded=!0,m(t.id))}))};if($.each(r,(function(e,t){n.GetPkg(t,f)})),$.each(a.NewComponentsObj,(function(e,t){n.GetComponent(t,f)})),d||p){if(!i&&!p)return c--,void f()}else t(a.html_core)},AfterGetForm:function(e,t,n){var a,i,o,r=this,l=r.options,s=r.element;e.OpenInDialog=!1,l.OpenInDialog&&(e.OpenInDialog=!0),l.OpenedByDashboard&&!e.InlineBox&&(e.InlineBox=s.parent().append('<div style="position:relative"/>').find("div:last").uniqueId(),e.HideOpener=!0,e.OpenInline=!0,e.OpenedByDashboard=!0,null==e.ShowFooter&&(e.ShowFooter=l.ShowFooter),s.addClass("np-d-none")),e.OpenInline?(i=e.InlineBox,o=i.attr("id")):o=np.npUniqueId(),e.fname=e.AddrPath+e.FName,a=np.utils.NPLocalStorage(e.CmpType,e.CmpId,"HTML")||"",e.P_=e.P_||{},e.P_[np.P_IDIDID]=o,e.IsMakedFullId=a.indexOf(np.P_IDIDID)>-1,a=$(r.ReplaceParameter(e.P_,a,{EscapeXml:!0})),e.IsMakedFullId||(e.IsMakedFullId=!0,e.IdPrefix="#"+o,$("[id]",a).add(a).each((function(e,t){var n,a=$(t);n=a.prop("id"),a.attr("orgid",n),a.prop("id",o+n)})),$("label[for]",a).each((function(e,t){var n=$(t),a=o+n.attr("for");n.prop("for",a)}))),e.IdPrefix=e.IsMakedFullId?"#"+o:"#";e.ForceOpenerTabId?e.ForceOpenerTabId:s.attr("id");var d=e.FTitle;l.OpenInDialog&&e.OpenInSameDialog?(e.OpenerSelf=l.OpenerSelf,e.OpenerTicketSelf=r):e.OpenerSelf=r;e.PreLoad={},e.PreLoad.html_core=$(a),e.PreLoad.PreId=o,r.GetCmpInStr(e,(function(){!function(a){if(l.OpenInDialog&&e.OpenInSameDialog&&(e.OpenInDialog_ShowModal=!0,e.OpenInDialog=!0),e.OpenInline?(i.html(a),(c=$(e.IdPrefix+"bod",i)).removeClass("ui-widget-content")):(e.OpenInDialog||e.ForceOpenerTabId)&&(e.TabId=o,i=$("<div id="+o+' class="np-fitdivtoparent tab-pane" style="/*position:relative;*/direction:'+np.rtl+'; padding:0px;/*overflow:hidden*/"></div>').html(a).appendTo(e.ForceOpenerTabId?$("#"+e.ForceOpenerTabId).parent():$(s).parent())),l.OpenInDialog&&e.OpenInSameDialog&&(e.Height=r.options.Height,e.Width=r.options.Width,e.UseOpenerCaption&&(d=l.FTitle)),e.OpenInDialog_ShowModal?e.OpenInDialog_ShowModal=!0:e.OpenInDialog_ShowModal=!1,e.OpenInDialog){var p=e.CloseParentModal;null==p&&(p=!0);var c=l.OpenInDialog&&e.OpenInSameDialog?l.OpenerSelf.Get$bod():r.Get$bod();o=i.attr("id"),e.OpenerSelf.W_.OpenedDialogs[o]=e.$FaciDialogDiv=i;var u={appendTo:c.parent(),class:e.Class||"col-lg-9 col-12",closeButton:!1,destroyOnClose:!0,close:function(){GlobViewModel.OpenedSelf=r;var e=np.utils.GetWidgetSelf(i);e&&e.Close()}};d&&$("[np-frm-title]",$(e.IdPrefix+"dvfrmHeader",i)).html(d),i.removeClass("tab-pane").SimpleDialog(u),i.SimpleDialog("show")}function m(t,n){t&&((i=$(t)).prop("id",o).addClass("np-fitdivtoparent tab-pane"),i.html(a),d&&$("[np-frm-title]",$(e.IdPrefix+"dvfrmHeader",i)).html(d),$("#"+o+"bod",i).css("height","inherit")),$.NPCreateWidget(i,e.FName,e);var r=np.utils.GetWidgetSelf(i,e.FName);n&&n(r),e.Itself=r,r.NotRequireResizeHandler=!0}var f,h=e;e.OpenInDialog||e.InlineBox||e.ForceOpenerTabId?(e.OpenInDialog&&(h.ngData={caption:d},f=np.byNg((()=>r.GetngData().AngularTab.openDialog(h)))),t(),m(null,f),n()):(h.ngData={npform:!0,caption:d,ContinueAfterGetForm:m},t(),n(),np.byNg((()=>r.GetngData().AngularTab.openTab(h))))}(e.PreLoad.html_core)}))},GetNewForm:function(e){var t=this;t.GetngData()?.AngularTab?.openWaiting?t.GetngData()?.AngularTab?.openWaiting(!0,!0):t.ViewModel.OpenLoading(1);var n;n={CmpId:e.CmpId,CmpType:e.CmpType},np.fillCmpNames(n,e.AddrPath,e.FName),t.GetComponent(n,(function(n){n.status?t.AfterGetForm(e,(()=>{t.GetngData()?.AngularTab?.openWaiting?t.GetngData()?.AngularTab?.openWaiting(!1,!0):t.ViewModel.OpenLoading(0)}),(()=>{e.AfterOpen&&e.AfterOpen.call(t,"ok")})):t.GetngData()?.AngularTab?.openWaiting?t.GetngData()?.AngularTab?.openWaiting(!1,!0):t.ViewModel.OpenLoading(0)}))},RunAjax:function(e,t,n){var a=this,i=(a.options,a.element,!0);a.ExitFromSystem&&np.ExitMsg&&(i=!1,np.ExitMsg=!1),np.noNg((()=>$.ajax({type:"POST",url:a.url,dataType:"json",contentType:"application/json; charset=utf-8",processData:!1,async:i,data:e,complete:function(e,n){t&&t.call(this,e,n)},error:function(e,t,a){n&&n.call(this,e,t,a)}})))},CloseThisFaci:function(e,t,n,a){var i=this,o=i.options;i.GetngData()?.AngularTab?.openWaiting?i.GetngData()?.AngularTab?.openWaiting(!0):i.ViewModel.OpenWaiting(1),o.OpenerTabId=$("#li-"+i.ContId).hasClass("active")?o.OpenerTabId:"Default";i.CallDoAct_Sys((function(o){o.msg.errors.length&&!t?(a&&a(),i.SetRespmsg(o.msg),i.GetngData()?.AngularTab?.openWaiting?i.GetngData()?.AngularTab?.openWaiting(!1):i.ViewModel.OpenWaiting(0)):(i.GetngData()?.AngularTab?.openWaiting?i.GetngData()?.AngularTab?.openWaiting(!1):i.ViewModel.OpenWaiting(0),e.call(i,n))}),(function(e,t,n){a&&a(),i.SetRespmsg({c:[{m:[{e:"2",m:"خروج از امکان/سامانه با خطا مواجه گردید. ممکن است ارتباط شبکه قطع باشد."}]}]}),i.GetngData()?.AngularTab?.openWaiting?i.GetngData()?.AngularTab?.openWaiting(!1):i.ViewModel.OpenWaiting(0)}),{Act:t?"99":"98"})},ChangeUserType:function(e,t){var n=this;n.CallDoAct_Sys((function(t){t.msg.errors.length?(n.SetRespmsg(t.msg),e.call(this,t)):e.call(this,t)}),(function(e,t,a){n.SetRespmsg({c:[{m:[{e:"2",m:"خروج از امکان/سامانه با خطا مواجه گردید. ممکن است ارتباط شبکه قطع باشد."}]}]})}),{Act:t})},CallDoAct_Sys:function(e,t,n){var a=this,i=(a.options,a.element,n.Act);a.ExitFromSystem="99"==i,a._Init_SndXML({NavType:"logout"}),a._SndNavXML.r=n.r||{},a._SndNavXML.act=i,a.url="/frm/sys/sys.svc/";var o=JSON.stringify(a._SndNavXML);a.RunAjax(o,(function(t,n){if("success"==n){var i=JSON.parse(t.responseText);a.SetAutByResp(i),e(i)}}),t)},OpenNewForm:function(e,t,n,a,i,o){var r=this,l=r.options;r.element;if("object"==typeof a&&(o=a,a=null),o.ftype=e,o.fid=t,o.subfrm=n,o.HideOpener&&0!=$("body")[0].scrollTop&&(r.LastScrollTop=$("body")[0].scrollTop),o.UseOpenerAut&&!o.OpenInDialog&&(o.HideOpener=!0,o.CloseOpener=!1),o.CmpId||(o.CmpType="1"==e?1:0),r.options.OpenInDialog||o.CloseOpener||o.UseParentOpenerTabId?o.OpenerTabId=r.options.OpenerTabId:o.OpenInDialog?r.options.IsCmp||r.options.IsFaci?o.OpenerTabId=r.options.OpenerTabId:o.OpenerTabId=r.ContId:o.ForceOpenerTabId?o.OpenerTabId=o.ForceOpenerTabId:o.OpenerTabId=r.RootContId(),o.UseOpenerAut)return o.AddrPath+="/",o.Usrfrm=l.Usrfrm,o.UserLvl=l.UserLvl,void r.GetNewForm(o);var s={OpenWaitingDialog:{NoOverlay:!0,NoCloseWaitingDialog:1}};r.QueueAct((function(a,i,l){if(!r.W_)return a(l),!1;var s;r._Init_SndXML({NavType:"nav"}),r._SndNavXML.act="nav",r._SndNavXML.r={ft:e,fid:t,subfrm:n},o.CmpId&&(r._SndNavXML.r.CmpId=o.CmpId),r.url="/frm/sys/sys.svc/",s=JSON.stringify(r._SndNavXML),r.RunAjax(s,(function(e,t){if("success"==t){var s,d,p;if((p=(s=JSON.parse(e.responseText)).t)&&r.setTicket(p),"1"==(d=s.outpar).FaciNotFound||"1"==d.OldGolestan){var c="1"==d.FaciNotFound?"امکان مورد نظر وجود ندارد":"این امکان در این محیط قابل اجرا نمی باشد";return r.Message({type:"alert",text:c,title:"پیغام"}),a(l),o.AfterNav&&(o.AfterNav.call(r,s),delete o.AfterNav),void(o.ReadyCallBack&&o.ReadyCallBack(null,{cnt:1}))}if(d.cmp&&(o.CmpId=d.cmp),s.msg.errors.length)s.msg.c[0]&&s.msg.c[0].m[0]&&2==s.msg.c[0].m[0].e&&(s.msg.c[0].m[0].m=s.msg.c[0].m[0].m+(d.nam?"("+d.nam+")":"")),i||r.ClearRespmsg(),r.SetRespmsg(s.msg);else{if(o.ParentCmp||r.ClearRespmsg(),o.AddrPath=d.nurlp+"/",o.FName=d.nurlf,o.FTitle=o.OpenInDialog&&o.FTitle?o.FTitle:d.nam,o.HHLP=d.hhlp?d.hhlp:0,o.Usrfrm=d.usrfrm,o.UserLvl=d.usrlvl,o.rp=r.SetAutByResp(s,!0),""!=n||"0"===o.subfrm||o.CmpId||(o.CmpId=parseInt(o.fid,10)+parseInt(o.subfrm,10)),d.nurlp&&o.FName)return a(l),o.AfterNav&&(o.AfterNav.call(r,s),delete o.AfterNav),void r.GetNewForm(o);r.SetRespmsg({c:[{m:[{e:"2",m:"مسیر برنامه این فرم تعریف نشده است.-"+(o.FTitle?o.FTitle:"")}]}]})}}a(l),o.AfterNav&&(o.AfterNav.call(r,s),delete o.AfterNav),o.ReadyCallBack&&o.ReadyCallBack(null,{cnt:1})}),(function(e,t,n){r.SetRespmsg({c:[{m:[{e:"2",m:"خطا در دریافت اطلاعات فرم جدید"}]}]})}))}),s)},GridOnRowClick:function(e,t,n){var a=this;if(!a.IsWebBusy()){var i=t.ActNo,o=!!t.StopFocusToFirst,r=t.ClickEvent,l=$(r.target);l.length&&("INPUT"==l[0].tagName||$("input",l).length)&&(o=!0);var s=t.ColPrefix,d="",p=0,c=!1;if("Access"!=a.$ValidXml.r.Layout&&(c=!0),t.AssignFields){for(var u=0;u<3;u++)$.each(t.Grd.options.RelField,(function(e,n){var i,r,l;if((0==u&&n.id.indexOf(np.ACDesc)>0||1==u&&n.id.indexOf(np.ACTip)>0||2==u&&-1==n.id.indexOf(np.ACDesc)&&-1==n.id.indexOf(np.ACTip))&&(i=d||(n.colD?t.Data.ServerData.attr(s+(n.colD-p))||"":t.Data.Td()[n.col-1-p].Html()),n.col&&(r=t.Grd._vm.Cols()[n.col-1-p].ShowTag),r&&(c=!0),!c&&i.indexOf(",")>-1?(d=i.substr(i.indexOf(",")+1),i=i.substring(0,i.indexOf(",")),p++):d="",i=r&&"2"!=r&&"3"!=r&&"4"!=r?(l=i).indexOf("<")>-1?$("<A>"+l+"</A>").text():l:i,i=np.utils.NPTrim(i),!(a.$ValidXml.r.Layout&&"Access"==a.$ValidXml.r.Layout&&"_TempField"==n.id||(a.Val(n.id,i),o)))){var m=[],f=[];a.GetHlpIn(n.id,m,f),$.each(m,(function(e,t){if(-1==["Cmp","_Var"].indexOf(f[e])){var n=$("#"+t);if(n.length&&!n.prop("readonly")&&"none"!==n.css("display"))return np.noNg((()=>setTimeout((function(){n.data().datepicker||n.prop("readonly")||n[0].focus({preventScroll:!0})}),500))),o=!0,!1}}))}}));a.Acts["act"+i].relfieldopenfaci&&$(a.Acts["act"+i].relfieldopenfaci).each((function(e,n){var o=t.Data.ServerData.attr(s+n.colD);a.OpenFaciVariable(n.ActNo,i,n.colD,o)})),t.MoreGridOnRowClickSelf&&t.MoreGridOnRowClickSelf.GridOnRowClick(e,t,n)}return!0}},OpenFaciVariable:function(e,t,n,a){var i=this;return i.V_=i.V_||{},void 0===a?(void 0===(a=i.V_["_"+e+"_"+t+"_"+n])&&(a=""),a):(i.V_["_"+e+"_"+t+"_"+n]=a,a)},CreateNPGrid:function(e,t,n){var a=this,i=a.options,o=a.element;t=t||{};var r=(e=e||{}).id,l=t.ActNo;i.ParentCmp&&t.IsNotHelp&&(i.ParentCmp.options.HaveGrid=!0),0!==t.FullScreenable&&(t.FullScreenable="1"==e.FullScreenable?1:0),t.LinePerPage=e.LinePerPage||t.LinePerPage||20;var s=e.ColPrefix,d=e.RadifWidth,p=e.ShowRadifTitle,c=e.NpGridWidth,u=e.NewDesign,m=e.NoShowFooter,f=e.Form,h=e.height,g=e.NoRowColor1,C=e.NoRowColor2,v=e.NoRowColor3,b=e.Responsive,_=e.Responsivable,F=e.OddRowClass,y=e.ColHeight,w=e.RowMaxHeight,A=e.EvenRowClass,S=e.ActiveRowClass,I=e.StopSort;_&&(t.Responsivable=_),b&&(t.Responsive=b),d&&(t.RadifWidth=d),p&&(t.ShowRadifTitle=p),c&&(t.width=c),u&&(t.NewDesign=u),m&&(t.NoShowFooter=m),F&&(t.OddRowClass=F),A&&(t.EvenRowClass=A),S&&(t.ActiveRowClass=S),y&&(t.ColHeight=y),w&&(t.RowMaxHeight=w),f&&(t.Form=f),h&&(t.height=h);var T=e.HiddenAllColsFirst;T&&(t.HiddenAllColsFirst=T),s&&(t.ColPrefix=s),I&&(t.StopSort=I),g&&(t.NoRowColor1=g),C&&(t.NoRowColor2=C),v&&(t.NoRowColor3=v),e.NoPaging&&(t.NoPaging="1"==e.NoPaging),!t.HideFooter&&e.HideFooter&&"1"==e.HideFooter&&(t.HideFooter=!0);var N=e.AftFilRow,x=e.OnClickRow,V=e.AftClickRow,M=e.GetRowData,W=e.AftSwitch,D=e.GrdComplete,O=t.DefaultNoRadif?0:1;!e.Radif||"0"!=e.Radif&&"no"!=e.Radif||(O=0),e.Radif&&"1"==e.Radif&&(O=1),O&&(t.Radif=O),e.OnGridTextBlur&&(t.OnGridTextBlur=i[e.OnGridTextBlur]),e.AfterGridTextBlur&&(t.AfterGridTextBlur=i[e.AfterGridTextBlur]),N&&(t.AftFilRow=i[N]),x&&(t.OnRowClick=i[x]),V&&(t.AfterRowClick=i[V]),M&&(t.GetRowData=i[M]),W&&(t.AftSwitch=i[W]),D&&(t.AfterGridDrawCompleted=i[D]),l&&(t.RelField=a.Acts["act"+l].relfield||[]),t.InitOnRowClick=function(t,n){var a=n.Grd.options,i=new Array,o=0;$.each(n.Data.Td(),(function(e,t){i[o++]=t.Html()})),n.MoreGridOnRowClickSelf=e.MoreGridOnRowClickSelf,n.ColPrefix=a.ColPrefix||"F",n.ActNo=a.ActNo,n.FArr=i,n.AssignFields=!0,a.DefaultCloseDialog&&(n.CloseDialog=!0)},t.InitAfterRowClick=function(e,t){var n,a=t.Grd.options.npform,i=t.Grd.options,o=i.ColPrefix,l=i.jsonstruc;if(r){var s=a.W_.FrmFld[r].Cols={};$.each(t.Grd._vm.Cols(),(function(e,n){n.Name&&(s["_"+r+"_"+n.Name]=t.Data.Td()[e].Html())}))}a.GridOnRowClick(e,t,i.HelpDialog),i.DoActParams&&i.DoActParams.MSAutoC_Select&&i.DoActParams.MSAutoC_Select(t),l&&(n=$(t.ClickEvent.target).attr("npname")||$(t.ClickEvent.target.parentElement).attr("npname"))&&$.each(l.Cols,(function(e,i){var r=e+1;i.Acts&&$.each(i.Acts,(function(e,i){if(n==i.ActName+r){var l,s,d,p,c,u=i.ThisCmpActNo;if(u)return void a.DoAct(u);if({attr:function(e,t){l.outpar[e]=t}},null,!0,s={ReturnCaption:"بازگشت",OpenInDialog:!1,OpenInDialog_ShowModal:!1,HideOpener:!0,CloseOpener:!1,DisableOpener:!1,AfterClose:null,AfterOpen:null,ReturnParam:{},After:!0,Width:"auto",Height:"auto",inxml:l={outpar:{},doact:{}}},p=i.OpenFid,d=i.OpenFtype,s.CmpId=i.OpenCmpId,s.AddrPath=i.AddrPath,s.FName=i.FName,s.FTitle=i.FTitle,s.UseOpenerAut=!!i.UseOpenerAut,s.OpenInDialog=!!i.OpenInDialog,s.OpenInDialog_ShowModal=!!i.OpenInDialog_ShowModal,s.CloseOpener=!!i.CloseOpener,s.HideOpener=!!i.HideOpener,s.AfterClose=function(e,t){np.noNg((()=>setTimeout((function(){a.DoAct("08")}),0)))},i.ActConnect&&$.each(i.ActConnect,(function(e,n){var i="";if(n.ValueFromCol)if(isNaN(n.ValueFromCol)){var r=t.Grd.GetTdByName(t.Data,n.ValueFromCol);i=r?r.Html():""}else i=t.Data.ServerData.attr(o+n.ValueFromCol);if(!i&&n.ValueFromCmpObjAlias){var s=a.W_.Alias2Id[n.ValueFromCmpObjAlias.toUpperCase()]||n.ValueFromCmpObjAlias;(s=s+(1==n.ValueFromCmpObjRelTyp&&np.ACDesc||"")+(2==n.ValueFromCmpObjRelTyp&&np.VMCmpXml||""))&&(i=a.Val(s))}l.outpar[n.OpenCmpObjAlias+(1==n.OpenCmpObjRelTyp&&np.ACDesc||"")+(2==n.OpenCmpObjRelTyp&&np.VMCmpXml||"")]=n.ValueFix||i})),(c=i.OpenCmpActNo)&&(l.doact.act=c),i.JavaScript){ParamsAntiUgly=s,selfAntiUgly=a;var m="var Params=ParamsAntiUgly;var self=selfAntiUgly;"+i.JavaScript;np.utils.eval(m)}(p||s.CmpId)&&a.OpenNewForm(d,p,undefined,s)}}))})),t.CloseDialog&&(!a.W_.IsInMobile&&i.HelpDialog.npUiDialog("close"),a.W_.IsInMobile&&i.HelpDialog.SimpleDialog("close"))},t.jsonstruc&&t.jsonstruc.Cols&&(t.GetRowDataInternal=function(e,t){var n=t.Grd.options.npform,a=t.Grd.options.ColPrefix;$.each(t.Grd.options.jsonstruc.Cols,(function(e,i){var o=e+1,r=i.Name;i.Acts&&$.each(i.Acts,(function(e,i){var l=t.Grd.GetTdByName(t.Data,r||a+o),s="",d=i.CondMethodName||"";(""==d||d&&n[d]&&n[d].call(n,t,l))&&(1==i.IconType&&(s=n.GetGlyphIcon({name:i.IconName,title:i.IconTitle,style:i.Style,attr:{npname:i.ActName+o},class:i.Class})),2==i.IconType&&(s=n.gettinybutton(i.IconName,{npname:i.ActName+o})),1!=i.IconType&&2!=i.IconType||l.Html(l.Html()+"&nbsp;&nbsp"+s),3==i.IconType&&l.Html(n.SetHyper({name:i.IconName,title:i.IconTitle,style:i.Style,attr:{npname:i.ActName+o},class:i.Class},l.Html())))}))}))});var k=e.MinHeight;k&&(t.MinHeight=k),t.ColAttr=t.ColAttr||{};var P,R,L=t.ColAttr,E=[],H=e.RId,G=e.RIdCol;e.col&&$.each(e.col,(function(e,t){E[e]=t,t.COLTYPE=L["COLTYPE"+e]||t.COLTYPE,t.SHOWTAG=L["SHOWTAG"+e]||t.SHOWTAG,t.SHOWLABEL=L["SHOWLABEL"+e]||t.SHOWLABEL,t.DIR=L["DIR"+e]||t.DIR,t.ALIGN=L["ALIGN"+e]||t.ALIGN,t.MULTILINE=L["MULTILINE"+e]||t.MULTILINE,t.FilterType=L["FilterType"+e]||t.FilterType,t.CheckBox=L["CheckBox"+e]||t.CheckBox,t.GridOutput=L["GridOutput"+e]||t.GridOutput})),E&&(t.Cols=E),H&&(t.RId=H),G&&(t.RIdCol=G),r&&(R=$("#"+a.MakeFullId(r),$(o)))&&(P=a.GetCover(R)),P&&(t.GridCover=P);var B,X=n.npgrid(t);return(B=e.Dlg)&&n.npgrid("SetDlg",a.$np("#"+B)),X},OpenMenuForm:function(e){},showmenu:function(){},ShowFirstForm:function(){},CloseDialog:function(){var e=this,t=e.options;e.IsWebBusy()||(t.$FaciDialogDiv?t.OpenInDialog?t.$FaciDialogDiv.SimpleDialog("close"):t.$FaciDialogDiv.npDialog("close"):e.Close())},Close:function(e,t){var n=this,a=n.options,i=(n.element.attr("id"),(e=e||{}).ForceClose);e.DontChangeTab;if((i||!n.IsWebBusy())&&n._trigger("BeforeClose")){var o=function(e){var n=this,a=n.options,o=n.element,r=o.attr("id");i||n._trigger("AfterClose",null,a.ReturnParam),np.noNg((()=>setTimeout((function(){!a.OpenInDialog&&a.OpenedByDashboard&&!a.CloseOpener&&a.OpenerSelf&&a.OpenerSelf.element.removeClass("np-d-none"),a.OpenerSelf&&a.OpenerSelf.W_&&(a.OpenerSelf.W_.OpenedDialogs[r]=null,delete a.OpenerSelf.W_.OpenedDialogs[r]),!a.OpenInDialog&&a.ngData?np.byNg((()=>a.ngData.AngularTab.closeTab())):(a.OpenInDialog&&a.ngData&&np.byNg((()=>a.ngData.AngularTab.closeDialog())),o.remove()),t&&t.call(n)}),0)))},r=0,l=0,s=function(){++r==l&&(a.UseOpenerAut?o.call(n):n.CloseThisFaci(o,!1,e,null))};$.each(n.W_.OpenedDialogs,(function(e,t){t&&l++})),$.each(n.W_.FrmFld,(function(e,t){t.IsFaci&&l++})),$.each(n.W_.StayedForm,(function(e,t){t&&!t.self.options.OpenInDialog&&l++})),r!==l&&$.each(n.W_.OpenedDialogs,(function(e,t){t&&np.utils.GetWidgetSelf(t)&&np.utils.GetWidgetSelf(t).Close({ForceClose:!0},s)})),r!==l&&$.each(n.W_.FrmFld,(function(e,t){t.IsFaci&&t.WidgetSelf.Close({ForceClose:!0},s)})),r!==l&&$.each(n.W_.StayedForm,(function(e,t){t&&!t.self.options.OpenInDialog&&t.self.Close({ForceClose:!0},s)})),0==l&&(--r,s())}},SaveScrollTops:function(){var e=this;$.each(e.W_.HelpGrids,(function(e,t){null!==t&&$(t).npgrid("SaveScrollTop")})),$.each(e.W_.FrmFld,(function(e,t){"Grd"==t.Valid.Typ&&t.Elem.npgrid("SaveScrollTop")})),$.each(e.W_.FrmFld,(function(e,t){t.IsFaci&&t.WidgetSelf.SaveScrollTops()})),e.W_.$dvfrmCenterscrollTop=e.W_.$dvfrmCenter[0].scrollTop,e.W_.$bodyscrollTop=$("body").scrollTop()},LoadScrollTops:function(){var e=this;$.each(e.W_.HelpGrids,(function(e,t){null!==t&&$(t).npgrid("LoadScrollTop")})),$.each(e.W_.FrmFld,(function(e,t){"Grd"==t.Valid.Typ&&t.Elem.npgrid("LoadScrollTop")})),$.each(e.W_.FrmFld,(function(e,t){t.IsFaci&&t.WidgetSelf.LoadScrollTops()})),e.W_.$dvfrmCenterscrollTop&&(e.W_.$dvfrmCenter[0].scrollTop=e.W_.$dvfrmCenterscrollTop),(e.W_.$bodyscrollTop||0===e.W_.$bodyscrollTop)&&$("body").scrollTop(e.W_.$bodyscrollTop)},OpenFaci:function(e,t,n,a,i,o){o=$.extend({ReturnCaption:"بازگشت",inxml:{}},o),this.OpenNewForm(e,t,"",a,i,o)},ResizeHandler:function(){var e=this,t=e.options;e.element;if(t.ParentCmp&&t.ParentCmp.options.HaveGrid){var n=e.W_.$dvfrmCenter.outerHeight(!0)-e.W_.$dvfrmCenter.height(),a=e.W_.$dvfrmHeader.outerHeight(!0),i=e.W_.$dvfrmFooter.outerHeight(!0)||0;"none"!=e.W_.$dvfrmHeader.css("display")&&a||(a=0),"none"!=e.W_.$dvfrmFooter.css("display")&&i||(i=0),t.ParentCmp?e.W_.$bod.parent().parent().height()-n-a-i:e.W_.$bod.height()-n-a-i}$.each(e.W_.FrmFld_Grd,(function(t,n){e.W_.FrmFld[t]&&e.W_.FrmFld[t].Elem&&e.W_.FrmFld[t].Elem.npgrid("ReCalcDim")}))},FixHeader:function(){var e=this;e.$np("#dvfrmHeader").prepend(e.W_.HelpBox),e.dvfrmCenterHeight()},AppendXmlDataToJSON:function(e,t){var n,a;return t=t||this.$ValidXml.r.n,e.each((function(e,i){var o=$(i);(a=o.attr("id"))&&(n=t[a]={},$.each(i.attributes,(function(e,t){n[t.name]=t.value})),o.children().each((function(e,t){n[t.tagName]=n[t.tagName]||[];var a={};$.each(t.attributes,(function(e,t){a[t.name]=t.value})),n[t.tagName].push(a)})))})),n},FaciHelp:function(e,t,n){var a,i,o,r=0,l=this.AutXml();a={attr:function(e){return l.rp[e]}},t||(t=a.attr("f"),r=parseInt(a.attr("subfrm"))),e||(e=a.attr("ft")),(o={ReturnCaption:"بازگشت",OpenInDialog:!1,OpenInDialog_ShowModal:!1,HideOpener:!0,CloseOpener:!1,DisableOpener:!1,AfterClose:n,AfterOpen:null,ReturnParam:{},After:!0,Width:"auto",Height:"auto",title:!0,inxml:i={outpar:{},doact:{}}}).CmpId=110034,o.AddrPath="/frm/F0224_CMP_FORMGUIDE_GETFACILITYHELP",o.FName="F0224_CMP_FORMGUIDE_GETFACILITYHELP",o.FTitle="راهنماي امكان",o.UseOpenerAut=!0,o.OpenInDialog=!0,o.OpenInDialog_ShowModal=!1,o.Width=800,i.outpar.PBW=e,i.outpar.PBX=t,i.outpar.PBY=r+1,i.doact.act="10",this.OpenNewForm(undefined,undefined,undefined,o)},ValidChgAttr:function(e,t,n){this.W_.FrmFld[e].Valid[t]=n},ValidChgNextAct:function(e,t,n){void 0===n&&(n="0");var a,i=this.$ValidXml.r.acts;function o(e){"all"==n?$.each(e,(function(e,n){"mod"==e.substr(0,3)&&(n.nex=t)})):(e["mod"+n]=e["mod"+n]||{},e["mod"+n].nex=t)}"all"==e?$.each(i,(function(e,t){"act"==e.substr(0,3)&&o(t)})):(a=i["act"+e])?o(a):o(a=i["act"+e]={})},EmptyValid:function(e,t){var n,a=this.$ValidXml.r.acts;function i(e){"all"==t?$.each(e,(function(e,t){"mod"==e.substr(0,3)&&(t.f={})})):(e["mod"+t]=e["mod"+t]||{},e["mod"+t].f={})}void 0===t&&(t="0"),"all"==e?$.each(a,(function(e,t){"act"==e.substr(0,3)&&i(t)})):(n=a["act"+e])?i(n):i(n=a["act"+e]={})},AddValid:function(e,t,n,a,i){var o,r=this.$ValidXml.r.acts;function l(e){if("all"==n)$.each(e,(function(e,n){"mod"==e.substr(0,3)&&(n.f=i?{}:n.f||{},$(t).each((function(e,t){n.f[t]||(n.f[t]=a&&"0"!=a?{Req:"1"}:{})})))}));else{var o=e["mod"+n]=e["mod"+n]||{};o.f=i?{}:o.f||{},$(t).each((function(e,t){o.f[t]||(o.f[t]=a&&"0"!=a?{Req:"1"}:{})}))}}void 0===n&&(n="0"),Array.isArray(t)||(t=[t]),"all"==e?$.each(r,(function(e,t){"act"==e.substr(0,3)&&l(t)})):(o=r["act"+e])?l(o):l(o=r["act"+e]={})},RemValid:function(e,t,n){var a,i=this.$ValidXml.r.acts;function o(e){if("all"==n)$.each(e,(function(e,n){"mod"==e.substr(0,3)&&(n.f=n.f||{},$(t).each((function(e,t){n.f[t]&&delete n.f[t]})))}));else{var a=e["mod"+n]=e["mod"+n]||{};a.f=a.f||{},$(t).each((function(e,t){a.f[t]&&delete a.f[t]}))}}void 0===n&&(n="0"),Array.isArray(t)||(t=[t]),"all"==e?$.each(i,(function(e,t){"act"==e.substr(0,3)&&o(t)})):(a=i["act"+e])?o(a):o(a=i["act"+e]={})},RepValid:function(e,t,n,a){void 0===n&&(n="0"),Array.isArray(t)||(t=[t]),this.AddValid(e,t,n,a,"1")},ReFillLookup:function(e){var t=this;if(e){var n=t.GetCmpSelf(e);t=n||t}var a={RunInQueue:!0};t.$ValidXml.r.NoAuth&&(a.NoAuth=!0),$.each(t.W_.FrmFld,(function(e,n){"Cmp"==n.Valid.Typ&&110025==n.Valid.CmpId&&n.Valid.SAC&&"1"==n.Valid.SAC&&$.each(n.WidgetSelf.W_.FrmFld,(function(i,o){o.Valid.IsAC&&(n.Valid.npAutoCompleteWidget=o.Elem.npAutoComplete("instance"),o.Elem.npAutoComplete("FillLookup",a,(function(){var n=t.Val(e);t.Val(e,n)})))}))}))},GetACCache:function(e){this.W_.FrmFld[e].Elem.npAutoComplete("FillLookup")},ClearACCache:function(e){var t=this.W_.FrmFld[e];"Cmp"!=t.Valid.Typ||110025!=t.Valid.CmpId?this.W_.FrmFld[e].Elem.npAutoComplete("ClearCache"):$.each(t.WidgetSelf.W_.FrmFld,(function(e,n){n.Valid.IsAC&&(t.Valid.npAutoCompleteWidget=n.Elem.npAutoComplete("instance"),n.Elem.npAutoComplete("ClearCache"))}))},CreateObs:function(e,t,n){var a=this;t=null==typeof t?"":t,a.ViewModel[e]=ko.observable(t),a.$ValidXml.r.n[e]={id:e,Def:t,Typ:"_Var"},a.W_.FrmFld[e]?alert("error duplicate FrmFld"):(a.W_.FrmFld[e]={},a.W_.FrmFld[e].Valid=a.$ValidXml.r.n[e],n&&(a.W_.FrmFld[e].valParams=n))},CreateObsArr:function(e){this.ViewModel[e]=ko.observableArray([])},XAttrToViewModel:function(e,t,n,a){this.XAttrToObject(null,e,t,n,a)},XAttrToObject:function(e,t,n,a,i,o){var r=this;try{var l="$html"==a?o?r.npFormat(n.text()):n.text():o?r.npFormat(n.attr(a)):n.attr(a);e?e[t]=l:r.Val(t,l)}catch(n){null==typeof i&&(i=""),e?e[t]=i:r.Val(t,i)}},setFrmTitle:function(e){$('[np-frm-title="1"]',this.W_.$dvfrmHeader).text(e)},ClearOpt:function(e){this.ViewModel[e+np.OPTOPT].removeAll()},ValOpts:function(e){var t=this;return e=t.W_.Alias2Id[e]||t.W_.Alias2Id[e.toUpperCase()]||e,t.ViewModel[e+np.OPTOPT]()},ValOpt:function(e){var t=this;e=t.W_.Alias2Id[e]||t.W_.Alias2Id[e.toUpperCase()]||e;var n,a=t.ViewModel[e](),i=t.ViewModel[e+np.OPTOPT]();if(a&&i)return $.each(i,(function(e,t){if(t.val==a)return n=t,!1})),n},_Val:function(e,t,n,a){var i=this,o=i.W_.FrmFld[e];if(void 0===t){var r,l=e.substring(0,e.indexOf(np.VMCmpXml));return l&&i.GetCmpSelf(l)?i.GetCmpSelf(l).GetValOfCmp():(r=ko.unwrap(n[e]),a?.num?r:(r||(r=""),i.NPFix(e,r)))}i.IsBindingInProgress=!0;try{if(ko.isObservable(n[e])){var s,d=null==t?"":t.toString();return d=(d=np.utils.NPChangeNumToLatin(d))?i.NPFormat(e,d):d,a?.num?(n[e](t),i.IsBindingInProgress=!1,t):("object"==typeof t?n[e](t):n[e](d),o.Val=d,o.LastVal=o.Val,i.ShowError(i.MakeFullId(e),e,""),isNaN(d)||np.utils.NPTrim(n[e]())===np.utils.NPTrim(d)||(n[e](null),o.Val=n[e](),o.LastVal=o.Val),(s=o.LabelElemCmp)&&"1"!=s&&(d||!o.Enabled?s.addClass("groupInputFocus"):s.removeClass("groupInputFocus")),o.Valid.OnAC&&(s=i._GetLabelOfElem(e))&&(d||!o.Enabled?s.addClass("groupInputFocus"):s.removeClass("groupInputFocus")),i.IsBindingInProgress=!1,d)}return n[e]=t.toString(),i.IsBindingInProgress=!1,t}catch(e){alert("error"),i.IsBindingInProgress=!1}},ValByKeyboard:function(e,t,n){var a=n.attr("GridId");if(e&&!a&&(this.$np("#"+e).data({npchange:"1",npchangeautoc:"1"}),this.Val(e,t)),a){var i=n.attr("Np-Col-Id"),o=ko.dataFor(n[0]);n.val(t),o.Td()[i].Html(t)}},ValXml:function(e,t){var n=this;return e=n.W_.Alias2Id[e]||n.W_.Alias2Id[e.toUpperCase()]||e,n.Val(e+np.VMCmpXml,t)},ValDesc:function(e,t){var n=this;return e=n.W_.Alias2Id[e]||n.W_.Alias2Id[e.toUpperCase()]||e,n.Val(e+np.ACDesc,t)},ValTip:function(e,t){var n=this;return e=n.W_.Alias2Id[e]||n.W_.Alias2Id[e.toUpperCase()]||e,n.Val(e+np.ACTip,t)},Val:function(e,t,n){var a=this,i=a.ViewModel;if(a.W_.FrmFld[e]?.valParams&&(n=n||{},$.each(a.W_.FrmFld[e]?.valParams,((e,t)=>{void 0===n[e]&&(n[e]=t)}))),!Array.isArray(e)){if(e=a.W_.Alias2Id[e]||a.W_.Alias2Id[e.toUpperCase()]||e,t&&"object"==typeof t&&(void 0!==t.desc&&a._Val(e+np.ACDesc,t.desc,i,n),void 0!==t.tip&&a._Val(e+np.ACTip,t.tip,i,n),void 0!==t.val))return a._Val(e,t.val,i,n);if(t&&(a.$ValidXml.r.NoAuthSAC||a.$ValidXml.r.AuthSAC)){var o=a.W_.FrmFld[e];if("Cmp"==o.Valid.Typ&&110025==o.Valid.CmpId&&o.Valid.SAC&&"1"==o.Valid.SAC)if(o.Valid.MSAutoC&&"1"==o.Valid.MSAutoC);else{var r=o.Valid.npAutoCompleteWidget.GetDescTip(t);r.hasNotData?a.ReFillLookup():(r.Desc&&a._Val(e+np.ACDesc,r.Desc||"",i,n),r.Tip&&a._Val(e+np.ACTip,r.Tip||"",i,n))}}return a._Val(e,t,i,n)}$(e).each((function(e,t){a.Val(t.i,t.v,n)}))},Toggle:function(e){var t,n=this,a="object"==typeof e?e.currentTarget.id:e,i="VIS",o=n.W_.FrmFld[n.MakeOrgId(a)].Valid;"VIS"===o.CurState?(o.CurState="INVIS",$("#"+a).removeClass("ui-icon-circle-minus").addClass("ui-icon-circle-plus")):(o.CurState="VIS",i="INVIS",$("#"+a).addClass("ui-icon-circle-minus").removeClass("ui-icon-circle-plus")),(t=o.RelObj)&&n.$np("#"+t).css("display","INVIS"===i?"":"none"),n.ResizeHandler()},CreateCodeMirrorObj:function(e,t){var n=this,a=n.$np("#"+e);t=t||{};var i="";if("1"==a.attr("np-inline")){n.ViewModel[e].subscribe((function(t){n["codeMirror_"+e].setValue(n.Val(e))}));var o=t.Mode||"javascript",r=CodeMirror.fromTextArea(a[0],{mode:o,indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,foldGutter:!0,autofocus:!1,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{"Ctrl-Space":"autocomplete",Tab:function(e){var t=Array(e.getOption("indentUnit")).join("   ");e.replaceSelection(t)}}});return a.prop("readonly")&&r.setOption("readOnly",!0),a.prop("np-cm",r),r.setSize(null,a.height()),n["codeMirror_"+e]=r,void r.on("blur",(function(t){n.Val(e,t.getValue())}))}var l=$('<input src="/img/fullscr.png" type="image" />').css({marginTop:"-4px",float:"right"}).click((function(){if(a.prop("np-cm"))n.Val(e,a.prop("np-cm").getValue()),a.prop("np-cm").toTextArea(),$(a.prop("np-wd")).append(a.closest("div")),$(a.prop("np-FullScrDiv")).remove(),a.prop("np-cm",null),""!=i&&i.hide();else{a.prop("loc",{w:a.width(),h:a.height()});var o=$("<div />").css({position:"absolute",zIndex:10010,top:"0px",right:"10px",border:"1px solid #ccc"}).append(a.closest("div")).appendTo(n.$np("#bod"));""==i?i=$("<span class='ui-icon ui-icon-carat-2-e-w' style='position:absolute;top:5px;left:5px' title='تنظیم فرمت کد'></span>").appendTo(n.$np("#bod")):i.show(),"sql"==t.Mode&&(t.Mode="text/x-sql");var r=t.Mode||"javascript",l=CodeMirror.fromTextArea(a[0],{mode:r,indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,foldGutter:!0,autofocus:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{"Ctrl-Space":"autocomplete",Tab:function(e){var t=Array(e.getOption("indentUnit")).join("   ");e.replaceSelection(t)}}});i.on("click",(function(e){CodeMirror.commands.selectAll(l);var t={from:l.getCursor(!0),to:l.getCursor(!1)};l.autoFormatRange(t.from,t.to),l.setCursor({line:0,ch:0})})),a.prop("readonly")&&l.setOption("readOnly",!0);for(var s=n,d=n.$np("#bod").height(),p=n.$np("#bod").width();s.options.IsCmp;)d=(s=s.options.ParentCmp).element.height(),p=s.element.width();l.setSize(p-20,d-25),a.prop("np-cm",l),a.prop("np-FullScrDiv",o)}}));a.wrap($("<div />")).before(l).parent().wrap($("<div />")),a.prop("np-wd",a.parent().parent())},upl:function(e,t){this.updwn(!0,e,t)},dwn:function(e,t){this.updwn(!1,e,t)},updwn:function(e,t,n){var a=this,i={param:n,AppendTo:a.W_.$bod,InData:function(e,t){var i={r:{}};return $.each(n(),(function(e,n){"act"===e?t.act=n:"pararr"==e&&"up"==t.act?(i.r.id=n[0],i.r.fnam=n[1]):"pararr"==e&&"dw"==t.act?$.each(n,(function(e,t){var n=e+1;i.r["p"+n]=t})):i.r[e]=n})),!!t.act&&($.extend(i,a.AutXml()),i.act=t.act,t.xml=JSON.stringify(i),!0)},AfterGO:function(e,t){a.Resp=JSON.parse(t.xml),a.SetAutByResp(a.Resp),a.SetRespmsg(a.Resp.msg);var n={ErLen:a.ErLen,WarLen:a.WarLen};a.ActNo=n.ActNo=t.act,"up"==t.act&&t.param().pararr&&t.param().pararr.length>0&&(t.param().id=t.param().pararr[0],t.param().fnam=t.param().pararr[1]);var i=t.param().id||t.param().pararr&&t.param().pararr[0],o=t.param().fnam||t.param().pararr&&t.param().pararr[1];i&&a.Val(i,a.Resp.outpar.id),o&&a.Val(o,a.Resp.outpar.fnam),t.param().len&&a.Val(t.param().len,a.Resp.outpar.len),t.param().fuq&&a.Val(t.param().fuq,a.Resp.outpar.fuq),t.param().ftck&&a.Val(t.param().ftck,a.Resp.outpar.ftck);var r,l=a.Resp.msg.errors.length>0?a.Resp.msg.errors[0]:a.Resp.msg.suc.length?a.Resp.msg.suc[0]:a.Resp.msg.war[0];l&&(r={m:[{e:a.Resp.msg.errors.length>0?"2":a.Resp.msg.suc.length>0?"0":"1",m:l}]},a.Resp.msg.c.push(r),a.ClearRespmsg(),a.SetRespmsg(a.Resp.msg)),np.noNg((()=>a.Get_Data(null,n)))},BeginGO:function(){if(a.IsWebBusy())return!1;a.SetFreezServer(!0)},EndGO:function(){a.SetFreezServer(!1)}};e?$(t).npupload(i):$(t).npdownload(i)},Message:function(e){var t=this;t.W_.$bod.is(":np-npmessage")||t.W_.$bod.npmessage(),t.W_.$bod.npmessage("Dialog",e)},_CheckExistsValidationData:function(e){return!!e&&!!this.W_.FrmFld[e]},_SetCurrValidationData:function(e,t,n){var a,i=this,o=i.Valid_;if(e&&i.W_.FrmFld[e])a=i.W_.FrmFld[e].Valid;else{if(!(t&&n&&i.W_.FrmFld[t]&&(a=i.W_.FrmFld[t].ColsValid)))return!1;if(!(a=a[n]))return!1}if(!o)return alert("StartValidationCheck is not running!!!!!!!!!"),!0;if(a.Lan&&"Let"!=a.Typ||(a.Lan=3),!(o.CurLang=a.CurLang)){switch(a.Lan){case"2":o.CurLang="latin";break;case"1":case"3":o.CurLang="farsi";break;default:o.CurLang="all"}a.CurLang=o.CurLang}return a.Cap=a.Cap||"",a},TriggerEvent:function(e,t,n){var a=this;a.W_.FrmFld[e]["np-"+t]&&a._trigger(a.W_.FrmFld[e]["np-"+t],n)},StartValidationCheck:function(){var e=this,t=e.element;LengthOfStudentNo||(LengthOfStudentNo=10),$.ui.keyCode.NUMPAD_DECIMAL=110;var n=e.Valid_;function a(t,n,a){e.W_.FrmFld[t]["np-"+n]&&e._trigger(e.W_.FrmFld[t]["np-"+n],a)}e._on(e.W_.$bod,{"click [id]":function(t){var n=$(t.target);if(n.hasClass("ui-state-disabled")||n.prop("readonly"))return!1;var i=$(t.currentTarget),o=i.attr("orgid");e.W_.FrmFld[o]&&(a(o,"OnClk",t),a(o,"OpenFaci",t),"collapse"==i.attr("data-toggle")||"collapse"==n.attr("data-toggle")||n.hasClass("navbar-toggler-icon")||"A"!=t.target.tagName&&t.stopPropagation())},"blur [id]":function(t){var n=$(t.currentTarget).attr("orgid");e.W_.FrmFld[n]&&a(n,"OnBl",t)},"mouseover [id]":function(t){var n=$(t.currentTarget).attr("orgid");e.W_.FrmFld[n]&&a(n,"OnOvr",t)},"mouseout [id]":function(t){var n=$(t.currentTarget).attr("orgid");e.W_.FrmFld[n]&&a(n,"OnOut",t)},"focus :input":function(t){n.IsChangeInProgress=!1;var a,i=$(t.currentTarget),o=i.attr("orgid")||i.attr("GrdObjorgid"),r=i.attr("GridId"),l=i.attr("OrgGridId"),s=i.attr("Np-Col-Id");if(r&&i.parent().click(),a=e._SetCurrValidationData(o,l,s)){if(("text"==i[0].type||"textarea"==i[0].type)&&!i.attr("readonly")){e.SetLangShowPosition(i),$("div",GlobViewModel.LangShow.show()).text("farsi"==n.CurLang?"FA":"EN");var d=a.Typ||"";["Int","Num","StdNo","PDat","GDat","SSNo","Flt","Tim"].indexOf(d)>-1&&GlobViewModel.LangShow.hide()}np.noNg((()=>clearTimeout(e.LangTimer))),e.LangTimer=np.noNg((()=>setTimeout((function(){GlobViewModel.LangShow.hide()}),1e3)))}},"focus .groupInput input, input.groupInput":function(e){var n=$(e.currentTarget);$("label[for="+n.attr("id")+"]",t).addClass("groupInputFocus"),e.stopPropagation()},"blur :input":function(t){var a=$(t.currentTarget),i=a.attr("orgid")||a.attr("GrdObjorgid"),o=a.attr("OrgGridId"),r=a.attr("Np-Col-Id");e._SetCurrValidationData(i,o,r)&&(GlobViewModel.LangShow.hide(),n.IsChangeInProgress||"1"==a.data("npchange")&&(a.data("npchange","0"),e._Chg_Core(a)))},"focusout .groupInput input, input.groupInput":function(e){var n=$(e.currentTarget);""==n.val()&&n.prev("span.MSCLASS").length<1&&!n.prop("readonly")&&$("label[for="+n.attr("id")+"]",t).removeClass("groupInputFocus"),e.stopPropagation()},"keypress :input,bdo":function(t){e._KeyPress(t,$(t.currentTarget)),t.stopPropagation()},"keyup :input,bdo":function(t){e._KeyUp(t,$(t.currentTarget)),t.stopPropagation()},"keydown :input,bdo":function(t){e._KeyDown(t,$(t.currentTarget)),t.stopPropagation()},"paste :input":function(e){$(e.currentTarget).data("npchange","1"),e.stopPropagation()},"change :input":function(t){$(t.currentTarget).data("npchange","0"),e._Chg(t,$(t.currentTarget)),t.stopPropagation()}})},SetLangShowPosition:function(e){var t=e.offset(),n="ltr"==e.attr("dir")?t.left:t.left+e.outerWidth()-GlobViewModel.LangShow.outerWidth(),a=t.top-GlobViewModel.LangShow.outerHeight();return GlobViewModel.LangShow.css({left:n+"px",top:a+"px"}),{Left:n,Top:a}},_KeyPress:function(e,t,n){var a,i=this,o=(n=n||{}).EditorId,r=t.attr("orgid")||t.attr("GrdObjorgid"),l=t.attr("id"),s=t.attr("GridId"),d=t.attr("OrgGridId"),p=t.attr("Np-Col-Id");if(!r&&t.hasClass("FilterTextbox")&&(a={Typ:"Txt",Lan:"3"}),!r&&t.hasClass("reportTextBox"))a={Typ:"Num"};else if(!(a=i._SetCurrValidationData(r,d,p)))return;if(t.attr("readonly"))e.preventDefault();else if("Check"!=a.Typ){var c,u,m,f=i.Valid_;if(c=e.keyCode?e.keyCode:e.which,u=e.which,m=e.shiftKey,"Htm"!=a.Typ&&(c!=$.ui.keyCode.ENTER||!a.TextArea)){"Let"!=a.Typ&&"Pass"!=a.Typ||(a.Typ="Txt");var h={};if(c>1547&&(h[1588]=97,h[1584]=98,h[1586]=99,h[1740]=100,h[1579]=101,h[1576]=102,h[1604]=103,h[1575]=104,h[1607]=105,h[1578]=106,h[1606]=107,h[1605]=108,h[1574]=109,h[1583]=110,h[1582]=111,h[1581]=112,h[1590]=113,h[1602]=114,h[1587]=115,h[1601]=116,h[1593]=117,h[1585]=118,h[1589]=119,h[1591]=120,h[1594]=121,h[1592]=122,h[1705]=59,h[1662]=92,h[1670]=93,h[1711]=39,h[1608]=44),"latin"==f.CurLang&&m&&(h[1614]=65,h[1573]=66,h[1688]=67,h[1616]=68,h[1613]=69,h[1617]=70,h[1728]=71,h[1570]=72,h[93]=73,h[1600]=74,h[171]=75,h[187]=76,h[1569]=77,h[1571]=78,h[91]=79,h[92]=80,h[1611]=81,h[1585]=82,h[1615]=83,h[1548]=84,h[44]=85,h[1572]=86,h[1612]=87,h[1610]=88,h[1563]=89,h[1577]=90),c=h[c]?h[c]:c,0!=u&&8!=c&&9!=c&&!e.ctrlKey){if(f.IsChangeInProgress=!1,c==$.ui.keyCode.ENTER&&!o)return e.preventDefault(),e.stopPropagation(),void(i._Chg_Core(t,!0)&&(s?i.NPFocusNextInGrid(t):i.NPFocusNext(l,r)));var g=t.NPSelectionText(),C=t.val(),v=t[0].selectionStart,b=t[0].selectionEnd;if("latin"!=f.CurLang||"BDO"!=t[0].tagName)switch("ANum"==a.Typ&&"Access"!=i.$ValidXml.r.Layout&&(a.Typ="ANum2"),"Al"==a.Typ&&"Access"!=i.$ValidXml.r.Layout&&(a.Typ="Al2"),a.Typ){case"Tim":t.val();(c<48||c>57)&&e.preventDefault();break;case"Url":break;case"Email":var _=np.ValidChars.Email.charCodeAt(c-32);"~"==String.fromCharCode(_)||(t.insertAtCaret(String.fromCharCode(_)),i.ValByKeyboard(r,t.val(),t)),e.preventDefault();break;case"StdNo":if(c<48||c>57)e.preventDefault();else t.val().length>=LengthOfStudentNo&&e.preventDefault();break;case"SSNo":case"Num":(c<48||c>57)&&e.preventDefault();break;case"Int":if(c<48||c>57){if(45==c)if(-1==t.val().indexOf("-")){var F="-"+t.val();i.ValByKeyboard(r,F,t)}else{F=t.val().slice(1);i.ValByKeyboard(r,F,t)}e.preventDefault()}break;case"Flt":if(c<48||c>57)if(46==c)g.indexOf(".")<0&&e.preventDefault();else if(45==c){if(-1==t.val().indexOf("-")){F="-"+t.val();i.ValByKeyboard(r,F,t)}else{F=t.val().slice(1);i.ValByKeyboard(r,F,t)}e.preventDefault()}else e.preventDefault();break;case"Cur":if(c<48||c>57){if(45==c)if(-1==t.val().indexOf("-")){F="-"+t.val();i.ValByKeyboard(r,F,t)}else{F=t.val().slice(1);i.ValByKeyboard(r,F,t)}e.preventDefault()}break;case"Al":if("farsi"==f.CurLang){!m&&c<91&&c>64&&(c+=32),m&&c<123&&c>96&&(c-=32);_=np.ValidChars.AlFarsi.charCodeAt(c-32);"~"==String.fromCharCode(_)||(t.insertAtCaret(String.fromCharCode(_)),i.ValByKeyboard(r,t.val(),t)),e.preventDefault()}else if("latin"==f.CurLang){_=np.ValidChars.AlLatin.charCodeAt(c-32);"~"==String.fromCharCode(_)||(t.insertAtCaret(String.fromCharCode(_)),i.ValByKeyboard(r,t.val(),t)),e.preventDefault()}break;case"Al2":if("farsi"==f.CurLang){!m&&c<91&&c>64&&(c+=32),m&&c<123&&c>96&&(c-=32);_=np.ValidChars.Al2Farsi.charCodeAt(c-32);"~"==String.fromCharCode(_)||(t.insertAtCaret(String.fromCharCode(_)),i.ValByKeyboard(r,t.val(),t)),e.preventDefault()}else if("latin"==f.CurLang){_=np.ValidChars.Al2Latin.charCodeAt(c-32);"~"==String.fromCharCode(_)||(t.insertAtCaret(String.fromCharCode(_)),i.ValByKeyboard(r,t.val(),t)),e.preventDefault()}break;case"ANum":if("farsi"==f.CurLang){!m&&c<91&&c>64&&(c+=32),m&&c<123&&c>96&&(c-=32);_=np.ValidChars.ANumFarsi.charCodeAt(c-32);"~"==String.fromCharCode(_)||(t.insertAtCaret(String.fromCharCode(_)),i.ValByKeyboard(r,t.val(),t)),e.preventDefault()}else if("latin"==f.CurLang){_=np.ValidChars.ANumLatin.charCodeAt(c-32);"~"==String.fromCharCode(_)||(t.insertAtCaret(String.fromCharCode(_)),i.ValByKeyboard(r,t.val(),t)),e.preventDefault()}break;case"ANum2":if("farsi"==f.CurLang){!m&&c<91&&c>64&&(c+=32),m&&c<123&&c>96&&(c-=32);_=np.ValidChars.ANum2Farsi.charCodeAt(c-32);"~"==String.fromCharCode(_)||(t.insertAtCaret(String.fromCharCode(_)),i.ValByKeyboard(r,t.val(),t)),e.preventDefault()}else if("latin"==f.CurLang){_=np.ValidChars.ANum2Latin.charCodeAt(c-32);"~"==String.fromCharCode(_)||(t.insertAtCaret(String.fromCharCode(_)),i.ValByKeyboard(r,t.val(),t)),e.preventDefault()}break;case"Txt":case"SHtm":case"Htm":if("farsi"==f.CurLang){if(c>32&&c<128){!m&&c<91&&c>64&&(c+=32),m&&c<123&&c>96&&(c-=32);_=np.ValidChars.HtmFarsi.charCodeAt(c-32);if(o)(y=(o.contentWindow||window).document.createElement("div")).innerHTML=String.fromCharCode(_),document.execCommand("insertText",!1,y.innerHTML);else"BDO"==t[0].tagName?(t.pasteHtmlAtCaret(String.fromCharCode(_),window),t[0].innerText=t[0].innerText):(t.insertAtCaret(String.fromCharCode(_)),i.ValByKeyboard(r,t.val(),t));e.preventDefault()}}else if("latin"==f.CurLang){var y;if(o){if(13!=c&&32!=c)(y=(o.contentWindow||window).document.createElement("div")).innerHTML=String.fromCharCode(c),document.execCommand("insertHtml",!1,y.innerHTML),e.preventDefault()}else t.insertAtCaret(String.fromCharCode(c)),i.ValByKeyboard(r,t.val(),t),e.preventDefault()}break;case"PDat":case"GDat":if(0==t[0].selectionStart&&t[0].selectionEnd==t[0].value.length){if(!(c<48||c>57))return void t.data("npchange","1");e.preventDefault()}g.indexOf("/")>-1&&e.preventDefault(),1==t.val().length?47==c?(t.val("/0"+t.val()),e.preventDefault(),t[0].selectionStart=0,t[0].selectionEnd=0):c<48||c>57?e.preventDefault():(C=C.substring(0,v)+String.fromCharCode(c)+C.substring(b,C.length)).length>1&&(t.val("/"+C),e.preventDefault(),t[0].selectionStart=0,t[0].selectionEnd=0):2==t.val().length?47==c?(t.val("/"+t.val()),e.preventDefault(),t[0].selectionStart=0,t[0].selectionEnd=0):(""==g||c<48||c>57)&&e.preventDefault():3==t.val().length?0==v&&0==b?(c<48||c>57)&&e.preventDefault():e.preventDefault():4==t.val().length&&(47==c?(t.val("/0"+t.val()),e.preventDefault(),t[0].selectionStart=0,t[0].selectionEnd=0):c<48||c>57?e.preventDefault():(t.val("/"+C.substr(0,1)+String.fromCharCode(c)+C.substr(1)),e.preventDefault(),t[0].selectionStart=0,t[0].selectionEnd=0))}}}}},_KeyDown:function(e,t){var n=this,a=t.attr("orgid");a&&(8==(e.keyCode?e.keyCode:e.which)&&""==t.val()&&n.BackSpaceFocus&&$.each(n.$ValidXml.r.n,(function(t,i){if(i.Nex==a&&i.Typ&&"HLnk"!=i.Typ&&"DLbl"!=i.Typ&&"MSAutoC"!=i.Typ&&n.W_.FrmFld[t].Elem&&n.W_.FrmFld[t].Enable)return n.W_.FrmFld[t].Elem.focus(),e.preventDefault(),!1})),n.BackSpaceFocus=!1)},_KeyUp:function(e,t){var n=this,a=t.attr("orgid")||t.attr("GrdObjorgid"),i=t.attr("id"),o=t.attr("GridId"),r=t.attr("OrgGridId"),l=t.attr("Np-Col-Id");if(n.BackSpaceFocus=!0,np.noNg((()=>clearTimeout(n.BackSpaceTimer))),!a&&t.hasClass("FilterTextbox"))var s={Typ:"Htm",Lan:"3",CurLang:"farsi"};else if(!(s=n._SetCurrValidationData(a,r,l)))return;if("Check"!=s.Typ){var d,p,c=n.Valid_,u=$.ui.keyCode;if(d=e.keyCode?e.keyCode:e.which,p=e.shiftKey,!([u.ESCAPE,$.ui.keyCode.ENTER].indexOf(d)>-1))if([$.ui.keyCode.BACKSPACE,$.ui.keyCode.DELETE].indexOf(d)>-1&&"1"!=s.HtmlArea){var m=t.val();n.ValByKeyboard(a,m,t)}else{if(17==d||18==d&&p){if("3"==s.Lan){if("farsi"===c.CurLang)c.CurLang="latin";else c.CurLang="farsi";s.CurLang=c.CurLang}var f=$(e.currentTarget);if(("text"==f[0].type||"textarea"==f[0].type)&&!f.attr("readonly")){var h=s.Typ||"";["Int","Num","StdNo","PDat","GDat","SSNo","Flt","Tim"].indexOf(h)>-1?GlobViewModel.LangShow.hide():(n.SetLangShowPosition(f),$("div",GlobViewModel.LangShow.show()).text("farsi"==c.CurLang?"FA":"EN"))}return np.noNg((()=>clearTimeout(n.LangTimer))),n.LangTimer=np.noNg((()=>setTimeout((function(){GlobViewModel.LangShow.hide()}),1e3))),void e.preventDefault()}switch(s.Typ){case"Num":case"Int":case"Al":case"ANum":case"Txt":case"PDat":case"GDat":case"Url":case"Email":case"StdNo":case"SSNo":break;case"Flt":if(-1==t.val().indexOf(".")&&(d==u.PERIOD||d==u.NUMPAD_DECIMAL))if(0==t.val().length||1==t.val().length&&("-"==t.val()||"+"==t.val())){m=t.val()+"0.";n.ValByKeyboard(a,m,t)}else{m=t.val()+".";n.ValByKeyboard(a,m,t)}break;case"Tim":if(d>47&&d<58||d>95&&d<106)if(2==(b=t.val()).length){m=b+":";n.ValByKeyboard(a,m,t)}else if(b.length>2&&-1==$.inArray(":",b)){m=b.slice(0,2)+":"+b.slice(2);n.ValByKeyboard(a,m,t)}break;case"Cur":if(d>47&&d<58||d>95&&d<106||d==u.BACKSPACE||d==u.DELETE){for(var g="",C=1,v=(b=t.val().replace(/,/g,"")).length-1;v>-1;v--,C++)C>1&&(C-1)%3==0&&(g=","+g),g=b[v]+g;n.ValByKeyboard(a,g,t)}break;case"Let":2==(b=t.val()).length&&n.ValByKeyboard(a,b+".",t)}if(s.Max||s.Dec){var b;switch(s.Typ){case"Cur":b=t.val().replace(/,/g,"");break;case"PDat":case"GDat":b=t.val().replace(/\//g,"").replace(/\./g,"");break;case"Tim":b=t.val().replace(/:/g,"");break;default:b="BDO"==t[0].tagName?t.html():t.val()}if(s.Dec&&b.indexOf(".")>0&&(b.length-b.indexOf(".")>parseInt(s.Dec)+1||b.length-b.indexOf(".")==parseInt(s.Dec)+1&&13!==d&&-1==$.inArray(d,c.ControlKeys))&&(b=b.substring(0,b.indexOf(".")+parseInt(s.Dec)+1),n.ValByKeyboard(a,b,t),n._Chg_Core(t,!0)))return void(o?n.NPFocusNextInGrid(t):n.NPFocusNext(i,a));if(s.Max&&(b.length>s.Max||b.length==s.Max&&-1==$.inArray(d,c.ControlKeys)&&13!==d)&&(b.length>s.Max&&(b=b.slice(0,s.Max),n.ValByKeyboard(a,b,t)),n._Chg_Core(t,!0)))return void(o?n.NPFocusNextInGrid(t):n.NPFocusNext(i,a));"1"==s.Nomreh&&(2==(b=t.val()).length&&b.indexOf(".")<0&&0!=s.To.indexOf(b)?n.ValByKeyboard(a,b+".",t):parseFloat(s.To)==parseFloat(b)&&(o?n.NPFocusNextInGrid(t):n.NPFocusNext(i,a)))}}}},_Chg_Core:function(e,t){var n,a,i,o=this,r=e.attr("orgid")||e.attr("GrdObjorgid"),l=e.attr("id"),s=e.attr("GridId"),d=e.attr("OrgGridId"),p=e.attr("Np-Col-Id"),c=!1,u={GridId:s,OrgGridId:d,NpColId:p};if(s&&(u.$CurrObj=e),e.is("input:radio")||e.is("input:checkbox")?c=!0:n=e.val(),void 0===r&&void 0!==(r=e.attr("name"))&&(c=!0,r=o.MakeOrgId(r)),!r&&!d||!(i=o._SetCurrValidationData(r,d,p)))return 0;if(i.IsAC&&e.npAutoComplete("call_change"),e.data("nphaserror",""),c)e.is("input:radio")&&o.ValByKeyboard(r,e.val(),e);else{if(!(o.CheckVal(l,r,n,!0,u)>0))return e.data("nphaserror","1"),s||t||""==i.OnCh||e.hasClass("np-select-readonly")||o._trigger(i.OnCh),0;a=e.val(),d||(a!=o.NPFormat(r,o.NPFix(r,n,u),u)||""==a&&o.Val(r)!=a)&&o.ValByKeyboard(r,n,e)}return s||t||""==i.OnCh||e.prop("readonly")||e.hasClass("np-select-readonly")||o._trigger(i.OnCh),1},_Chg:function(e,t){var n=this,a=(n.element,n.options,t.attr("orgid")),i=n.Valid_;if(n.IsBindingInProgress)return!1;if(1!=i.IsChangeInProgress){if(a){var o=n.W_.FrmFld[a];o&&!o.Enable&&n.ViewModel[a](o.LastVal)}var r=$.ui.keyCode;return(e.keyCode?e.keyCode:e.which)!=r.ENTER&&("INPUT"==t.prop("tagName")&&"text"==t.prop("type")||t.prop("type"),n._Chg_Core(t),!0)}},_Trim:function(e){return e.val(e.val.replace(/(^\s*)|(\s*$)/g,"")),e.val},_Mell:function(e){return 0==e.length||10==e.length&&("1111111111"!=e&&"0000000000"!=e&&"2222222222"!=e&&"3333333333"!=e&&"4444444444"!=e&&"5555555555"!=e&&"7777777777"!=e&&"8888888888"!=e&&"9999999999"!=e&&(("0"!=e.charAt(0)||"0"!=e.charAt(1)||"0"!=e.charAt(2)||"0"!=e.charAt(3)||"0"!=e.charAt(4)||"0"!=e.charAt(5)||"0"!=e.charAt(6))&&(c=parseInt(e.charAt(9)),n=10*parseInt(e.charAt(0))+9*parseInt(e.charAt(1))+8*parseInt(e.charAt(2))+7*parseInt(e.charAt(3))+6*parseInt(e.charAt(4))+5*parseInt(e.charAt(5))+4*parseInt(e.charAt(6))+3*parseInt(e.charAt(7))+2*parseInt(e.charAt(8)),r=n-11*parseInt(n/11),0==r&&r==c||1==r&&1==c||r>1&&c==11-r)))},_EmailCheck:function(e){var t='[^\\s\\(\\)><@,;:\\\\\\"\\.\\[\\]]+',n="("+t+'|("[^"]*"))',a=new RegExp("^"+n+"(\\."+n+")*$"),i=e.match(/^(.+)@(.+)$/);if(null==i)return!1;var o=i[1],r=i[2];for(s=0;s<o.length;s++)if(o.charCodeAt(s)>127)return!1;for(s=0;s<r.length;s++)if(r.charCodeAt(s)>127)return!1;if(null==o.match(a))return!1;var l=r.match(/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/);if(null!=l){for(var s=1;s<=4;s++)if(l[s]>255)return!1;return!0}var d=new RegExp("^"+t+"$"),p=r.split("."),c=p.length;for(s=0;s<c;s++)if(-1==p[s].search(d))return!1;return(2==p[p.length-1].length||-1!=p[p.length-1].search(/^(com|net|org|edu|int|mil|gov|arpa|biz|aero|name|coop|info|pro|museum)$/))&&!(c<2)},ConvertPersianNumberToLatin:function(e){if(!e||"string"!=typeof e)return e;var t=["0","1","2","3","4","5","6","7","8","9"];if(0==/\>(.*?)\</.test(e)){var n=0;return e.replace(/[۰۱۲۳۴۵۶۷۸۹]/g,(function(e){return"۰"==e&&(n=0),"۱"==e&&(n=1),"۲"==e&&(n=2),"۳"==e&&(n=3),"۴"==e&&(n=4),"۵"==e&&(n=5),"۶"==e&&(n=6),"۷"==e&&(n=7),"۸"==e&&(n=8),"۹"==e&&(n=9),t[+n]}))}return e.replace(/\>(.*?)\</g,(function(e){return e.replace(/[۰۱۲۳۴۵۶۷۸۹]/g,(function(e){return e.replace(/[۰۱۲۳۴۵۶۷۸۹]/g,(function(e){return"۰"==e&&(n=0),"۱"==e&&(n=1),"۲"==e&&(n=2),"۳"==e&&(n=3),"۴"==e&&(n=4),"۵"==e&&(n=5),"۶"==e&&(n=6),"۷"==e&&(n=7),"۸"==e&&(n=8),"۹"==e&&(n=9),t[+n]}))}))}))},NPFix:function(e,t,n){var a;if((t&&"string"==typeof t&&(t=this.ConvertPersianNumberToLatin(t)),(n=n||{}).$CurrObj)&&n.GridId)var o=n.OrgGridId,r=n.NpColId;if(!e&&!o||!(a=this._SetCurrValidationData(e,o,r)))return t;var l=t;switch(a.Typ){case"PDat":case"GDat":l=np.utils.NPTrim(l.replace(/\//g,"").replace(/\./g,""));break;case"Tim":l=np.utils.NPTrim(l.replace(/\:/g,""));break;case"Let":t.indexOf(".")>=0&&(l=t.substr(0,2)+t.substr(3));break;case"Cur":l=t.replace(/,/g,"");break;default:if("boolean"==typeof t&&(l=t?"1":"0"),t&&""!=a.Fil&&""!=t){var s=parseFloat(a.Max),d=a.Fil,p=a.Jus;if(t.length<s){var c="";for(i=0;i<s-t.length;i++)c+=d;l="L"==p?t+c:c+t}}}return l},NPFormat:function(e,t,n){var a;if((n=n||{}).$CurrObj&&n.GridId)var i=n.OrgGridId,o=n.NpColId;if(!e&&!i||!(a=this._SetCurrValidationData(e,i,o)))return t;var r=t;switch(a.Typ){case"PDat":case"GDat":if(8!=(r=(r=r.replace(/\//g,"")).replace(/\./g,"")).length)return t;r=r?r.substr(0,4)+"/"+r.substr(4,2)+"/"+r.substr(6,2):"";break;case"Tim":r=(r=r.replace(/\:/g,""))?r.substr(0,2)+":"+r.substr(2,2):"";break;case"Cur":for(var l=r.replace(/,/g,""),s="",d=1,p=l.length-1;p>-1;p--,d++)d>1&&(d-1)%3==0&&(s=","+s),s=l.substr(p,1)+s;r=s}return r},CheckValNotVisibleElem:function(e,t){return!0},CheckValidChars:function(e,t){var n=t.Lan,a="";a="1"==n?np.ValidChars.ANumFarsi:"2"==n?np.ValidChars.ANumLatin:np.ValidChars.ANumFarsi.concat(np.ValidChars.ANumLatin);var i=String.fromCharCode(96),o="[^("+a.replace(/~/g,"")+i+"!@#$^%&()\\-.+,/\"_{|}\\[,?؟\\]*\r\t<>\n=';:)]";return!e.match(new RegExp(o,"g"))},CheckVal:function(e,t,n,a,i){var o,r,l,s=this,d=s.options,p=s.NPGen?s.NPGen.ver:0;if((i=i||{}).$CurrObj&&i.GridId)var c=i.OrgGridId,u=i.NpColId;if(!t&&!c||!(o=s._SetCurrValidationData(t,c,u)))return-1;l=c?o.Req:s.W_.FrmFld[t].CheckValReq;var m=e&&$("#"+e).is(":visible");if(p<305&&!c&&!m&&"1"!=o.HtmlArea)return 1;"1"==l&&d.IsCmp&&(s.ComponentReq&&"1"==s.ComponentReq||(l="0"));var f=s.NPFix(t,n,i);if(f=np.utils.NPTrim(f),o.MSAutoC&&"0"!=o.MSAutoC&&!c){if("1"!==l)return 1;var h=o.IsAC?s.Val(o.MSAutoC):s.W_.FrmFld[t].WidgetSelf.GetFinalValOfCmp();if(0==(h=$("row",h).length))return r="مقدار معتبری انتخاب نشده است",s._ShowError(e,t,r,a,i),-1}var g=!1,C=s.W_.FrmFld[t]&&s.W_.FrmFld[t].Act,v="Cmp"==o.Typ?o.VTyp||"Txt":o.Typ;if(C&&"Cmp"!==o.Typ){var b=s.Acts["act"+C].relfield||[];$.each(b,(function(e,t){"_TempField"!=t.id&&""==s.Val(t.id)&&"1"==s.W_.FrmFld[t.id].Req&&s.W_.FrmFld[t.id].Enable&&(g=!0)}))}var _=o.DescTyp||"Txt";if(i&&i.Desc&&"Txt"==_&&f)return s._ShowError(e,t,"",!1,i),1;if("boolean"==typeof f||f){if(C&&g&&"1"==l)return r="مقدار معتبری انتخاب نشده است",s._ShowError(e,t,r,a,i),-1;if(i&&i.Desc)return s._ShowError(e,t,"",!1,i),1;if(""!=o.Min&&f.length<parseFloat(o.Min))return r='طول"'+o.Cap+'" نمي تواند کمتر از  '+o.Min+" کاراکتر باشد",s._ShowError(e,t,r,a,i),-1;if(""!=o.Max&&f.length>parseFloat(o.Max))return r='طول"'+o.Cap+'" نمي تواند بیشتر از  '+o.Max+" کاراکتر باشد",s._ShowError(e,t,r,a,i),-1;switch(v){case"GDat":var F=0;if(f&&isNaN(f)&&(F=1,r="تاریخ نمی تواند غیرعددی باشد"),F)return s._ShowError(e,t,r,a,i),-1;break;case"PDat":F=0;var y=f.substr(6,2),w=f.substr(4,2);f.substr(0,4);if(parseInt(f)<parseInt(o.Fro)&&(r=o.Cap+" کمتر از مقدار مجاز است",F=1),parseInt(f)>parseInt(o.To)&&(r=o.Cap+" بیشتر از مقدار مجاز است",F=1),parseInt(w)<=6&&parseInt(y)>31&&(F=1,r="روز نمی تواند بزرگتر از 31 باشد"),parseInt(w)>6&&parseInt(y)>30&&(F=1,r="روز نمی تواند بزرگتر از 30 باشد"),parseInt(w)>12&&(F=1,r="ماه نمی تواند بزرگتر از 12 باشد"),parseInt(y)<=0&&(F=1,r="روز نمی تواند کوچکتر از 1 باشد"),parseInt(w)<=0&&(F=1,r="ماه نمی تواند کوچکتر از 1 باشد"),f&&isNaN(f)&&(F=1,r="تاریخ نمی تواند غیرعددی باشد"),F)return s._ShowError(e,t,r,a,i),-1;break;case"Tim":var A=0,S=f.substring(0,2),I=f.substring(2,4);if(parseInt(I)>59&&(A=1,r="دقیقه نباید بیشتر از 59 باشد"),parseInt(S)>23&&(A=1,r="ساعت نباید بیشتر از 23 باشد"),f&&isNaN(f)&&(F=1,r="ساعت نمی تواند غیرعددی باشد"),(f.length<4||!f.substr(2,2).match(/^\d+$/)||!f.substr(0,2).match(/^\d+$/))&&(A=1,r="مقدار نامعتبر است"),A)return s._ShowError(e,t,r,a,i),-1;break;case"SSNo":var T=f.replace(/(\/)/g,"");if(!s._Mell(T))return r=o.Cap+" نامعتبر است",s._ShowError(e,t,r,a,i),-1;break;case"Email":if(T=(T=f.replace(/(\/)/g,"")).toLowerCase(),!s._EmailCheck(T))return r=o.Cap+" نامعتبر است",s._ShowError(e,t,r,a,i),-1;break;case"StdNo":if(isNaN(f)||f.length>LengthOfStudentNo)return r=o.Cap+" نامعتبر است",s._ShowError(e,t,r,a,i),-1}if(-1!=$.inArray(v,["Num","Int","Cur","Flt"])){var N=np.utils.NPChangeNumToLatin(f);if(isNaN(N))return r="Cmp"==o.Typ?"مقدار معتبری انتخاب نشده است":o.Cap+" نمي تواند غير عددي باشد",s._ShowError(e,t,r,a,i),-1;if(""!=o.Dec&&f.length-f.indexOf(".")-1>parseInt(o.Dec)&&f.indexOf(".")>=1)return r=o.Cap+'" نمي تواند بيش از '+o.Dec+' رقم اعشار داشته باشد"',s._ShowError(e,t,r,a,i),-1;if(""!=o.Fro&&f<parseFloat(o.Fro))return r=o.Cap+'" نمي تواند کوچکتر از  '+o.Fro+' باشد"',s._ShowError(e,t,r,a,i),-1;if(""!=o.To&&f>parseFloat(o.To))return r=o.Cap+'" نمي تواند بزرگتر از '+o.To+' باشد"',s._ShowError(e,t,r,a,i),-1}}else if("1"==l&&(!o.MSAutoC||"0"==o.MSAutoC))return r="مقدار معتبری انتخاب نشده است"+(!m&&o.Cap&&"-"!=o.Cap&&"LOOKUPF"!=o.Cap?": "+o.Cap:""),s._ShowError(e,t,r,a,i),-1;return s._ShowError(e,t,"",!1,i),1},ShowError:function(e,t,n,a,i){this._ShowError(e,t,n,a,i)},ShowErrorMessageCallback:$.noop,_ShowError:function(e,t,n,a,i){var o=this,r=o.element,l=o.options,s=(i=i||{}).$CurrObj;if(s){var d=i.GridId;if(d)var p=i.OrgGridId,c=i.NpColId;p&&n&&(o.Message({text:n,AfterSelect:function(){o.ShowErrorMessageCallback(null,d,c,n)}}),s.select(),s.focus())}else{var u=o.W_.FrmFld[t];if(u.WidgetSelf&&"Cmp"==u.Valid.Typ&&u.Valid.OnAC){var m=u.WidgetSelf.GetOrgId();u=u.WidgetSelf.W_.FrmFld[m]}var f=u.ElemTooltipOverlay,h=u.Elem;if(u&&"SHtm"==u.Valid.Typ&&(h=h.siblings("div")?h.siblings("div"):h),h&&h.length||(h=$("#"+e,r)).attr("GridId")&&(f=h),h&&h.length){if(!f){var g=h;u.ElemReqPar&&(g=u.ElemReqPar);var C=g.parent();f=C.is("span")?C:h,u.ElemTooltipOverlay=f}var v="";if(""!=n){if(""!==(v=u.lastnptitle||"")?(f.tooltip("dispose"),f.removeAttr("data-original-title")):(""==(v=h.attr("title")||"")&&(v="*"),u.lastnptitle=v),f.length>0&&!f.is(":visible")){for(f=f.parent();f.length>0&&!f.is(":visible");)f=f.parent();var b=f.attr("title");f.attr("title",n),setTimeout((function(){f.tooltip("dispose"),f.removeAttr("data-original-title"),f.attr("title",b||"")}),2e3)}else f.attr("title",n);np.noNg((()=>setTimeout((function(){f.tooltip("show"),np.noNg((()=>setTimeout((function(){f.tooltip("hide")}),3e3)))}),100))),a&&o.NPSetFocus(e,t,!1,a)}else""!==(v=u.lastnptitle||"")&&("*"==v&&(v=""),f.tooltip("dispose"),f.removeAttr("data-original-title"),f.attr("title",v),u.lastnptitle="")}else{var _=u.dm&&u.dm[0];_&&l.ParentCmp&&l.ParentCmp._ShowError(null,_,n,a)}}},NPFocusNextInGrid:function(e){for(var t=this,n=t.element,a=(t.options,e.attr("GridId")),i=0;++i<200;){var o=e.attr("GrdNexObjid");if(!(o=$("#"+o,n))||!o.length)return void(t.MakeOrgId(a)&&t.NPFocusNext(null,t.MakeOrgId(a)));if(o.is(":visible")&&!o.prop("readonly")&&!o.attr("readonly")&&!o.prop("disabled"))return o.focus(),void o.select();e=o}},NPFocusNext:function(e,t,n){var a,i=this,o=i.element,r=i.options,l=!1;if("Cmp"==e){if(n=t,(t=i.$ValidXml.r.FirstElem)||(t=null,$.each(i.$ValidXml.r.n,(function(e,n){return t=e,!1}))),l=!0,!t)return!1;e=i.MakeFullId(t)}else(n=n||i.W_.FrmFld[t]&&i.W_.FrmFld[t].Elem)&&n.blur();for(var s=0;s<500;){var d;if(!(d=i._SetCurrValidationData(t)))return;if(l||(t=d.Nex),l=!1,t&&!i.W_.FrmFld[t]&&i.W_.Alias2Id[t.toUpperCase()]&&(t=i.W_.Alias2Id[t.toUpperCase()]),(!t||!i.W_.FrmFld[t])&&r.ParentCmp)return e=o.parent().prop("id"),t=r.ParentCmp.MakeOrgId(e),void r.ParentCmp.NPFocusNext(e,t,n);if(!t||!i.W_.FrmFld[t]||"Com"===t||s>498)return void $("button:visible:not(.dropdown-toggle)",i.W_.$dvfrmFooter).each((function(e,t){var n=$(t);if(!n.is(":np-npButton")||!n.npButton("option","disabled"))return n.focus(),!1}));if(e=i.MakeFullId(t),a=i.W_.FrmFld[t].Elem,"DLbl"!=i.W_.FrmFld[t].Valid.Typ&&"_Var"!=i.W_.FrmFld[t].Valid.Typ&&a&&!(a.length<1)&&i.W_.FrmFld[t].Enable&&!a.prop("readonly")&&a.is(":visible")&&!a.attr("readonly"))break;s++}if(!(s>498)){try{if(i.W_.FrmFld[t]&&"Cmp"==i.W_.FrmFld[t].Valid.Typ&&i.W_.FrmFld[t].WidgetSelf.NPFocusNext("Cmp",n))return!0;switch(a.prop("tagName").toUpperCase()){case"BUTTON":case"SPAN":case"IMG":a.focus(),a.click();break;case"TEXTAREA":case"INPUT":a.focus(),a.select();break;case"SELECT":a.focus()}}catch(o){}return!0}},NPSetFocus:function(e,t,n,a){var i,o=this,r=(i=t&&o.W_.FrmFld[t]?o.W_.FrmFld[t].Elem:$("#"+e,o.W_.$bod)).attr("orgid")?i.attr("orgid"):t;r&&o.W_.FrmFld[r]&&"SHtm"==o.W_.FrmFld[r].Valid.Typ&&(i=i.siblings("div")?i.siblings("div"):i),t=t||i.attr("orgid");for(var l,s=o.W_.FrmFld,d=o.MakeOrgId(e);(l=d.indexOf("_W_"))&&l>-1;){var p=d.substring(0,l);if(!o.W_.FrmFld[p]||!o.W_.FrmFld[p].WidgetSelf)break;s=o.W_.FrmFld[p].WidgetSelf.W_.FrmFld,d=d.substr(l+3)}if(s[t]&&s[t].WidgetSelf&&"Cmp"==s[t].Valid.Typ&&s[t].Valid.OnAC){var c=s[t].WidgetSelf.GetOrgId();i=s[t].WidgetSelf.GetFldWidgetElem(c)}if(i.prop("readonly"))this.NPFocusNext(e,t);else{try{if(a)np.noNg((()=>setTimeout((function(){i[0].focus({preventScroll:n})}),0)));else if("DIV"===i.prop("tagName").toUpperCase())$("input:eq(0)",i)[0].focus({preventScroll:n});else np.noNg((()=>setTimeout((function(){i.data().datepicker||(i[0].focus({preventScroll:n}),i.select())}),0)))}catch(e){}n?("FIELDSET"!=i[0].tagName&&i.addClass("ui-state-highlight"),np.noNg((()=>setTimeout((function(){i.removeClass("ui-state-highlight")}),300)))):(i.addClass("ui-state-error"),np.noNg((()=>setTimeout((function(){i.removeClass("ui-state-error")}),300))))}return 1},SetDashOpr:function(e,t){t=this.Val(t),this.Val(e,t.split("@@")[1])},ValidAddCond:function(e){this.$ValidXml.r.modes["mod"+e.Mode].Cond.push({if:e.if})},ValidAddImgCond:function(e){this.$ValidXml.r.modes["mod"+e.Mode].imgCond.push({if:e.if})},ValidSetNexMod:function(e){this.$ValidXml.r.acts["act"+e.act].NexMod[e.p-1].mod=e.mod,e.cond&&(this.$ValidXml.r.acts["act"+e.act].NexMod[e.p-1].cond=e.cond)},ValidAddNexMod:function(e){var t=this;t.$ValidXml.r.acts["act"+e.act].NexMod=t.$ValidXml.r.acts["act"+e.act].NexMod||[],t.$ValidXml.r.acts["act"+e.act].NexMod.push({mod:e.mod,cond:e.cond||""})},ValidationDelete:function(e){var t=this.$ValidXml.r.modes,n=[e];this.RequireInitFrm=!0,$.each(t,(function(e,t){var a=t.Cond;$.each(a,(function(e,t){$.each(["Ena","Hide","Show","Dis","NReq","Req","Clear"],(function(e,a){t["Exc"+a]=t["Exc"+a]||{},$.each(n,(function(e,n){delete t["Exc"+a][n],delete t["Exc"+a][n+"_Div"]}))}))}))}))},Validation:function(e){var t,n=this,a=e.f,i=e.Mode,o=e.Cond;n.RequireInitFrm=!0,void 0===a&&(a="all"),void 0===i&&(i="all"),void 0===o&&(o="all"),"all"==a||Array.isArray(a)||(a=[a]),void 0!==e.display&&("none"==e.display?e.Show=0:e.Show=1),void 0!==e.Disa&&("true"==e.Disa?e.Ena=0:e.Ena=1),void 0!==e.Ena&&("disable"==e.Ena&&(e.Ena=0),"enable"==e.Ena&&(e.Ena=1)),void 0!==e.visibility&&("hidden"==e.visibility?e.Show=0:e.Show=1),void 0===e.Show&&void 0!==e.Hide&&(e.Show=1,1==e.Hide&&(e.Show=0)),void 0!==e.Show&&void 0===e.Hide&&(e.Hide=1,1==e.Show&&(e.Hide=0)),"all"==i?t=n.$ValidXml.r.modes:(t=[],Array.isArray(i)||(i=[i]),$.each(i,(function(e,a){n.$ValidXml.r.modes["mod"+a]&&t.push(n.$ValidXml.r.modes["mod"+a])}))),$.each(t,(function(t,i){var r=i.Cond;0==r.length&&r.push({if:""}),"all"!=o&&(r=[],Array.isArray(o)||(o=[o]),$.each(o,(function(e,t){i.Cond[t]&&r.push(i.Cond[t])}))),$.each(r,(function(t,i){$.each(["Ena","Hide","Show","Dis","NReq","Req","Clear"],(function(t,o){i["Exc"+o]=i["Exc"+o]||{},0===e[o]&&("all"==a?i["Exc"+o]={}:$.each(a,(function(e,t){"Hide"!=o&&"Show"!=o||n.W_.FrmFld[t+"_Div"]&&(t+="_Div"),delete i["Exc"+o][t]}))),1===e[o]&&"all"!=a&&$.each(a,(function(e,t){"Hide"!=o&&"Show"!=o||n.W_.FrmFld[t+"_Div"]&&(t+="_Div"),i["Exc"+o][t]=""}))}))}))}))},GetGidOfCellName:function(e){var t=[];return $.each(this.W_.FrmFld,(function(n,a){a.Valid.CellName==e&&t.push(n)})),t},CommanderIcon:function(e){var t,n=this,a=e.ImgId,i=e.Mode,o=e.Cond;void 0!==e.display&&("none"==e.display?e.Show=0:e.Show=1),void 0!==e.Disa&&("true"==e.Disa?e.Enable=0:e.Enable=1),n.RequireInitFrm=!0,void 0===a&&(a="all"),void 0===i&&(i="all"),void 0===o&&(o="all");var r={IM08_Control:"IM01",IM06_Search:"IM08",IM01_Create:"IM09",IM01_Delete:"IM09",IM03_Modify:"IM09",IM13_Do:"IM09",IM11_Reset:"IM99"};"all"==i?t=n.$ValidXml.r.modes:(t=[],Array.isArray(i)||(i=[i]),$.each(i,(function(e,a){n.$ValidXml.r.modes["mod"+a]&&t.push(n.$ValidXml.r.modes["mod"+a])}))),"all"==a||Array.isArray(a)||(a=[a]),$.each(a,(function(e,t){if(t.indexOf("xx_")>-1){var n=t.split("xx_")[1];a[e]=r[n]}})),$.each(t,(function(t,n){var i=n.imgCond;"all"!=o&&(i=[],Array.isArray(o)||(o=[o]),$.each(o,(function(e,t){n.imgCond[t]&&i.push(n.imgCond[t])}))),$.each(i,(function(t,n){"all"!=a&&e.Append&&$.each(a,(function(e,t){n[t]||(n[t]={})})),$.each(n,(function(t,n){"if"!=t&&(a.indexOf(t)>-1||"all"==a)&&(0===e.Show?n.Hidden=1:1===e.Show&&(n.Hidden=0),0===e.Enable?n.Enable="1":1===e.Enable&&(n.Enable="2"),e.Text&&(n.text=e.Text),e.Icon&&(n.icon=e.Icon))}))}))}))},ShowCommander:function(e){var t=this.$np("#tbFooterAlignmentRight",this.W_.$tbFooterAlignment);e?t.removeClass("np-d-none"):t.addClass("np-d-none")},OpenedInWindow:function(){return!!this.options.OpenInDialog},OpenWindow:function(e){var t=this,n=(t.element,t.options,(e=e||{}).ftype),a=e.fid,i=e.subfrm||0,o=e.outpar,r={outpar:{},doact:{}};$.each(o,(function(e,t){r.outpar[e]=t})),r.doact.act=e.doact,e.inxml=r,e.After=!0,t.OpenNewForm(n,a,i,e)},npnfwin:function(e,t,n,a,i,o,r,l){var s=this,d=(s.element,s.options,{ftype:e,fid:t=parseInt(t),subfrm:n,OpenInDialog:void 0===o||o,HideOpener:r||!1,OpenInDialog_ShowModal:l||!1,doact:a,ReturnCaption:"بازگشت",AfterClose:i,outpar:{},call:function(){for(var e=0;e<arguments.length;e+=2)this.outpar[arguments[e]]=arguments[e+1]},setscale:function(e,t){this.Width=e,"90%"==t&&(t=$(window).height()-150),this.Height=t,s.OpenWindow(this)}});return d},setValidation:function(e,t,n){var a=this;a.element,a.options;Array.isArray(e)||(e=[e]),"Nul"==t&&(t="Req",n="1"==n?"0":"1");for(var i=0;i<e.length;i++)a.W_.FrmFld[e[i]].Valid[t]=n},getValidation:function(e,t){var n=this;n.element,n.options;return n.W_.FrmFld[e].Valid[t]},Grid:function(e){var t=this,n=(t.element,t.options,e.id);switch(e.type){case"self":return t.$np("#"+n).npgrid("instance");case"rowcount":return e.Responsive?$("div.row:visible",t.$np("#"+n).npgrid("instance").$GridBody).length:$("tr",t.$np("#"+n).npgrid("instance").$GridBody).length;case"setoption":$.each(e.option,(function(e,a){t.$np("#"+n).npgrid("option",e,a)}));break;case"hidecol":(a=e.colname)&&t.$np("#"+n).npgrid("ShowHideColByName",a,1),e.width&&t.$np("#"+n).npgrid("instance")._vm.GridWidth(e.width);break;case"showcol":(a=e.colname)&&t.$np("#"+n).npgrid("ShowHideColByName",a,0),e.width&&t.$np("#"+n).npgrid("instance")._vm.GridWidth(e.width);break;case"showtag":var a=e.colname,i=t.$np("#"+n).npgrid("GetColId",a);t.$ValidXml.r.n[n].col[i].SHOWTAG=e.showtag,t.$np("#"+n).npgrid("SetShowTage",a,e.showtag);case"event":"change"==e.event&&t._on($(t.$np("#"+n).npgrid("widget")),{"change :input[gridid]":e.change})}},RunAfterAct:function(){var e=this,t=(e.element,e.options);t.ReturnActParam&&e._trigger("AfterAct",null,t.ReturnActParam)},FadeShow:function(e,t,n){$(e).hide().fadeIn({duration:1e3})},FadeHide:function(e,t,n){$(e).hide({duration:1e3},(function(){}))},_destroy:function(){var e=this,t=e.options;$.each(e.W_.HelpGrids,(function(e,t){if(null!==t)try{t.remove()}catch(e){}})),$.each(e.W_.HelpDialogs,(function(e,t){if(null!==t)try{t.remove()}catch(e){}})),$.each(e.W_.FrmFld,(function(t,n){switch(n.Valid.Typ){case"Grd":n.Elem.is(":np-npgrid")&&n.Elem.npgrid("destroy");break;case"SHtm":case"Htm":ko.removeNode(e.$np("#"+t)[0])}})),ko.removeNode(e.W_.$bod[0]),delete t.IsCmp,delete t.ParentCmp,delete t.ParentCmp,delete t.UseOpenerAut,delete t.OpenerSelf,delete e.W_,delete e.Valid_,delete e.$ValidXml}})}(jQuery,NowPardaz),function(e){e.fn.pasteHtmlAtCaret=function(e,t,n){var a,i;if((t=t||window).getSelection){if((a=t.getSelection()).getRangeAt&&a.rangeCount){(i=a.getRangeAt(0)).deleteContents();var o=t.document.createElement("div");o.innerHTML=e;for(var r,l,s=t.document.createDocumentFragment();r=o.firstChild;)l=s.appendChild(r);i.insertNode(s),l&&((i=i.cloneRange()).setStartAfter(l),i.collapse(!0),a.removeAllRanges(),a.addRange(i))}}else t.document.selection&&"Control"!=t.document.selection.type&&t.document.selection.createRange().pasteHTML(e)},e.fn.NPSelectionStart=function(){if(this.length)return this[0].selectionStart},e.fn.NPSelectionEnd=function(){if(this.length)return this[0].selectionEnd},e.fn.NPSelectionText=function(){if(this.length){var e=this[0].selectionStart,t=this[0].selectionEnd,n=this[0].value;return void 0!==e&&t&&e!=t?n.substring(e,t):""}},e.fn.insertAtCaret=function(e){return this.each((function(){if(this.selectionStart||"0"==this.selectionStart){var t=this.selectionStart,n=this.selectionEnd,a=this.scrollTop;this.value=this.value.substring(0,t)+e+this.value.substring(n,this.value.length),this.focus(),this.selectionStart=t+e.length,this.selectionEnd=t+e.length,this.scrollTop=a}else this.value?this.value+=e:this.value=e,this.focus()}))},npLog=function(e,t){try{console&&(t?console.error(e):console.log(e))}catch(e){}}}(jQuery),function(e){var t,n;e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},n={},(t=e.uaMatch(navigator.userAgent)).browser&&(n[t.browser]=!0,n.version=t.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),e.browser=n,e.sub=function(){function t(e,n){return new t.fn.init(e,n)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(a,i){return i&&i instanceof e&&!(i instanceof t)&&(i=t(i)),e.fn.init.call(this,a,i,n)},t.fn.init.prototype=t.fn;var n=t(document);return t}}(jQuery),function(e){e.widget("np.npdownload",{options:{url:"/frm/npdwn/default.aspx",param:null,InData:null,AfterGO:null,BeginGO:null,EndGO:null},_create:function(){var e=this;e.options;e.element.click((function(){e.AfterClick()}))},AfterClick:function(){var t=this,n=t.options;t.element;if((!this.element||!e(this.element).hasClass("ui-state-disabled"))&&(t.data={},t._trigger("InData",null,t.data)))if(t._trigger("BeginGO")){var a=new FormData;a.append("medxml",escape(t.data.xml)),np.noNg((()=>fetch(n.url,{method:"POST",body:a}).then((e=>e.text())).then((a=>{if(t._trigger("EndGO"),a&&(t.data.xml=e(a).find("#medxml").val())&&0!==t.data.xml.length){t.data.param=n.param,t._trigger("AfterGO",null,t.data);var i="",o=JSON.parse(t.data.xml);if(0==o.msg.errors.length){o.outpar&&e.each(o.outpar,(function(e,t){i=i+"&"+e+"="+t}));var r=o.outpar&&o.outpar.cfn||"NP.Zip";np.noNg((()=>fetch("/frm/npdwn/getfile.ashx?"+i.substr(1),{method:"GET"}).then((e=>e.blob())).then((e=>{var t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=r,document.body.appendChild(n),n.click(),n.remove()}))))}}else t.err=!0})).catch((e=>console.error("Error:",e)))))}else t.SetRespmsg({c:[{m:[{e:"1",m:"لطفا صبر کنید"}]}]})}}),e.widget("np.npupload",{options:{url:"/frm/npupl/default.aspx",param:null,AppendTo:null,InData:null,AfterGO:null,BeginGO:null,EndGO:null},_create:function(){var t=this,n=t.options,a=t.element,i="upload"+(new Date).getTime()+parseInt(1e6*Math.random());t.uploadElem=e('<input type="file" id="'+i+'" style="display:none" />').appendTo(n.AppendTo),t.uploadElem.change((function(){var a=t.uploadElem.get(0);if(a.files.length)if(t._trigger("BeginGO")){var i=new FormData;i.append("medxml",t.medxml),i.append("fileupl",a.files[0]),np.noNg((()=>fetch(n.url,{method:"POST",body:i}).then((e=>e.text())).then((i=>{a.value="",t._trigger("EndGO"),i&&(t.data.xml=e(i).find("#medxml").val())&&0!==t.data.xml.length?(t.data.param=n.param,t._trigger("AfterGO",null,t.data)):t.err=!0})).catch((e=>{a.value="",console.error("Error:",e)}))))}else t.SetRespmsg({c:[{m:[{e:"1",m:"لطفا صبر کنید"}]}]})})),a.click((function(){t.AfterClick()}))},AfterClick:function(){var t=this;t.options,t.element;this.element&&e(this.element).hasClass("ui-state-disabled")||(t.data={},t._trigger("InData",null,t.data)&&(t.medxml=escape(t.data.xml),t.uploadElem.click()))},_destroy:function(){this.uploadElem.remove()}})}(jQuery),function(e){e.widget("np.npmessage",{options:{type:"alert",text:"",height:200,width:300,title:"پيغام",category:"def",MessageCallback:null},_create:function(){var t=this,n=t.options,a=t.element;t.AlertButton={"تایید":function(){t.TriggerFired=!0,e(this).npUiDialog("close"),t._trigger("MessageCallback",null)}},t.ConfirmButton=[{text:"بله",click:function(){t.TriggerFired=!0,e(this).npUiDialog("close"),t._trigger("MessageCallback",null,{yes:!0,no:!1})},class:"offset-1"},{text:"خیر",click:function(){t.TriggerFired=!0,e(this).npUiDialog("close"),t._trigger("MessageCallback",null,{yes:!1,no:!0})}}],t.DialogContent=e("<div/>"),a.append(t.DialogContent),t.DialogContent.npUiDialog({autoOpen:!1,closeOnEscape:!1,resizable:!1,appendTo:a,title:n.title,modal:!0,close:function(){t.TriggerFired||(t.ConfirmButton==t.DialogContent.npUiDialog("option","buttons")?t._trigger("MessageCallback",null,{yes:!1,no:!0}):t._trigger("MessageCallback",null))}})},Dialog:function(e){var t,n=this,a=n.options;n.element;a.MessageCallback=e.AfterSelect||null,t="confirm"==(e.type||a.type)?n.ConfirmButton:n.AlertButton;var i="err"==a.category?"text-danger":"suc"==a.category?"text-success":"";n.DialogContent.html("<p style='text-align:center;padding-top:20px;padding-right:30px;padding-left:30px' class='"+i+"'>"+e.text+"</p>"),n.TriggerFired=!1,n.DialogContent.npUiDialog("option","title",e.title||a.title).npUiDialog("option","CloseParentModal",!1).npUiDialog("option","width",e.width||a.width).npUiDialog("option","buttons",t).npUiDialog("open")}}),e.widget("np.npeditor",{options:{npform:null,Minimize:"0",title:null,change:null,HideIcon:!1},_create:function(){var t=this,n=t.options,a=t.element;id=a.attr("id");var i=a.outerWidth()-3,o=a.outerHeight();i<200&&(i=450),o<45&&(o=45),t.EditorHeight=0,t.ElemId=a.attr("id")+"_Editor";var r=a[0].className||"",l=a[0].style.width?a[0].style.width:"auto",s=parseInt(o)+20;t.Parent=e("<div style='border:1px solid #ccc;;width:"+l+";heigh_t:"+s+"px;overflow:hidden'class='m-2 border-radius6000 "+r+"'></div>"),t.RequireSpan=e("<span style='float:left;display:none'>*</span>").appendTo(t.Parent);var d=null;"1"==n.Minimize?d=e("<i class='npglyphicon npglyph-popout text-success' style='font-size:17px' title='"+n.title+"' ></i>").appendTo(t.Parent):n.HideIcon||(d=e("<i class='npglyphicon npglyph-popout text-success' style='font-size:17px' ></i>").appendTo(t.Parent)),t.FullScr=d,t.Main=e("<div style='padding:0px;margin:0px;height:"+o+"px;overflow-y:scroll;width:100%'  ></div>").appendTo(t.Parent),"1"==n.Minimize&&t.Main.css("display","none"),t.Buttons=e("<div style='display:none;padding:auto 8px;margin-bottom:5px' class='bg-info'><button class='btn btn-info' style='padding:3px 8px;margin-left:4px;margin-right:4px'><i id='bold' title='درشت' class='npglyphicon glyphicon-bold' style='margin-left:10px' ></i></button><button class='btn btn-info' style='padding:3px 8px;margin-left:4px'><i id='italic' title='کج' class='npglyphicon glyphicon-italic' style='margin-left:10px'></i></button><button class='btn btn-info' style='padding:3px 8px;margin-left:4px'><i id='JustifyLeft' title='چپ چین' class='npglyphicon npglyphicon-align-left2' style='margin-left:10px'></i></button><button class='btn btn-info' style='padding:3px 8px;margin-left:4px'><i id='JustifyCenter' title='وسط چین' class='npglyphicon npglyphicon-align-center2' style='margin-left:10px'></i></button><button class='btn btn-info' style='padding:3px 8px;margin-left:4px'><i id='JustifyRight' title='راست چین' class='npglyphicon npglyphicon-align-right2' style='margin-left:10px'></i></button><button class='btn btn-info' style='padding:3px 8px;margin-left:4px'><i id='underline' title='زیر خط دار' class='npglyphicon npglyphicon-COMM'></i></button></div>").appendTo(t.Main),t.BackButton=e("<button class='btn btn-outline-danger' style='display:none;padding: 3px 6px;float:left;margin-left:10px' ></button>"),t.Buttons.append(t.BackButton);var p=a.attr("dir")||np.rtl,c="ltr"==p?"left":"right",u=t.Editor=e("<div id="+t.ElemId+" contenteditable='true' class='np-editor' dir='"+p+"'   style='text-align:"+c+";white-space: pre-wrap;width:auto;height:auto;display:block;outline:none;word-wrap: break-word;margin-right:5px' ></div>").appendTo(t.Main);t.HtmlBox=e("<div style='display:none'><textarea cols='50' rows='2' dir='ltr'></textarea><button>ثبت</button></div>").appendTo(t.Parent),t.Parent.insertAfter(a),np.noNg((()=>setTimeout((function(){a.hide()}),100))),t._on(t.Main,{click:function(){u.focus()}}),t._on(!0,d,{click:function(n){t.parentModal=e(n.currentTarget).closest(".modal"),d.hide(),t.Buttons.show();var a=t.options.npform.Get$bod();Array.max([e("body").height()-300,parseInt(4*e("body").height()/5,10)]),Array.max([a.width()-300,parseInt(4*a.width()/5,10)]);t.Main.SimpleDialog({title:"ویرایشگر متن",show:!0,destroyOnClose:!0,appendTo:t.options.npform.$np("#bod"),onShow:function(e,n){t.Main.css("height","auto")},onShow_:function(n,a){if(n.target.style.overflowY="visible",n.target.parentElement.style.overflow="auto",n.target.style.width="fit-content",n.target.style.minWidth="100%",u.focus(),t.SetZIndex(e(n.target).parent()),0!=t.parentModal.length){var i="<span>بازگشت به : </span> "+e(".modal-title",t.parentModal).text();t.BackButton.show().html(i)}t.UpdateToolbar()},close:function(e,n){t.Buttons.hide(),d.show()}})}}),t._on(t.HtmlBox,{"click button":function(n){u.pasteHtmlAtCaret(e("textarea",t.HtmlBox).val(),u.contentWindow,u)}}),t._on(u,{blur:function(e){t._trigger("change",e,{Val:u.html().replace(/style="color: rgb\(133, 133, 133\);"/g,"")})},keyup:function(n){t.options.npform._KeyUp(n,e(t.element)),t.UpdateToolbar()},keypress:function(n){t.options.npform._KeyPress(n,e(t.element),{EditorId:u})},paste:function(e){var t;return e.originalEvent.clipboardData&&(t=(t=e.originalEvent.clipboardData.getData("text/plain")).replace(/\n/g,"<br />"),document.execCommand("insertHTML",!1,t)),!1},mouseup:function(){t.UpdateToolbar()}}),t._on(t.Buttons,{"click button":function(n){var a=e(n.currentTarget).find("i");switch(document.execCommand("styleWithCSS",!1,!1),a.attr("id")){case"bold":document.execCommand("bold",0,null);break;case"italic":document.execCommand("italic",0,null);break;case"underline":document.execCommand("underline",0,null);break;case"JustifyLeft":document.execCommand("JustifyLeft",0,null);break;case"JustifyRight":document.execCommand("JustifyRight",0,null);break;case"JustifyCenter":document.execCommand("JustifyCenter",0,null);break;case"ltr":case"rtl":document.execCommand("fontName",!1,"_");var i=a.attr("id"),o="ltr"==i?"left":"right",r=0,l=e("[style*='_']",t.Editor),s=e("[face*='_']",t.Editor);0!=l.length?(r=1,l.parent("div").hasClass("np-editor")?(l.wrap("<div></div>"),l.css("font-family","tahoma").parent("div").css("text-align",o).attr("dir",i)):l.parent("div").css("text-align",o).attr("dir",i)):0!=s.length&&(r=1,"0"!=s.closest("p").length?s.closest("p").attr("align",o).attr("dir",i):(s.wrap("<p></p>"),s.attr("face","tahoma").closest("p").attr("align",o).attr("dir",i))),document.execCommand("fontName",!1,"tahoma"),t.Editor.attr("dir",np.rtl),r&&a.addClass("ui-state-highlight")}t.UpdateToolbar()}})},SetZIndex:function(e){},getSelectionCoords:function(e){var t,n,a=(e=e||window).document.selection,i=0;return a?(t=document.createRange(),document.getElementById(this.ElemId).getClientRects()[0]&&(i=document.getElementById(this.ElemId).getClientRects()[0].bottom)):e.getSelection&&(a=e.getSelection()).rangeCount&&(t=a.getRangeAt(0).cloneRange()).getClientRects&&(t.collapse(!0),t.getClientRects().length>0&&(n=t.getClientRects()[0]),n&&(i=n.top)),i},UpdateToolbar:function(){var t=this;t.options,t.element;e(["bold","italic","JustifyLeft","JustifyRight","JustifyCenter","underline"]).each((function(n,a){document.queryCommandState(a)?e("#"+a,t.Buttons).parent("button").removeClass("btn-info").addClass("btn-success"):e("#"+a,t.Buttons).parent("button").addClass("btn-info").removeClass("btn-success")})),np.noNg((()=>setTimeout((function(){e("#ltr",t.Buttons).removeClass("ui-state-highlight"),e("#rtl",t.Buttons).removeClass("ui-state-highlight")}),1e3)))},Require:function(e){var t=this;t.options,t.element;e?t.RequireSpan.show():t.RequireSpan.hide()},_setOption:function(e,t){var n=this;"readonly"!==e&&"disabled"!==e||(this.Editor.prop("contentEditable",!t),
//!value?ed.removeClass('ui-state-disabled'):ed.addClass('ui-state-disabled');
t?(n.Main.css("cursor","default"),n.FullScr&&n.FullScr.removeClass("text-success")):(n.Main.css("cursor","text"),n.FullScr&&n.FullScr.addClass("text-success")));this._super(e,t)},Val:function(e,t){if(void 0!==e){var n=np.utils.StandardHtml(e);n.flag?this.Editor.html(e):this.Editor.html(n.Str)}return this.Editor.html()},_destroy:function(){this.options,this.element}}),e.widget("np.npStepNav",{options:{npformSelf:null,navs:[],AfterAct:null,inxml:null,type:1,OnlyUpdateNav:0},_create:function(){var e=this,t=e.element;e.options;t.addClass("d-flex flex-column sw-main sw-theme-arrows"),e.main="",e.OpenedFaci=[]},Run:function(){var t=this,n=t.element,a=t.options;t.ul=e("<ul class='nav nav-tabs step-anchor' />"),a.OnlyUpdateNav?(e("ul:first",n).remove(),n.prepend(t.ul)):(n.empty(),n.append(t.ul)),t.ul.append("<li class='disabled'><a href='#' style='height:auto;display:none' > </a></li>");for(var i=-1,o=0;o<a.navs.length;o++){var r="1"==a.navs[o].disable?"disabled":"";r="1"==a.navs[o].active?"active":r,t.ul.append("<li  class='"+r+"' order='"+o+"' act='"+a.navs[o].act+"'><a  href='javascript:void(0)' ><div style='white-space:  nowrap;overflow: hidden;text-overflow: ellipsis;' title='"+a.navs[o].label+"'>"+a.navs[o].label+"</div></a></li>"),"1"==a.navs[o].active&&(i=o)}e("li",t.ul).on("click",(function(n){e(this).hasClass("disabled")||(e(this).addClass("active").siblings().removeClass("active"),t.openFaci(t.options.navs[e(this).attr("order")],e(this).attr("order")))})),-1==i||a.OnlyUpdateNav||t.openFaci(a.navs[i],i)},openFaci:function(t,n){var a=this,i=a.element,o=a.options,r=t.act;e(".tooltip.show","body").remove(),""!=a.main&&i.children("div").remove(),a.main=e("<div />").uniqueId();var l=a.main.attr("id"),s='<div class="d-flex flex-grow-1" style="position:relative;heigh_t:calc(100% - '+a.ul.height()+'px" id="'+o.npformSelf.MakeFullId(l)+'_W_"></div>';a.main.empty().html(s),a.main=o.npformSelf.$np("#"+l+"_W_",a.main),i.append(a.main);var d={HideOpener:!1,OpenInline:!0,InlineBox:a.main,HideFo_oter:!0,AfterAct:o.AfterAct,ReturnCaption:"",inxml:o.inxml,Active:t};o.npformSelf.$np("#dvfrmFooter").hide(),d.AfterNav=function(e){e.msg.c.length&&o.npformSelf.$np("#dvfrmFooter").show()},o.npformSelf.DoAct(r,null,d)},_setOption:function(e,t){this._super(e,t),"navs"===e&&this.Run()}}),e.widget("np.npDropdown",{options:{list:[],position:"bottom",relativeTo:null,clickCallBack:null,ItemsStyle:null,ItemClass:null},_create:function(){var e=this;e.element,e.options;e.createDropdown(),e.setPosition(),e.AddEvents()},createDropdown:function(){var t,n=this,a=n.element,i=n.options;t="bottom"==i.position?"top:"+(t=e(a).offset().top+15)+"px":"bottom:"+(t=e(window).height()-e(a).offset().top)+"px";var o=e(a).offset().left+"px";n.DropdownContainer=e("<div class='npDropdown' style='position:absolute;"+t+";left:"+o+"' ></div>"),n.DropdownUl=e("<div class='npDropdown-content'></div>"),e.each(i.list,(function(e,t){var a=i.ItemClass||t.ItemClass,o=i.ItemsStyle||t.ItemsStyle;n.DropdownUl.append("<span class='"+a+"' style='cursor:pointer;"+o+"' >"+t.text+"</span>")})),n.DropdownContainer.append(n.DropdownUl),e("body").append(n.DropdownContainer)},setPosition:function(){var t=this,n=t.element,a=t.options,i=a.relativeTo?a.relativeTo:n;if("bottom"==a.position){var o=e(i).offset().top+e(i).outerHeight();if(o+t.DropdownContainer.height()+50>e(window).height())return a.position="top",void t.setPosition();t.DropdownContainer.css({top:o+"px",bottom:"auto"})}else{var r=e(window).height()-e(i).offset().top;t.DropdownContainer.css({bottom:r+"px",top:"auto"}),t.DropdownContainer.height()>n.offset().top&&t.DropdownContainer.css({height:n.offset().top+"px",overflow:"auto"})}var l=e(i).offset().left;l+t.DropdownContainer.width()+50>e(window).width()?(t.DropdownContainer.css("left","auto"),t.DropdownContainer.css("right","0px")):t.DropdownContainer.css("left",l+"px")},AddEvents:function(){var t=this,n=t.element,a=t.options,i=a.relativeTo?a.relativeTo:n;e(i).on("mouseover",(function(){t.Remove=!1})),e(i).on("mouseleave",(function(){t.Remove=!0,np.noNg((()=>setTimeout((function(){t.Remove&&t.DropdownContainer&&t.RemoveDropdown(),t.Remove=!0}),700)))})),t.DropdownContainer.on("mouseleave",(function(){t.Remove=!0,t.DropdownContainer&&t.RemoveDropdown()})),t.DropdownContainer.on("mouseover",(function(){t.Remove=!1})),e("span",t.DropdownContainer).on("click",(function(n){a.clickCallBack&&(a.clickCallBack.call(this,n.currentTarget,a.list[e(this).index()]),t.RemoveDropdown())}))},RemoveDropdown:function(){var e=this;e.element,e.options;e.DropdownContainer.remove(),e.DropdownContainer=void 0,e.destroy()}}),e.widget("np.npPopup",{options:{text:null,position:"bottom",minWidth:e(window).width()/8,width:e(window).width()/4,height:"auto",clickContent:null,parent:null},_create:function(){var t=this,n=t.element,a=t.options;e(n).html();t.Remove=!0,t.Popup=e("<div class='npPopup'  style='width:"+a.width+"px;height:"+a.height+"px' />").html(a.text),a.parent?(a.parent.npPopup=t.Popup,appendTo=a.parent.W_.$bod):appendTo=e("body"),t.Popup.appendTo(appendTo),t.FixWidthAndHeight(),t.setPosition(),t.AddEvents(),t.Popup.on("click",(function(e){t._trigger("clickContent",null,{event:e})}))},FixWidthAndHeight:function(){var t=this,n=(t.element,t.options);for(n.width;t.Popup.height()>t.Popup.width()/(e(window).width()/e(window).height());){if(t.Popup.width()>e(window).width()){t.height(t.Popup.width()/(e(window).width()/e(window).height()));break}t.Popup.width(t.Popup.width()+n.minWidth/10)}},setPosition:function(){var t=this,n=t.element,a=t.options;if("bottom"==a.position){var i=e(n).offset().top+15;if(i+t.Popup.height()+50>e(window).height())return a.position="top",void t.setPosition();t.Popup.css({top:i+"px",bottom:"auto"})}else{var o=e(window).height()-e(n).offset().top;t.Popup.css({bottom:o+"px",top:"auto"})}var r=e(n).offset().left;r+t.Popup.width()+50>e(window).width()?(t.Popup.css("left","auto"),t.Popup.css("right","0px")):t.Popup.css("left",r+"px")},AddEvents:function(){var t=this,n=t.element;t.options;e(n).on("mouseover",(function(){t.Remove=!1})),e(n).on("mouseleave",(function(){t.Remove=!0,np.noNg((()=>setTimeout((function(){t.Remove&&t.Popup&&t.RemovePopup(),t.Remove=!0}),700)))})),t.Popup.on("mouseleave",(function(n){np.noNg((()=>setTimeout((function(){1!=e(n.relatedTarget).closest(".npDropdown").length&&(t.RemovePopup(),t.Remove=!0)}),0)))})),t.Popup.on("mouseover",(function(){t.Remove=!1}))},HidePopup:function(){var t=this.element;this.options;e(t).hide()},ShowPopup:function(){var t=this.element;this.options;e(t).hide()},RemovePopup:function(){var e=this;e.element,e.options;e.Popup.remove(),e.destroy()}})}(jQuery);
